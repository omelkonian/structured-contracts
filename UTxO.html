<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/structured-contracts/tree/master/UTxO.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="UTxO.html" class="Module">UTxO</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Prelude.html" class="Module">Prelude</a>

<a id="Value"></a><a id="41" href="UTxO.html#41" class="Function">Value</a>   <a id="49" class="Symbol">=</a> <a id="51" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="53" href="UTxO.html#53" class="Function">HashId</a>  <a id="61" class="Symbol">=</a> <a id="63" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="Slot"></a><a id="65" href="UTxO.html#65" class="Function">Slot</a>    <a id="73" class="Symbol">=</a> <a id="75" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="Address"></a><a id="77" href="UTxO.html#77" class="Function">Address</a> <a id="85" class="Symbol">=</a> <a id="87" href="UTxO.html#53" class="Function">HashId</a>
<a id="94" class="Keyword">postulate</a> <a id="_♯"></a><a id="104" href="UTxO.html#104" class="Postulate Operator">_♯</a> <a id="107" class="Symbol">:</a> <a id="109" class="Symbol">∀</a> <a id="111" class="Symbol">{</a><a id="112" href="UTxO.html#112" class="Bound">A</a> <a id="114" class="Symbol">:</a> <a id="116" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="121" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="122" class="Symbol">}</a> <a id="124" class="Symbol">→</a> <a id="126" href="UTxO.html#112" class="Bound">A</a> <a id="128" class="Symbol">→</a> <a id="130" href="UTxO.html#53" class="Function">HashId</a>

<a id="DATA"></a><a id="138" href="UTxO.html#138" class="Function">DATA</a> <a id="143" class="Symbol">=</a> <a id="145" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="147" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="∑"></a><a id="191" href="UTxO.html#191" class="Function">∑</a> <a id="193" class="Symbol">:</a> <a id="195" class="Symbol">∀</a> <a id="197" class="Symbol">{</a><a id="198" href="UTxO.html#198" class="Bound">A</a> <a id="200" class="Symbol">:</a> <a id="202" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="206" class="Symbol">}</a> <a id="208" class="Symbol">→</a> <a id="210" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="215" href="UTxO.html#198" class="Bound">A</a> <a id="217" class="Symbol">→</a> <a id="219" class="Symbol">(</a><a id="220" href="UTxO.html#198" class="Bound">A</a> <a id="222" class="Symbol">→</a> <a id="224" href="UTxO.html#41" class="Function">Value</a><a id="229" class="Symbol">)</a> <a id="231" class="Symbol">→</a> <a id="233" href="UTxO.html#41" class="Function">Value</a>
<a id="239" href="UTxO.html#191" class="Function">∑</a> <a id="241" href="UTxO.html#241" class="Bound">xs</a> <a id="244" href="UTxO.html#244" class="Bound">f</a> <a id="246" class="Symbol">=</a> <a id="248" href="Prelude.Lists.Sums.html#295" class="Function">∑ℕ</a> <a id="251" class="Symbol">(</a><a id="252" href="Data.List.Base.html#1553" class="Function">map</a> <a id="256" href="UTxO.html#244" class="Bound">f</a> <a id="258" href="UTxO.html#241" class="Bound">xs</a><a id="260" class="Symbol">)</a>

<a id="263" class="Keyword">record</a> <a id="TxOutput"></a><a id="270" href="UTxO.html#270" class="Record">TxOutput</a> <a id="279" class="Symbol">:</a> <a id="281" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="286" class="Keyword">where</a>
  <a id="294" class="Keyword">constructor</a> <a id="_at_"></a><a id="306" href="UTxO.html#306" class="InductiveConstructor Operator">_at_</a>
  <a id="313" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="319" href="UTxO.html#319" class="Field">value</a>    <a id="328" class="Symbol">:</a> <a id="330" href="UTxO.html#41" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="344" href="UTxO.html#344" class="Field">address</a>  <a id="353" class="Symbol">:</a> <a id="355" href="UTxO.html#77" class="Function">Address</a>
<a id="363" class="Keyword">open</a> <a id="368" href="UTxO.html#270" class="Module">TxOutput</a> <a id="377" class="Keyword">public</a>
<a id="384" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="396" href="UTxO.html#396" class="Function">DecEq-TxO</a> <a id="406" class="Symbol">=</a> <a id="408" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="415" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="421" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="423" class="Keyword">quote</a> <a id="429" href="UTxO.html#270" class="Record">TxOutput</a> <a id="438" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="440" href="UTxO.html#396" class="Function">DecEq-TxO</a> <a id="450" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="453" class="Keyword">record</a> <a id="InputInfo"></a><a id="460" href="UTxO.html#460" class="Record">InputInfo</a> <a id="470" class="Symbol">:</a> <a id="472" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="477" class="Keyword">where</a>
  <a id="485" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="491" href="UTxO.html#491" class="Field">outputRef</a>     <a id="505" class="Symbol">:</a> <a id="507" href="UTxO.html#270" class="Record">TxOutput</a>
        <a id="524" class="Comment">-- NB: the actual implementation also keeps references here</a>
        <a id="InputInfo.validatorHash"></a><a id="592" href="UTxO.html#592" class="Field">validatorHash</a> <a id="606" class="Symbol">:</a> <a id="608" href="UTxO.html#53" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="623" href="UTxO.html#623" class="Field">redeemerHash</a>  <a id="637" class="Symbol">:</a> <a id="639" href="UTxO.html#53" class="Function">HashId</a>
<a id="646" class="Keyword">unquoteDecl</a> <a id="DecEq-InputInfo"></a><a id="658" href="UTxO.html#658" class="Function">DecEq-InputInfo</a> <a id="674" class="Symbol">=</a> <a id="676" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="683" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="689" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="691" class="Keyword">quote</a> <a id="697" href="UTxO.html#460" class="Record">InputInfo</a> <a id="707" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="709" href="UTxO.html#658" class="Function">DecEq-InputInfo</a> <a id="725" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="728" class="Keyword">record</a> <a id="TxInfo"></a><a id="735" href="UTxO.html#735" class="Record">TxInfo</a> <a id="742" class="Symbol">:</a> <a id="744" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="749" class="Keyword">where</a>
  <a id="757" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="763" href="UTxO.html#763" class="Field">inputs</a>  <a id="771" class="Symbol">:</a> <a id="773" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="778" href="UTxO.html#460" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="796" href="UTxO.html#796" class="Field">outputs</a> <a id="804" class="Symbol">:</a> <a id="806" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="811" href="UTxO.html#270" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="828" href="UTxO.html#828" class="Field">forge</a>   <a id="836" class="Symbol">:</a> <a id="838" href="UTxO.html#41" class="Function">Value</a>
<a id="844" class="Keyword">unquoteDecl</a> <a id="DecEq-TxInfo"></a><a id="856" href="UTxO.html#856" class="Function">DecEq-TxInfo</a> <a id="869" class="Symbol">=</a> <a id="871" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="878" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="884" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="886" class="Keyword">quote</a> <a id="892" href="UTxO.html#735" class="Record">TxInfo</a> <a id="899" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="901" href="UTxO.html#856" class="Function">DecEq-TxInfo</a> <a id="914" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="917" class="Keyword">module</a> <a id="CommonInfo"></a><a id="924" href="UTxO.html#924" class="Module">CommonInfo</a> <a id="935" class="Symbol">(</a><a id="936" href="UTxO.html#936" class="Bound">TxOutputRef</a> <a id="948" class="Symbol">:</a> <a id="950" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="954" class="Symbol">)</a> <a id="956" class="Keyword">where</a>

  <a id="965" class="Keyword">record</a> <a id="CommonInfo.TxInput"></a><a id="972" href="UTxO.html#972" class="Record">TxInput</a> <a id="980" class="Symbol">:</a> <a id="982" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="987" class="Keyword">where</a>
    <a id="997" class="Keyword">field</a> <a id="CommonInfo.TxInput.outputRef"></a><a id="1003" href="UTxO.html#1003" class="Field">outputRef</a> <a id="1013" class="Symbol">:</a> <a id="1015" href="UTxO.html#936" class="Bound">TxOutputRef</a>
          <a id="CommonInfo.TxInput.validator"></a><a id="1037" href="UTxO.html#1037" class="Field">validator</a> <a id="1047" class="Symbol">:</a> <a id="1049" href="UTxO.html#735" class="Record">TxInfo</a> <a id="1056" class="Symbol">→</a> <a id="1058" href="UTxO.html#138" class="Function">DATA</a> <a id="1063" class="Symbol">→</a> <a id="1065" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
          <a id="CommonInfo.TxInput.redeemer"></a><a id="1080" href="UTxO.html#1080" class="Field">redeemer</a>  <a id="1090" class="Symbol">:</a> <a id="1092" href="UTxO.html#138" class="Function">DATA</a>
  <a id="1099" class="Keyword">open</a> <a id="1104" href="UTxO.html#972" class="Module">TxInput</a> <a id="1112" class="Keyword">public</a>

  <a id="1122" class="Keyword">record</a> <a id="CommonInfo.Tx"></a><a id="1129" href="UTxO.html#1129" class="Record">Tx</a> <a id="1132" class="Symbol">:</a> <a id="1134" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1139" class="Keyword">where</a>
    <a id="1149" class="Keyword">field</a> <a id="CommonInfo.Tx.inputs"></a><a id="1155" href="UTxO.html#1155" class="Field">inputs</a>  <a id="1163" class="Symbol">:</a> <a id="1165" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1170" href="UTxO.html#972" class="Record">TxInput</a>
          <a id="CommonInfo.Tx.outputs"></a><a id="1188" href="UTxO.html#1188" class="Field">outputs</a> <a id="1196" class="Symbol">:</a> <a id="1198" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1203" href="UTxO.html#270" class="Record">TxOutput</a>
          <a id="CommonInfo.Tx.forge"></a><a id="1222" href="UTxO.html#1222" class="Field">forge</a>   <a id="1230" class="Symbol">:</a> <a id="1232" href="UTxO.html#41" class="Function">Value</a>
  <a id="1240" class="Keyword">open</a> <a id="1245" href="UTxO.html#1129" class="Module">Tx</a> <a id="1248" class="Keyword">public</a>

  <a id="1258" class="Comment">-- A ledger is a list of transactions.</a>
  <a id="CommonInfo.L"></a><a id="1299" href="UTxO.html#1299" class="Function">L</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1308" href="UTxO.html#1129" class="Record">Tx</a>

  <a id="1314" class="Keyword">instance</a>
    <a id="CommonInfo.Semigroup-L"></a><a id="1327" href="UTxO.html#1327" class="Function">Semigroup-L</a> <a id="1339" class="Symbol">:</a> <a id="1341" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="1351" href="UTxO.html#1299" class="Function">L</a>
    <a id="1357" href="UTxO.html#1327" class="Function">Semigroup-L</a> <a id="1369" class="Symbol">.</a><a id="1370" href="Prelude.Semigroup.html#251" class="Field Operator">_◇_</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Data.List.Base.html#1819" class="Function Operator">_++_</a>

    <a id="CommonInfo.Monoid-L"></a><a id="1386" href="UTxO.html#1386" class="Function">Monoid-L</a> <a id="1395" class="Symbol">:</a> <a id="1397" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="1404" href="UTxO.html#1299" class="Function">L</a>
    <a id="1410" href="UTxO.html#1386" class="Function">Monoid-L</a> <a id="1419" class="Symbol">.</a><a id="1420" href="Prelude.Monoid.html#222" class="Field">ε</a> <a id="1422" class="Symbol">=</a> <a id="1424" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

  <a id="1430" class="Comment">-- Auxiliary definitions.</a>

  <a id="CommonInfo.outputRefs"></a><a id="1459" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="1470" class="Symbol">:</a> <a id="1472" href="UTxO.html#1129" class="Record">Tx</a> <a id="1475" class="Symbol">→</a> <a id="1477" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1482" href="UTxO.html#936" class="Bound">TxOutputRef</a>
  <a id="1496" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="1507" class="Symbol">=</a> <a id="1509" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1513" href="UTxO.html#1003" class="Field">outputRef</a> <a id="1523" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1525" href="UTxO.html#1155" class="Field">inputs</a>

  <a id="CommonInfo.Resolved"></a><a id="1535" href="UTxO.html#1535" class="Function">Resolved</a> <a id="1544" class="Symbol">:</a> <a id="1546" href="Prelude.Init.html#13332" class="Function">Pred₀</a> <a id="1552" href="UTxO.html#1129" class="Record">Tx</a>
  <a id="1557" href="UTxO.html#1535" class="Function">Resolved</a> <a id="1566" href="UTxO.html#1566" class="Bound">tx</a> <a id="1569" class="Symbol">=</a> <a id="1571" class="Symbol">∀</a> <a id="1573" class="Symbol">{</a><a id="1574" href="UTxO.html#1574" class="Bound">r</a><a id="1575" class="Symbol">}</a> <a id="1577" class="Symbol">→</a> <a id="1579" href="UTxO.html#1574" class="Bound">r</a> <a id="1581" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="1583" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="1594" href="UTxO.html#1566" class="Bound">tx</a> <a id="1597" class="Symbol">→</a> <a id="1599" href="UTxO.html#270" class="Record">TxOutput</a>

  <a id="CommonInfo.ResolvedInput"></a><a id="1611" href="UTxO.html#1611" class="Function">ResolvedInput</a>  <a id="1626" class="Symbol">=</a> <a id="1628" href="UTxO.html#972" class="Record">TxInput</a> <a id="1636" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1638" href="UTxO.html#270" class="Record">TxOutput</a>
  <a id="CommonInfo.ResolvedInputs"></a><a id="1649" href="UTxO.html#1649" class="Function">ResolvedInputs</a> <a id="1664" class="Symbol">=</a> <a id="1666" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1671" href="UTxO.html#1611" class="Function">ResolvedInput</a>

  <a id="CommonInfo.resolveInputs"></a><a id="1688" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="1702" class="Symbol">:</a> <a id="1704" class="Symbol">∀</a> <a id="1706" href="UTxO.html#1706" class="Bound">tx</a> <a id="1709" class="Symbol">→</a> <a id="1711" href="UTxO.html#1535" class="Function">Resolved</a> <a id="1720" href="UTxO.html#1706" class="Bound">tx</a> <a id="1723" class="Symbol">→</a> <a id="1725" href="UTxO.html#1649" class="Function">ResolvedInputs</a>
  <a id="1742" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="1756" href="UTxO.html#1756" class="Bound">tx</a> <a id="1759" href="UTxO.html#1759" class="Bound">resolvedTx</a> <a id="1770" class="Symbol">=</a> <a id="1772" href="Data.List.Membership.Setoid.html#1137" class="Function">mapWith∈</a> <a id="1781" class="Symbol">(</a><a id="1782" href="UTxO.html#1756" class="Bound">tx</a> <a id="1785" class="Symbol">.</a><a id="1786" href="UTxO.html#1155" class="Field">inputs</a><a id="1792" class="Symbol">)</a> <a id="1794" class="Symbol">λ</a> <a id="1796" class="Symbol">{</a><a id="1797" href="UTxO.html#1797" class="Bound">i</a><a id="1798" class="Symbol">}</a> <a id="1800" href="UTxO.html#1800" class="Bound">i∈</a> <a id="1803" class="Symbol">→</a>
    <a id="1809" href="UTxO.html#1797" class="Bound">i</a> <a id="1811" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1813" href="UTxO.html#1759" class="Bound">resolvedTx</a> <a id="1824" class="Symbol">(</a><a id="1825" href="Data.List.Membership.Propositional.Properties.html#3377" class="Function">∈-map⁺</a> <a id="1832" href="UTxO.html#1003" class="Field">outputRef</a> <a id="1842" href="UTxO.html#1800" class="Bound">i∈</a><a id="1844" class="Symbol">)</a>

  <a id="CommonInfo.mkInputInfo"></a><a id="1849" href="UTxO.html#1849" class="Function">mkInputInfo</a> <a id="1861" class="Symbol">:</a> <a id="1863" href="UTxO.html#1611" class="Function">ResolvedInput</a> <a id="1877" class="Symbol">→</a> <a id="1879" href="UTxO.html#460" class="Record">InputInfo</a>
  <a id="1891" href="UTxO.html#1849" class="Function">mkInputInfo</a> <a id="1903" class="Symbol">(</a><a id="1904" href="UTxO.html#1904" class="Bound">i</a> <a id="1906" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1908" href="UTxO.html#1908" class="Bound">o</a><a id="1909" class="Symbol">)</a> <a id="1911" class="Symbol">=</a> <a id="1913" class="Keyword">record</a>
    <a id="1924" class="Symbol">{</a> <a id="1926" href="UTxO.html#491" class="Field">outputRef</a>     <a id="1940" class="Symbol">=</a> <a id="1942" href="UTxO.html#1908" class="Bound">o</a>
    <a id="1948" class="Symbol">;</a> <a id="1950" href="UTxO.html#592" class="Field">validatorHash</a> <a id="1964" class="Symbol">=</a> <a id="1966" href="UTxO.html#1904" class="Bound">i</a> <a id="1968" class="Symbol">.</a><a id="1969" href="UTxO.html#1037" class="Field">validator</a> <a id="1979" href="UTxO.html#104" class="Postulate Operator">♯</a>
    <a id="1985" class="Symbol">;</a> <a id="1987" href="UTxO.html#623" class="Field">redeemerHash</a>  <a id="2001" class="Symbol">=</a> <a id="2003" href="UTxO.html#1904" class="Bound">i</a> <a id="2005" class="Symbol">.</a><a id="2006" href="UTxO.html#1080" class="Field">redeemer</a> <a id="2015" href="UTxO.html#104" class="Postulate Operator">♯</a> <a id="2017" class="Symbol">}</a>

  <a id="CommonInfo.mkTxInfo"></a><a id="2022" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="2031" class="Symbol">:</a> <a id="2033" class="Symbol">∀</a> <a id="2035" class="Symbol">(</a><a id="2036" href="UTxO.html#2036" class="Bound">tx</a> <a id="2039" class="Symbol">:</a> <a id="2041" href="UTxO.html#1129" class="Record">Tx</a><a id="2043" class="Symbol">)</a> <a id="2045" class="Symbol">→</a> <a id="2047" href="UTxO.html#1535" class="Function">Resolved</a> <a id="2056" href="UTxO.html#2036" class="Bound">tx</a> <a id="2059" class="Symbol">→</a> <a id="2061" href="UTxO.html#735" class="Record">TxInfo</a>
  <a id="2070" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="2079" href="UTxO.html#2079" class="Bound">tx</a> <a id="2082" href="UTxO.html#2082" class="Bound">resolvedTx</a> <a id="2093" class="Symbol">=</a> <a id="2095" class="Keyword">record</a>
    <a id="2106" class="Symbol">{</a> <a id="2108" href="UTxO.html#763" class="Field">inputs</a>  <a id="2116" class="Symbol">=</a> <a id="2118" href="UTxO.html#1849" class="Function">mkInputInfo</a> <a id="2130" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="2134" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="2148" href="UTxO.html#2079" class="Bound">tx</a> <a id="2151" href="UTxO.html#2082" class="Bound">resolvedTx</a>
    <a id="2166" class="Symbol">;</a> <a id="2168" href="UTxO.html#796" class="Field">outputs</a> <a id="2176" class="Symbol">=</a> <a id="2178" href="UTxO.html#2079" class="Bound">tx</a> <a id="2181" class="Symbol">.</a><a id="2182" href="UTxO.html#1188" class="Field">outputs</a>
    <a id="2194" class="Symbol">;</a> <a id="2196" href="UTxO.html#828" class="Field">forge</a>   <a id="2204" class="Symbol">=</a> <a id="2206" href="UTxO.html#2079" class="Bound">tx</a> <a id="2209" class="Symbol">.</a><a id="2210" href="UTxO.html#1222" class="Field">forge</a> <a id="2216" class="Symbol">}</a>

<a id="2219" class="Comment">--</a>

<a id="2223" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="2230" href="UTxO.html#2230" class="Record">TxOutputRef</a> <a id="2242" class="Symbol">:</a> <a id="2244" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="2249" class="Keyword">where</a>
  <a id="2257" class="Keyword">constructor</a> <a id="_indexed-at_"></a><a id="2269" href="UTxO.html#2269" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="2284" class="Keyword">field</a> <a id="TxOutputRef.txId"></a><a id="2290" href="UTxO.html#2290" class="Field">txId</a>  <a id="2296" class="Symbol">:</a> <a id="2298" href="UTxO.html#53" class="Function">HashId</a>
        <a id="TxOutputRef.index"></a><a id="2313" href="UTxO.html#2313" class="Field">index</a> <a id="2319" class="Symbol">:</a> <a id="2321" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="2323" class="Keyword">open</a> <a id="2328" href="UTxO.html#2230" class="Module">TxOutputRef</a> <a id="2340" class="Keyword">public</a>
<a id="2347" class="Keyword">unquoteDecl</a> <a id="DecEq-TxOR"></a><a id="2359" href="UTxO.html#2359" class="Function">DecEq-TxOR</a> <a id="2370" class="Symbol">=</a> <a id="2372" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="2379" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="2385" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2387" class="Keyword">quote</a> <a id="2393" href="UTxO.html#2230" class="Record">TxOutputRef</a> <a id="2405" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2407" href="UTxO.html#2359" class="Function">DecEq-TxOR</a> <a id="2418" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="2421" class="Keyword">open</a> <a id="2426" href="UTxO.html#924" class="Module">CommonInfo</a> <a id="2437" href="UTxO.html#2230" class="Record">TxOutputRef</a> <a id="2449" class="Keyword">public</a>

<a id="2457" class="Comment">-- The state of a ledger maps output references locked by a validator to a value.</a>
<a id="UTxO"></a><a id="2539" href="UTxO.html#2539" class="Function">UTxO</a> <a id="2544" class="Symbol">=</a> <a id="2546" href="Prelude.Maps.AsSets.html#550" class="Record">Map⟨</a> <a id="2551" href="UTxO.html#2230" class="Record">TxOutputRef</a> <a id="2563" href="Prelude.Maps.AsSets.html#550" class="Record">↦</a> <a id="2565" href="UTxO.html#270" class="Record">TxOutput</a> <a id="2574" href="Prelude.Maps.AsSets.html#550" class="Record">⟩</a>

<a id="mkUtxo"></a><a id="2577" href="UTxO.html#2577" class="Function">mkUtxo</a> <a id="2584" class="Symbol">:</a> <a id="2586" class="Symbol">∀</a> <a id="2588" class="Symbol">{</a><a id="2589" href="UTxO.html#2589" class="Bound">out</a><a id="2592" class="Symbol">}</a> <a id="2594" href="UTxO.html#2594" class="Bound">tx</a> <a id="2597" class="Symbol">→</a> <a id="2599" href="UTxO.html#2589" class="Bound">out</a> <a id="2603" href="Data.List.Membership.Setoid.html#896" class="Function Operator">L.Mem.∈</a> <a id="2611" href="UTxO.html#1188" class="Field">outputs</a> <a id="2619" href="UTxO.html#2594" class="Bound">tx</a> <a id="2622" class="Symbol">→</a> <a id="2624" href="UTxO.html#2230" class="Record">TxOutputRef</a> <a id="2636" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2638" href="UTxO.html#270" class="Record">TxOutput</a>
<a id="2647" href="UTxO.html#2577" class="Function">mkUtxo</a> <a id="2654" class="Symbol">{</a><a id="2655" href="UTxO.html#2655" class="Bound">out</a><a id="2658" class="Symbol">}</a> <a id="2660" href="UTxO.html#2660" class="Bound">tx</a> <a id="2663" href="UTxO.html#2663" class="Bound">out∈</a> <a id="2668" class="Symbol">=</a> <a id="2670" class="Symbol">(</a><a id="2671" href="UTxO.html#2660" class="Bound">tx</a> <a id="2674" href="UTxO.html#104" class="Postulate Operator">♯</a><a id="2675" class="Symbol">)</a> <a id="2677" href="UTxO.html#2269" class="InductiveConstructor Operator">indexed-at</a> <a id="2688" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="2692" class="Symbol">(</a><a id="2693" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="2705" href="UTxO.html#2663" class="Bound">out∈</a><a id="2709" class="Symbol">)</a> <a id="2711" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2713" href="UTxO.html#2655" class="Bound">out</a>

<a id="utxoTx"></a><a id="2718" href="UTxO.html#2718" class="Function">utxoTx</a> <a id="2725" class="Symbol">:</a> <a id="2727" href="UTxO.html#1129" class="Record">Tx</a> <a id="2730" class="Symbol">→</a> <a id="2732" href="UTxO.html#2539" class="Function">UTxO</a>
<a id="2737" href="UTxO.html#2718" class="Function">utxoTx</a> <a id="2744" href="UTxO.html#2744" class="Bound">tx</a> <a id="2747" class="Symbol">=</a> <a id="2749" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="2758" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2760" href="Data.List.Membership.Setoid.html#1137" class="Function">L.Mem.mapWith∈</a> <a id="2775" class="Symbol">(</a><a id="2776" href="UTxO.html#2744" class="Bound">tx</a> <a id="2779" class="Symbol">.</a><a id="2780" href="UTxO.html#1188" class="Field">outputs</a><a id="2787" class="Symbol">)</a> <a id="2789" class="Symbol">(</a><a id="2790" href="UTxO.html#2577" class="Function">mkUtxo</a> <a id="2797" href="UTxO.html#2744" class="Bound">tx</a><a id="2799" class="Symbol">)</a>

<a id="totalValue"></a><a id="2802" href="UTxO.html#2802" class="Function">totalValue</a> <a id="2813" class="Symbol">:</a> <a id="2815" href="UTxO.html#2539" class="Function">UTxO</a> <a id="2820" class="Symbol">→</a> <a id="2822" href="UTxO.html#41" class="Function">Value</a>
<a id="2828" href="UTxO.html#2802" class="Function">totalValue</a> <a id="2839" class="Symbol">=</a> <a id="2841" href="Prelude.Lists.Sums.html#295" class="Function">∑ℕ</a> <a id="2844" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2846" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2850" href="UTxO.html#319" class="Field">value</a> <a id="2856" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2858" href="Prelude.html#1572" class="Function">values</a>

<a id="applyTx"></a><a id="2866" href="UTxO.html#2866" class="Function">applyTx</a> <a id="2874" class="Symbol">:</a> <a id="2876" href="UTxO.html#1129" class="Record">Tx</a> <a id="2879" class="Symbol">→</a> <a id="2881" class="Symbol">(</a><a id="2882" href="UTxO.html#2539" class="Function">UTxO</a> <a id="2887" class="Symbol">→</a> <a id="2889" href="UTxO.html#2539" class="Function">UTxO</a><a id="2893" class="Symbol">)</a>
<a id="2895" href="UTxO.html#2866" class="Function">applyTx</a> <a id="2903" href="UTxO.html#2903" class="Bound">tx</a> <a id="2906" href="UTxO.html#2906" class="Bound">utxo</a> <a id="2911" class="Symbol">=</a> <a id="2913" class="Symbol">(</a><a id="2914" href="UTxO.html#2906" class="Bound">utxo</a> <a id="2919" href="Prelude.html#1432" class="Function Operator">─ᵏˢ</a> <a id="2923" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="2934" href="UTxO.html#2903" class="Bound">tx</a><a id="2936" class="Symbol">)</a> <a id="2938" href="Prelude.Maps.AsSets.html#1469" class="Function Operator">∪</a> <a id="2940" href="UTxO.html#2718" class="Function">utxoTx</a> <a id="2947" href="UTxO.html#2903" class="Bound">tx</a>

<a id="utxo"></a><a id="2951" href="UTxO.html#2951" class="Function">utxo</a> <a id="2956" class="Symbol">:</a> <a id="2958" href="UTxO.html#1299" class="Function">L</a> <a id="2960" class="Symbol">→</a> <a id="2962" href="UTxO.html#2539" class="Function">UTxO</a>
<a id="2967" href="UTxO.html#2951" class="Function">utxo</a> <a id="2972" class="Symbol">=</a> <a id="2974" class="Symbol">λ</a> <a id="2976" class="Keyword">where</a>
  <a id="2984" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2987" class="Symbol">→</a> <a id="2989" href="Prelude.Maps.AsSets.html#930" class="InductiveConstructor">∅</a>
  <a id="2993" class="Symbol">(</a><a id="2994" href="UTxO.html#2994" class="Bound">tx</a> <a id="2997" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2999" href="UTxO.html#2999" class="Bound">l</a><a id="3000" class="Symbol">)</a> <a id="3002" class="Symbol">→</a> <a id="3004" href="UTxO.html#2866" class="Function">applyTx</a> <a id="3012" href="UTxO.html#2994" class="Bound">tx</a> <a id="3015" class="Symbol">(</a><a id="3016" href="UTxO.html#2951" class="Function">utxo</a> <a id="3021" href="UTxO.html#2999" class="Bound">l</a><a id="3022" class="Symbol">)</a>

<a id="3025" class="Keyword">record</a> <a id="IsValidTx"></a><a id="3032" href="UTxO.html#3032" class="Record">IsValidTx</a> <a id="3042" class="Symbol">(</a><a id="3043" href="UTxO.html#3043" class="Bound">tx</a> <a id="3046" class="Symbol">:</a> <a id="3048" href="UTxO.html#1129" class="Record">Tx</a><a id="3050" class="Symbol">)</a> <a id="3052" class="Symbol">(</a><a id="3053" href="UTxO.html#3053" class="Bound">utxos</a> <a id="3059" class="Symbol">:</a> <a id="3061" href="UTxO.html#2539" class="Function">UTxO</a><a id="3065" class="Symbol">)</a> <a id="3067" class="Symbol">:</a> <a id="3069" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="3074" class="Keyword">where</a>
  <a id="3082" class="Keyword">field</a>
    <a id="IsValidTx.noDoubleSpending"></a><a id="3092" href="UTxO.html#3092" class="Field">noDoubleSpending</a> <a id="3109" class="Symbol">:</a>
      <a id="3117" href="Prelude.Irrelevance.List.Unique.html#1002" class="Function">·Unique</a> <a id="3125" class="Symbol">(</a><a id="3126" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="3137" href="UTxO.html#3043" class="Bound">tx</a><a id="3139" class="Symbol">)</a>

    <a id="IsValidTx.validOutputRefs"></a><a id="3146" href="UTxO.html#3146" class="Field">validOutputRefs</a> <a id="3162" class="Symbol">:</a>
      <a id="3170" href="Prelude.html#1011" class="Function">∀[</a> <a id="3173" href="UTxO.html#3173" class="Bound">ref</a> <a id="3177" href="Prelude.html#1011" class="Function">∈</a> <a id="3179" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="3190" href="UTxO.html#3043" class="Bound">tx</a> <a id="3193" href="Prelude.html#1011" class="Function">]</a>
        <a id="3203" class="Symbol">(</a><a id="3204" href="UTxO.html#3173" class="Bound">ref</a> <a id="3208" href="Prelude.Maps.AsSets.html#1627" class="Function Operator">∈ᵈ</a> <a id="3211" href="UTxO.html#3053" class="Bound">utxos</a><a id="3216" class="Symbol">)</a>

  <a id="IsValidTx.resolved"></a><a id="3221" href="UTxO.html#3221" class="Function">resolved</a> <a id="3230" class="Symbol">:</a> <a id="3232" href="UTxO.html#1535" class="Function">Resolved</a> <a id="3241" href="UTxO.html#3043" class="Bound">tx</a>
  <a id="3246" href="UTxO.html#3221" class="Function">resolved</a> <a id="3255" class="Symbol">=</a> <a id="3257" class="Symbol">(</a><a id="3258" href="UTxO.html#3053" class="Bound">utxos</a> <a id="3264" href="Prelude.html#1344" class="Function Operator">‼_</a><a id="3266" class="Symbol">)</a> <a id="3268" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3270" href="Data.List.Relation.Unary.All.html#5775" class="Function">L.All.lookup</a> <a id="3283" href="UTxO.html#3146" class="Field">validOutputRefs</a>

  <a id="IsValidTx.txInfo"></a><a id="3302" href="UTxO.html#3302" class="Function">txInfo</a> <a id="3309" class="Symbol">=</a> <a id="3311" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="3320" href="UTxO.html#3043" class="Bound">tx</a> <a id="3323" href="UTxO.html#3221" class="Function">resolved</a>
  <a id="IsValidTx.resolvedInputs"></a><a id="3334" href="UTxO.html#3334" class="Function">resolvedInputs</a> <a id="3349" class="Symbol">=</a> <a id="3351" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="3365" href="UTxO.html#3043" class="Bound">tx</a> <a id="3368" href="UTxO.html#3221" class="Function">resolved</a>

  <a id="3380" class="Keyword">field</a>
    <a id="IsValidTx.preservesValues"></a><a id="3390" href="UTxO.html#3390" class="Field">preservesValues</a> <a id="3406" class="Symbol">:</a>
      <a id="3414" href="UTxO.html#3043" class="Bound">tx</a> <a id="3417" class="Symbol">.</a><a id="3418" href="UTxO.html#1222" class="Field">forge</a> <a id="3424" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3426" href="UTxO.html#191" class="Function">∑</a> <a id="3428" href="UTxO.html#3334" class="Function">resolvedInputs</a> <a id="3443" class="Symbol">(</a><a id="3444" href="UTxO.html#319" class="Field">value</a> <a id="3450" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3452" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="3457" class="Symbol">)</a> <a id="3459" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3461" href="UTxO.html#191" class="Function">∑</a> <a id="3463" class="Symbol">(</a><a id="3464" href="UTxO.html#3043" class="Bound">tx</a> <a id="3467" class="Symbol">.</a><a id="3468" href="UTxO.html#1188" class="Field">outputs</a><a id="3475" class="Symbol">)</a> <a id="3477" href="UTxO.html#319" class="Field">value</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="3488" href="UTxO.html#3488" class="Field">allInputsValidate</a> <a id="3506" class="Symbol">:</a>
      <a id="3514" href="Prelude.html#1011" class="Function">∀[</a> <a id="3517" href="UTxO.html#3517" class="Bound">i</a> <a id="3519" href="Prelude.html#1011" class="Function">∈</a> <a id="3521" href="UTxO.html#3043" class="Bound">tx</a> <a id="3524" class="Symbol">.</a><a id="3525" href="UTxO.html#1155" class="Field">inputs</a> <a id="3532" href="Prelude.html#1011" class="Function">]</a>
        <a id="3542" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="3544" class="Symbol">(</a><a id="3545" href="UTxO.html#3517" class="Bound">i</a> <a id="3547" class="Symbol">.</a><a id="3548" href="UTxO.html#1037" class="Field">validator</a> <a id="3558" href="UTxO.html#3302" class="Function">txInfo</a> <a id="3565" class="Symbol">(</a><a id="3566" href="UTxO.html#3517" class="Bound">i</a> <a id="3568" class="Symbol">.</a><a id="3569" href="UTxO.html#1080" class="Field">redeemer</a><a id="3577" class="Symbol">))</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="3585" href="UTxO.html#3585" class="Field">validateValidHashes</a> <a id="3605" class="Symbol">:</a>
      <a id="3613" href="Prelude.html#1011" class="Function">∀[</a> <a id="3616" href="UTxO.html#3616" class="Bound">(</a><a id="3617" href="UTxO.html#3617" class="Bound">i</a> <a id="3619" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3621" href="UTxO.html#3621" class="Bound">o</a><a id="3622" href="UTxO.html#3616" class="Bound">)</a> <a id="3624" href="Prelude.html#1011" class="Function">∈</a> <a id="3626" href="UTxO.html#3334" class="Function">resolvedInputs</a> <a id="3641" href="Prelude.html#1011" class="Function">]</a>
        <a id="3651" class="Symbol">(</a><a id="3652" href="UTxO.html#3621" class="Bound">o</a> <a id="3654" class="Symbol">.</a><a id="3655" href="UTxO.html#344" class="Field">address</a> <a id="3663" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3665" href="UTxO.html#3617" class="Bound">i</a> <a id="3667" class="Symbol">.</a><a id="3668" href="UTxO.html#1037" class="Field">validator</a> <a id="3678" href="UTxO.html#104" class="Postulate Operator">♯</a><a id="3679" class="Symbol">)</a>

  <a id="3684" class="Keyword">postulate</a>
    <a id="IsValidTx.nextValue≡"></a><a id="3698" href="UTxO.html#3698" class="Postulate">nextValue≡</a> <a id="3709" class="Symbol">:</a>
      <a id="3717" href="UTxO.html#2802" class="Function">totalValue</a> <a id="3728" class="Symbol">((</a><a id="3730" href="UTxO.html#3053" class="Bound">utxos</a> <a id="3736" href="Prelude.html#1432" class="Function Operator">─ᵏˢ</a> <a id="3740" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="3751" href="UTxO.html#3043" class="Bound">tx</a><a id="3753" class="Symbol">)</a> <a id="3755" href="Prelude.Maps.AsSets.html#1469" class="Function Operator">∪</a> <a id="3757" href="UTxO.html#2718" class="Function">utxoTx</a> <a id="3764" href="UTxO.html#3043" class="Bound">tx</a><a id="3766" class="Symbol">)</a>
      <a id="3774" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3776" class="Symbol">(</a><a id="3777" href="UTxO.html#2802" class="Function">totalValue</a> <a id="3788" href="UTxO.html#3053" class="Bound">utxos</a> <a id="3794" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3796" href="UTxO.html#191" class="Function">∑</a> <a id="3798" class="Symbol">(</a><a id="3799" href="UTxO.html#3043" class="Bound">tx</a> <a id="3802" class="Symbol">.</a><a id="3803" href="UTxO.html#1188" class="Field">outputs</a><a id="3810" class="Symbol">)</a> <a id="3812" href="UTxO.html#319" class="Field">value</a><a id="3817" class="Symbol">)</a> <a id="3819" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="3821" href="UTxO.html#191" class="Function">∑</a> <a id="3823" href="UTxO.html#3334" class="Function">resolvedInputs</a> <a id="3838" class="Symbol">(</a><a id="3839" href="UTxO.html#319" class="Field">value</a> <a id="3845" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3847" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="3852" class="Symbol">)</a>

<a id="3855" class="Keyword">open</a> <a id="3860" href="UTxO.html#3032" class="Module">IsValidTx</a> <a id="3870" class="Keyword">public</a>

<a id="3878" class="Keyword">instance</a>
  <a id="·Valid"></a><a id="3889" href="UTxO.html#3889" class="Function">·Valid</a> <a id="3896" class="Symbol">:</a> <a id="3898" class="Symbol">∀</a> <a id="3900" class="Symbol">{</a><a id="3901" href="UTxO.html#3901" class="Bound">tx</a> <a id="3904" href="UTxO.html#3904" class="Bound">s</a><a id="3905" class="Symbol">}</a> <a id="3907" class="Symbol">→</a> <a id="3909" href="Prelude.Irrelevance.Core.html#215" class="Record Operator">·</a> <a id="3911" href="UTxO.html#3032" class="Record">IsValidTx</a> <a id="3921" href="UTxO.html#3901" class="Bound">tx</a> <a id="3924" href="UTxO.html#3904" class="Bound">s</a>
  <a id="3928" href="UTxO.html#3889" class="Function">·Valid</a> <a id="3935" class="Symbol">{</a><a id="3936" class="Argument">s</a> <a id="3938" class="Symbol">=</a> <a id="3940" class="Symbol">_</a> <a id="3942" href="Prelude.Maps.AsSets.html#581" class="InductiveConstructor Operator">⊣</a> <a id="3944" href="UTxO.html#3944" class="Bound">·uniq</a><a id="3949" class="Symbol">}</a> <a id="3951" class="Symbol">.</a><a id="3952" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a>
    <a id="3959" class="Symbol">(</a><a id="3960" class="Keyword">record</a> <a id="3967" class="Symbol">{</a> <a id="3969" href="UTxO.html#3092" class="Field">noDoubleSpending</a> <a id="3986" class="Symbol">=</a> <a id="3988" href="UTxO.html#3988" class="Bound">ndp</a>
            <a id="4004" class="Symbol">;</a> <a id="4006" href="UTxO.html#3146" class="Field">validOutputRefs</a> <a id="4022" class="Symbol">=</a> <a id="4024" href="UTxO.html#4024" class="Bound">vor</a>
            <a id="4040" class="Symbol">;</a> <a id="4042" href="UTxO.html#3390" class="Field">preservesValues</a> <a id="4058" class="Symbol">=</a> <a id="4060" href="UTxO.html#4060" class="Bound">pv</a>
            <a id="4075" class="Symbol">;</a> <a id="4077" href="UTxO.html#3488" class="Field">allInputsValidate</a> <a id="4095" class="Symbol">=</a> <a id="4097" href="UTxO.html#4097" class="Bound">aiv</a>
            <a id="4113" class="Symbol">;</a> <a id="4115" href="UTxO.html#3585" class="Field">validateValidHashes</a> <a id="4135" class="Symbol">=</a> <a id="4137" href="UTxO.html#4137" class="Bound">vvh</a>
            <a id="4153" class="Symbol">})</a>
    <a id="4160" class="Symbol">(</a><a id="4161" class="Keyword">record</a> <a id="4168" class="Symbol">{</a> <a id="4170" href="UTxO.html#3092" class="Field">noDoubleSpending</a> <a id="4187" class="Symbol">=</a> <a id="4189" href="UTxO.html#4189" class="Bound">ndp′</a>
            <a id="4206" class="Symbol">;</a> <a id="4208" href="UTxO.html#3146" class="Field">validOutputRefs</a> <a id="4224" class="Symbol">=</a> <a id="4226" href="UTxO.html#4226" class="Bound">vor′</a>
            <a id="4243" class="Symbol">;</a> <a id="4245" href="UTxO.html#3390" class="Field">preservesValues</a> <a id="4261" class="Symbol">=</a> <a id="4263" href="UTxO.html#4263" class="Bound">pv′</a>
            <a id="4279" class="Symbol">;</a> <a id="4281" href="UTxO.html#3488" class="Field">allInputsValidate</a> <a id="4299" class="Symbol">=</a> <a id="4301" href="UTxO.html#4301" class="Bound">aiv′</a>
            <a id="4318" class="Symbol">;</a> <a id="4320" href="UTxO.html#3585" class="Field">validateValidHashes</a> <a id="4340" class="Symbol">=</a> <a id="4342" href="UTxO.html#4342" class="Bound">vvh′</a>
            <a id="4359" class="Symbol">})</a>
    <a id="4366" class="Keyword">with</a> <a id="4371" href="UTxO.html#4371" class="Bound">uniq</a> ← <a id="4378" href="Relation.Nullary.html#1847" class="Function">recompute</a> <a id="4388" href="Prelude.Decidable.Core.html#166" class="Field">dec</a> <a id="4392" href="UTxO.html#3944" class="Bound">·uniq</a>
    <a id="4402" class="Keyword">rewrite</a> <a id="4410" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="4413" href="UTxO.html#3988" class="Bound">ndp</a> <a id="4417" href="UTxO.html#4189" class="Bound">ndp′</a>
          <a id="4432" class="Symbol">|</a> <a id="4434" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="4451" class="Symbol">(</a><a id="4452" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="4458" href="UTxO.html#4371" class="Bound">uniq</a><a id="4462" class="Symbol">)</a> <a id="4464" href="UTxO.html#4024" class="Bound">vor</a> <a id="4468" href="UTxO.html#4226" class="Bound">vor′</a>
          <a id="4483" class="Symbol">|</a> <a id="4485" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="4488" href="UTxO.html#4060" class="Bound">pv</a> <a id="4491" href="UTxO.html#4263" class="Bound">pv′</a>
          <a id="4505" class="Symbol">|</a> <a id="4507" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="4524" href="Data.Bool.Properties.html#15414" class="Function">B.T-irrelevant</a> <a id="4539" href="UTxO.html#4097" class="Bound">aiv</a> <a id="4543" href="UTxO.html#4301" class="Bound">aiv′</a>
          <a id="4558" class="Symbol">|</a> <a id="4560" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="4563" href="UTxO.html#4137" class="Bound">vvh</a> <a id="4567" href="UTxO.html#4342" class="Bound">vvh′</a>
          <a id="4582" class="Symbol">=</a> <a id="4584" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="isValidTx?"></a><a id="4590" href="UTxO.html#4590" class="Function">isValidTx?</a> <a id="4601" class="Symbol">:</a> <a id="4603" class="Symbol">∀</a> <a id="4605" href="UTxO.html#4605" class="Bound">tx</a> <a id="4608" href="UTxO.html#4608" class="Bound">s</a> <a id="4610" class="Symbol">→</a> <a id="4612" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="4616" class="Symbol">(</a><a id="4617" href="UTxO.html#3032" class="Record">IsValidTx</a> <a id="4627" href="UTxO.html#4605" class="Bound">tx</a> <a id="4630" href="UTxO.html#4608" class="Bound">s</a><a id="4631" class="Symbol">)</a>
<a id="4633" href="UTxO.html#4590" class="Function">isValidTx?</a> <a id="4644" href="UTxO.html#4644" class="Bound">tx</a> <a id="4647" href="UTxO.html#4647" class="Bound">s</a><a id="4648" class="Symbol">@(_</a> <a id="4652" href="Prelude.Maps.AsSets.html#581" class="InductiveConstructor Operator">⊣</a> <a id="4654" href="UTxO.html#4654" class="Bound">·uniq</a><a id="4659" class="Symbol">)</a>
  <a id="4663" class="Keyword">with</a> <a id="4668" href="UTxO.html#4668" class="Bound">uniq</a> ← <a id="4675" href="Relation.Nullary.html#1847" class="Function">recompute</a> <a id="4685" href="Prelude.Decidable.Core.html#166" class="Field">dec</a> <a id="4689" href="UTxO.html#4654" class="Bound">·uniq</a>
  <a id="4697" class="Keyword">with</a> <a id="4702" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="4706" class="Symbol">...</a> <a id="4710" class="Symbol">|</a> <a id="4712" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4715" href="UTxO.html#4715" class="Bound">¬p</a> <a id="4718" class="Symbol">=</a> <a id="4720" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4723" class="Symbol">(</a><a id="4724" href="UTxO.html#4715" class="Bound">¬p</a> <a id="4727" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4729" href="UTxO.html#3092" class="Field">noDoubleSpending</a><a id="4745" class="Symbol">)</a>
<a id="4747" class="Symbol">...</a> <a id="4751" class="Symbol">|</a> <a id="4753" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4757" href="UTxO.html#4757" class="Bound">ndp</a> <a id="4761" class="Keyword">with</a> <a id="4766" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="4770" class="Symbol">...</a> <a id="4774" class="Symbol">|</a> <a id="4776" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4779" href="UTxO.html#4779" class="Bound">¬p</a> <a id="4782" class="Symbol">=</a> <a id="4784" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4787" class="Symbol">(</a><a id="4788" href="UTxO.html#4779" class="Bound">¬p</a> <a id="4791" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4793" href="UTxO.html#3146" class="Field">validOutputRefs</a><a id="4808" class="Symbol">)</a>
<a id="4810" class="Symbol">...</a> <a id="4814" class="Symbol">|</a> <a id="4816" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4820" href="UTxO.html#4820" class="Bound">vor</a> <a id="4824" class="Keyword">with</a> <a id="4829" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="4833" class="Symbol">...</a> <a id="4837" class="Symbol">|</a> <a id="4839" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4842" href="UTxO.html#4842" class="Bound">¬p</a> <a id="4845" class="Symbol">=</a> <a id="4847" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4850" href="UTxO.html#4865" class="Function">absurd</a>
  <a id="4859" class="Keyword">where</a> <a id="4865" href="UTxO.html#4865" class="Function">absurd</a> <a id="4872" class="Symbol">:</a> <a id="4874" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="4876" href="UTxO.html#3032" class="Record">IsValidTx</a> <a id="4886" class="Bound">tx</a> <a id="4889" class="Bound">s</a>
        <a id="4899" href="UTxO.html#4865" class="Function">absurd</a> <a id="4906" class="Symbol">(</a><a id="4907" class="Keyword">record</a> <a id="4914" class="Symbol">{</a><a id="4915" href="UTxO.html#3146" class="Field">validOutputRefs</a> <a id="4931" class="Symbol">=</a> <a id="4933" href="UTxO.html#4933" class="Bound">vor′</a><a id="4937" class="Symbol">;</a> <a id="4939" href="UTxO.html#3390" class="Field">preservesValues</a> <a id="4955" class="Symbol">=</a> <a id="4957" href="UTxO.html#4957" class="Bound">p</a><a id="4958" class="Symbol">})</a>
          <a id="4971" class="Keyword">rewrite</a> <a id="4979" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="4996" class="Symbol">(</a><a id="4997" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="5003" href="UTxO.html#4668" class="Bound">uniq</a><a id="5007" class="Symbol">)</a> <a id="5009" class="Bound">vor</a> <a id="5013" href="UTxO.html#4933" class="Bound">vor′</a> <a id="5018" class="Symbol">=</a> <a id="5020" href="UTxO.html#4842" class="Bound">¬p</a> <a id="5023" href="UTxO.html#4957" class="Bound">p</a>
<a id="5025" class="Symbol">...</a> <a id="5029" class="Symbol">|</a> <a id="5031" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5035" href="UTxO.html#5035" class="Bound">pv</a> <a id="5038" class="Keyword">with</a> <a id="5043" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="5047" class="Symbol">...</a> <a id="5051" class="Symbol">|</a> <a id="5053" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5056" href="UTxO.html#5056" class="Bound">¬p</a> <a id="5059" class="Symbol">=</a> <a id="5061" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5064" href="UTxO.html#5079" class="Function">absurd</a>
  <a id="5073" class="Keyword">where</a> <a id="5079" href="UTxO.html#5079" class="Function">absurd</a> <a id="5086" class="Symbol">:</a> <a id="5088" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="5090" href="UTxO.html#3032" class="Record">IsValidTx</a> <a id="5100" class="Bound">tx</a> <a id="5103" class="Bound">s</a>
        <a id="5113" href="UTxO.html#5079" class="Function">absurd</a> <a id="5120" class="Symbol">(</a><a id="5121" class="Keyword">record</a> <a id="5128" class="Symbol">{</a><a id="5129" href="UTxO.html#3146" class="Field">validOutputRefs</a> <a id="5145" class="Symbol">=</a> <a id="5147" href="UTxO.html#5147" class="Bound">vor′</a><a id="5151" class="Symbol">;</a> <a id="5153" href="UTxO.html#3488" class="Field">allInputsValidate</a> <a id="5171" class="Symbol">=</a> <a id="5173" href="UTxO.html#5173" class="Bound">p</a><a id="5174" class="Symbol">})</a>
          <a id="5187" class="Keyword">rewrite</a> <a id="5195" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="5212" class="Symbol">(</a><a id="5213" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="5219" href="UTxO.html#4668" class="Bound">uniq</a><a id="5223" class="Symbol">)</a> <a id="5225" class="Bound">vor</a> <a id="5229" href="UTxO.html#5147" class="Bound">vor′</a> <a id="5234" class="Symbol">=</a> <a id="5236" href="UTxO.html#5056" class="Bound">¬p</a> <a id="5239" href="UTxO.html#5173" class="Bound">p</a>
<a id="5241" class="Symbol">...</a> <a id="5245" class="Symbol">|</a> <a id="5247" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5251" href="UTxO.html#5251" class="Bound">aiv</a> <a id="5255" class="Keyword">with</a> <a id="5260" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="5264" class="Symbol">...</a> <a id="5268" class="Symbol">|</a> <a id="5270" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5273" href="UTxO.html#5273" class="Bound">¬p</a> <a id="5276" class="Symbol">=</a> <a id="5278" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5281" href="UTxO.html#5296" class="Function">absurd</a>
  <a id="5290" class="Keyword">where</a> <a id="5296" href="UTxO.html#5296" class="Function">absurd</a> <a id="5303" class="Symbol">:</a> <a id="5305" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="5307" href="UTxO.html#3032" class="Record">IsValidTx</a> <a id="5317" class="Bound">tx</a> <a id="5320" class="Bound">s</a>
        <a id="5330" href="UTxO.html#5296" class="Function">absurd</a> <a id="5337" class="Symbol">(</a><a id="5338" class="Keyword">record</a> <a id="5345" class="Symbol">{</a><a id="5346" href="UTxO.html#3146" class="Field">validOutputRefs</a> <a id="5362" class="Symbol">=</a> <a id="5364" href="UTxO.html#5364" class="Bound">vor′</a><a id="5368" class="Symbol">;</a> <a id="5370" href="UTxO.html#3585" class="Field">validateValidHashes</a> <a id="5390" class="Symbol">=</a> <a id="5392" href="UTxO.html#5392" class="Bound">p</a><a id="5393" class="Symbol">})</a>
          <a id="5406" class="Keyword">rewrite</a> <a id="5414" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="5431" class="Symbol">(</a><a id="5432" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="5438" href="UTxO.html#4668" class="Bound">uniq</a><a id="5442" class="Symbol">)</a> <a id="5444" class="Bound">vor</a> <a id="5448" href="UTxO.html#5364" class="Bound">vor′</a> <a id="5453" class="Symbol">=</a> <a id="5455" href="UTxO.html#5273" class="Bound">¬p</a> <a id="5458" href="UTxO.html#5392" class="Bound">p</a>
<a id="5460" class="Symbol">...</a> <a id="5464" class="Symbol">|</a> <a id="5466" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5470" href="UTxO.html#5470" class="Bound">vvh</a> <a id="5474" class="Symbol">=</a> <a id="5476" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5480" class="Keyword">record</a>
  <a id="5489" class="Symbol">{</a> <a id="5491" href="UTxO.html#3092" class="Field">noDoubleSpending</a> <a id="5508" class="Symbol">=</a> <a id="5510" class="Bound">ndp</a>
  <a id="5516" class="Symbol">;</a> <a id="5518" href="UTxO.html#3146" class="Field">validOutputRefs</a> <a id="5534" class="Symbol">=</a> <a id="5536" class="Bound">vor</a>
  <a id="5542" class="Symbol">;</a> <a id="5544" href="UTxO.html#3390" class="Field">preservesValues</a> <a id="5560" class="Symbol">=</a> <a id="5562" class="Bound">pv</a>
  <a id="5567" class="Symbol">;</a> <a id="5569" href="UTxO.html#3488" class="Field">allInputsValidate</a> <a id="5587" class="Symbol">=</a> <a id="5589" class="Bound">aiv</a>
  <a id="5595" class="Symbol">;</a> <a id="5597" href="UTxO.html#3585" class="Field">validateValidHashes</a> <a id="5617" class="Symbol">=</a> <a id="5619" href="UTxO.html#5470" class="Bound">vvh</a> <a id="5623" class="Symbol">}</a>

<a id="isValidTx"></a><a id="5626" href="UTxO.html#5626" class="Function">isValidTx</a> <a id="5636" class="Symbol">:</a> <a id="5638" href="UTxO.html#1129" class="Record">Tx</a> <a id="5641" class="Symbol">→</a> <a id="5643" href="UTxO.html#2539" class="Function">UTxO</a> <a id="5648" class="Symbol">→</a> <a id="5650" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="5655" href="UTxO.html#5626" class="Function">isValidTx</a> <a id="5665" href="UTxO.html#5665" class="Bound">tx</a> <a id="5668" href="UTxO.html#5668" class="Bound">s</a> <a id="5670" class="Symbol">=</a> <a id="5672" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="5674" href="UTxO.html#4590" class="Function">isValidTx?</a> <a id="5685" href="UTxO.html#5665" class="Bound">tx</a> <a id="5688" href="UTxO.html#5668" class="Bound">s</a> <a id="5690" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a>

<a id="checkTx"></a><a id="5693" href="UTxO.html#5693" class="Function">checkTx</a> <a id="5701" class="Symbol">:</a> <a id="5703" href="UTxO.html#735" class="Record">TxInfo</a> <a id="5710" class="Symbol">→</a> <a id="5712" href="UTxO.html#2539" class="Function">UTxO</a> <a id="5717" class="Symbol">→</a> <a id="5719" href="UTxO.html#1129" class="Record">Tx</a> <a id="5722" class="Symbol">→</a> <a id="5724" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="5729" href="UTxO.html#5693" class="Function">checkTx</a> <a id="5737" href="UTxO.html#5737" class="Bound">txi</a> <a id="5741" href="UTxO.html#5741" class="Bound">s</a> <a id="5743" href="UTxO.html#5743" class="Bound">tx</a> <a id="5746" class="Keyword">with</a> <a id="5751" href="UTxO.html#4590" class="Function">isValidTx?</a> <a id="5762" href="UTxO.html#5743" class="Bound">tx</a> <a id="5765" href="UTxO.html#5741" class="Bound">s</a>
<a id="5767" class="Symbol">...</a> <a id="5771" class="Symbol">|</a> <a id="5773" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5776" class="Symbol">_</a>  <a id="5779" class="Symbol">=</a> <a id="5781" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
<a id="5787" class="Symbol">...</a> <a id="5791" class="Symbol">|</a> <a id="5793" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5797" href="UTxO.html#5797" class="Bound">valid</a> <a id="5803" class="Symbol">=</a> <a id="5805" class="Bound">txi</a> <a id="5809" href="Prelude.DecEq.Core.html#222" class="Function Operator">==</a> <a id="5812" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="5821" class="Bound">tx</a> <a id="5824" class="Symbol">(</a><a id="5825" href="UTxO.html#3221" class="Function">resolved</a> <a id="5834" href="UTxO.html#5797" class="Bound">valid</a><a id="5839" class="Symbol">)</a>

<a id="mint"></a><a id="5842" href="UTxO.html#5842" class="Function">mint</a> <a id="5847" class="Symbol">:</a> <a id="5849" href="UTxO.html#735" class="Record">TxInfo</a> <a id="5856" class="Symbol">→</a> <a id="5858" href="UTxO.html#41" class="Function">Value</a>
<a id="5864" href="UTxO.html#5842" class="Function">mint</a> <a id="5869" class="Symbol">=</a> <a id="5871" href="UTxO.html#828" class="Field">TxInfo.forge</a>

<a id="5885" class="Keyword">variable</a>
  <a id="5896" href="UTxO.html#5896" class="Generalizable">tx</a> <a id="5899" class="Symbol">:</a> <a id="5901" href="UTxO.html#1129" class="Record">Tx</a>
  <a id="5906" href="UTxO.html#5906" class="Generalizable">l</a> <a id="5908" class="Symbol">:</a> <a id="5910" href="UTxO.html#1299" class="Function">L</a>
  <a id="5914" href="UTxO.html#5914" class="Generalizable">txi</a> <a id="5918" class="Symbol">:</a> <a id="5920" href="UTxO.html#735" class="Record">TxInfo</a>
  <a id="5929" href="UTxO.html#5929" class="Generalizable">utxos</a> <a id="5935" href="UTxO.html#5935" class="Generalizable">utxos′</a> <a id="5942" class="Symbol">:</a> <a id="5944" href="UTxO.html#2539" class="Function">UTxO</a>
  <a id="5951" href="UTxO.html#5951" class="Generalizable">v</a> <a id="5953" href="UTxO.html#5953" class="Generalizable">v′</a> <a id="5956" href="UTxO.html#5956" class="Generalizable">v″</a> <a id="5959" class="Symbol">:</a> <a id="5961" href="UTxO.html#41" class="Function">Value</a>

<a id="5968" class="Comment">-- ** LEDGER small-step relation</a>
<a id="6001" class="Keyword">data</a> <a id="_⊢_—⟨_∣LEDGER⟩→_"></a><a id="6006" href="UTxO.html#6006" class="Datatype Operator">_⊢_—⟨_∣LEDGER⟩→_</a> <a id="6023" class="Symbol">:</a> <a id="6025" href="Prelude.html#2479" class="Function">SSRel</a> <a id="6031" href="UTxO.html#735" class="Record">TxInfo</a> <a id="6038" href="UTxO.html#2539" class="Function">UTxO</a> <a id="6043" href="UTxO.html#1129" class="Record">Tx</a> <a id="6046" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣LEDGER⟩→_.ApplyTx"></a><a id="6055" href="UTxO.html#6055" class="InductiveConstructor">ApplyTx</a> <a id="6063" class="Symbol">:</a> <a id="6065" class="Keyword">let</a> <a id="6069" href="UTxO.html#6069" class="Bound">utxos′</a> <a id="6076" class="Symbol">=</a> <a id="6078" href="UTxO.html#2866" class="Function">applyTx</a> <a id="6086" href="UTxO.html#5896" class="Generalizable">tx</a> <a id="6089" href="UTxO.html#5929" class="Generalizable">utxos</a> <a id="6095" class="Keyword">in</a>
    <a id="6102" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="6104" class="Symbol">(</a><a id="6105" href="UTxO.html#5693" class="Function">checkTx</a> <a id="6113" href="UTxO.html#5914" class="Generalizable">txi</a> <a id="6117" href="UTxO.html#5929" class="Generalizable">utxos</a> <a id="6123" href="UTxO.html#5896" class="Generalizable">tx</a><a id="6125" class="Symbol">)</a>
    <a id="6131" href="Prelude.InferenceRules.html#13683" class="Function Operator">──────────────────────────────────</a>
    <a id="6170" href="UTxO.html#5914" class="Generalizable">txi</a> <a id="6174" href="UTxO.html#6006" class="Datatype Operator">⊢</a> <a id="6176" href="UTxO.html#5929" class="Generalizable">utxos</a> <a id="6182" href="UTxO.html#6006" class="Datatype Operator">—⟨</a> <a id="6185" href="UTxO.html#5896" class="Generalizable">tx</a> <a id="6188" href="UTxO.html#6006" class="Datatype Operator">∣LEDGER⟩→</a> <a id="6198" href="UTxO.html#6069" class="Bound">utxos′</a>

<a id="6206" class="Comment">-- ** TX-LEDGER small-step relation</a>
<a id="6242" class="Keyword">data</a> <a id="_⊢_—⟨_∣TX-LEDGER⟩→_"></a><a id="6247" href="UTxO.html#6247" class="Datatype Operator">_⊢_—⟨_∣TX-LEDGER⟩→_</a> <a id="6267" class="Symbol">:</a> <a id="6269" href="Prelude.html#2479" class="Function">SSRel</a> <a id="6275" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a> <a id="6277" href="UTxO.html#1299" class="Function">L</a> <a id="6279" href="UTxO.html#1129" class="Record">Tx</a> <a id="6282" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣TX-LEDGER⟩→_.ApplyTx"></a><a id="6291" href="UTxO.html#6291" class="InductiveConstructor">ApplyTx</a> <a id="6299" class="Symbol">:</a>
    <a id="6305" href="UTxO.html#3032" class="Record">IsValidTx</a> <a id="6315" href="UTxO.html#5896" class="Generalizable">tx</a> <a id="6318" class="Symbol">(</a><a id="6319" href="UTxO.html#2951" class="Function">utxo</a> <a id="6324" href="UTxO.html#5906" class="Generalizable">l</a><a id="6325" class="Symbol">)</a>
    <a id="6331" href="Prelude.InferenceRules.html#13722" class="Function Operator">─────────────────────────────────</a>
    <a id="6369" class="Symbol">_</a> <a id="6371" href="UTxO.html#6247" class="Datatype Operator">⊢</a> <a id="6373" href="UTxO.html#5906" class="Generalizable">l</a> <a id="6375" href="UTxO.html#6247" class="Datatype Operator">—⟨</a> <a id="6378" href="UTxO.html#5896" class="Generalizable">tx</a> <a id="6381" href="UTxO.html#6247" class="Datatype Operator">∣TX-LEDGER⟩→</a> <a id="6394" class="Symbol">(</a><a id="6395" href="UTxO.html#5896" class="Generalizable">tx</a> <a id="6398" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="6400" href="UTxO.html#5906" class="Generalizable">l</a><a id="6401" class="Symbol">)</a>

<a id="6404" class="Keyword">postulate</a>
  <a id="TX-LEDGER-reifies-LEDGER"></a><a id="6416" href="UTxO.html#6416" class="Postulate">TX-LEDGER-reifies-LEDGER</a> <a id="6441" class="Symbol">:</a> <a id="6443" href="UTxO.html#6247" class="Datatype Operator">_⊢_—⟨_∣TX-LEDGER⟩→_</a> <a id="6463" href="Prelude.html#2697" class="Record Operator">≼</a> <a id="6465" href="UTxO.html#6006" class="Datatype Operator">_⊢_—⟨_∣LEDGER⟩→_</a>
<a id="6482" class="Comment">-- TX-LEDGER-reifies-LEDGER = record</a>
<a id="6519" class="Comment">--   { πₑ = λ _ s tx → mkTxInfo tx {!resolved valid!} -- (resolved valid)</a>
<a id="6593" class="Comment">--   ; πₛ = π</a>
<a id="6607" class="Comment">--   ; πᵢ = id</a>
<a id="6622" class="Comment">--   ; implements = proof</a>
<a id="6648" class="Comment">--   }</a>
<a id="6655" class="Comment">--   where</a>
<a id="6666" class="Comment">--     π = utxo</a>

<a id="6683" class="Comment">--     getValid : ∀ {Γ l tx l′} → Γ ⊢ l —⟨ tx ∣TX-LEDGER⟩→ l′ → IsValidTx tx (utxo l)</a>
<a id="6769" class="Comment">--     getValid (ApplyTx val) = val</a>

<a id="6806" class="Comment">--     proof : ∀ Γ l tx l′ →</a>
<a id="6835" class="Comment">--       (l→ : Γ ⊢ l —⟨ tx ∣TX-LEDGER⟩→ l′) →</a>
<a id="6881" class="Comment">--       ──────────────────────────────────────</a>
<a id="6929" class="Comment">--       mkTxInfo tx {!resolved $ getValid l→ !} ⊢ utxo l —⟨ tx ∣LEDGER⟩→ utxo l′</a>
<a id="7011" class="Comment">--     proof _ l tx .(tx ∷ l) (ApplyTx val) = {!!}</a>
</pre></body></html>