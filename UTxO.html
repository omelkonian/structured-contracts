<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/structured-contracts/tree/master/UTxO.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="UTxO.html" class="Module">UTxO</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Prelude.html" class="Module">Prelude</a>

<a id="Value"></a><a id="41" href="UTxO.html#41" class="Function">Value</a>   <a id="49" class="Symbol">=</a> <a id="51" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="53" href="UTxO.html#53" class="Function">HashId</a>  <a id="61" class="Symbol">=</a> <a id="63" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="Slot"></a><a id="65" href="UTxO.html#65" class="Function">Slot</a>    <a id="73" class="Symbol">=</a> <a id="75" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="Address"></a><a id="77" href="UTxO.html#77" class="Function">Address</a> <a id="85" class="Symbol">=</a> <a id="87" href="UTxO.html#53" class="Function">HashId</a>
<a id="94" class="Keyword">postulate</a> <a id="_♯"></a><a id="104" href="UTxO.html#104" class="Postulate Operator">_♯</a> <a id="107" class="Symbol">:</a> <a id="109" class="Symbol">∀</a> <a id="111" class="Symbol">{</a><a id="112" href="UTxO.html#112" class="Bound">A</a> <a id="114" class="Symbol">:</a> <a id="116" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="121" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="122" class="Symbol">}</a> <a id="124" class="Symbol">→</a> <a id="126" href="UTxO.html#112" class="Bound">A</a> <a id="128" class="Symbol">→</a> <a id="130" href="UTxO.html#53" class="Function">HashId</a>

<a id="DATA"></a><a id="138" href="UTxO.html#138" class="Function">DATA</a> <a id="143" class="Symbol">=</a> <a id="145" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="147" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="∑"></a><a id="191" href="UTxO.html#191" class="Function">∑</a> <a id="193" class="Symbol">:</a> <a id="195" class="Symbol">∀</a> <a id="197" class="Symbol">{</a><a id="198" href="UTxO.html#198" class="Bound">A</a> <a id="200" class="Symbol">:</a> <a id="202" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="206" class="Symbol">}</a> <a id="208" class="Symbol">→</a> <a id="210" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="215" href="UTxO.html#198" class="Bound">A</a> <a id="217" class="Symbol">→</a> <a id="219" class="Symbol">(</a><a id="220" href="UTxO.html#198" class="Bound">A</a> <a id="222" class="Symbol">→</a> <a id="224" href="UTxO.html#41" class="Function">Value</a><a id="229" class="Symbol">)</a> <a id="231" class="Symbol">→</a> <a id="233" href="UTxO.html#41" class="Function">Value</a>
<a id="239" href="UTxO.html#191" class="Function">∑</a> <a id="241" href="UTxO.html#241" class="Bound">xs</a> <a id="244" href="UTxO.html#244" class="Bound">f</a> <a id="246" class="Symbol">=</a> <a id="248" href="Prelude.Lists.Sums.html#295" class="Function">∑ℕ</a> <a id="251" class="Symbol">(</a><a id="252" href="Data.List.Base.html#1553" class="Function">map</a> <a id="256" href="UTxO.html#244" class="Bound">f</a> <a id="258" href="UTxO.html#241" class="Bound">xs</a><a id="260" class="Symbol">)</a>

<a id="263" class="Keyword">record</a> <a id="TxOutput"></a><a id="270" href="UTxO.html#270" class="Record">TxOutput</a> <a id="279" class="Symbol">:</a> <a id="281" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="286" class="Keyword">where</a>
  <a id="294" class="Keyword">constructor</a> <a id="_at_"></a><a id="306" href="UTxO.html#306" class="InductiveConstructor Operator">_at_</a>
  <a id="313" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="319" href="UTxO.html#319" class="Field">value</a>    <a id="328" class="Symbol">:</a> <a id="330" href="UTxO.html#41" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="344" href="UTxO.html#344" class="Field">address</a>  <a id="353" class="Symbol">:</a> <a id="355" href="UTxO.html#77" class="Function">Address</a>
<a id="363" class="Keyword">open</a> <a id="368" href="UTxO.html#270" class="Module">TxOutput</a> <a id="377" class="Keyword">public</a>
<a id="384" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="396" href="UTxO.html#396" class="Function">DecEq-TxO</a> <a id="406" class="Symbol">=</a> <a id="408" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="415" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="421" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="423" class="Keyword">quote</a> <a id="429" href="UTxO.html#270" class="Record">TxOutput</a> <a id="438" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="440" href="UTxO.html#396" class="Function">DecEq-TxO</a> <a id="450" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="453" class="Keyword">record</a> <a id="InputInfo"></a><a id="460" href="UTxO.html#460" class="Record">InputInfo</a> <a id="470" class="Symbol">:</a> <a id="472" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="477" class="Keyword">where</a>
  <a id="485" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="491" href="UTxO.html#491" class="Field">outputRef</a>     <a id="505" class="Symbol">:</a> <a id="507" href="UTxO.html#270" class="Record">TxOutput</a>
        <a id="524" class="Comment">-- NB: the actual implementation also keeps references here</a>
        <a id="InputInfo.validatorHash"></a><a id="592" href="UTxO.html#592" class="Field">validatorHash</a> <a id="606" class="Symbol">:</a> <a id="608" href="UTxO.html#53" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="623" href="UTxO.html#623" class="Field">redeemerHash</a>  <a id="637" class="Symbol">:</a> <a id="639" href="UTxO.html#53" class="Function">HashId</a>
<a id="646" class="Keyword">unquoteDecl</a> <a id="DecEq-InputInfo"></a><a id="658" href="UTxO.html#658" class="Function">DecEq-InputInfo</a> <a id="674" class="Symbol">=</a> <a id="676" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="683" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="689" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="691" class="Keyword">quote</a> <a id="697" href="UTxO.html#460" class="Record">InputInfo</a> <a id="707" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="709" href="UTxO.html#658" class="Function">DecEq-InputInfo</a> <a id="725" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="728" class="Keyword">record</a> <a id="TxInfo"></a><a id="735" href="UTxO.html#735" class="Record">TxInfo</a> <a id="742" class="Symbol">:</a> <a id="744" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="749" class="Keyword">where</a>
  <a id="757" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="763" href="UTxO.html#763" class="Field">inputs</a>  <a id="771" class="Symbol">:</a> <a id="773" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="778" href="UTxO.html#460" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="796" href="UTxO.html#796" class="Field">outputs</a> <a id="804" class="Symbol">:</a> <a id="806" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="811" href="UTxO.html#270" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="828" href="UTxO.html#828" class="Field">forge</a>   <a id="836" class="Symbol">:</a> <a id="838" href="UTxO.html#41" class="Function">Value</a>
<a id="844" class="Keyword">unquoteDecl</a> <a id="DecEq-TxInfo"></a><a id="856" href="UTxO.html#856" class="Function">DecEq-TxInfo</a> <a id="869" class="Symbol">=</a> <a id="871" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="878" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="884" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="886" class="Keyword">quote</a> <a id="892" href="UTxO.html#735" class="Record">TxInfo</a> <a id="899" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="901" href="UTxO.html#856" class="Function">DecEq-TxInfo</a> <a id="914" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="917" class="Keyword">module</a> <a id="CommonInfo"></a><a id="924" href="UTxO.html#924" class="Module">CommonInfo</a> <a id="935" class="Symbol">(</a><a id="936" href="UTxO.html#936" class="Bound">TxOutputRef</a> <a id="948" class="Symbol">:</a> <a id="950" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="954" class="Symbol">)</a> <a id="956" class="Keyword">where</a>

  <a id="965" class="Keyword">record</a> <a id="CommonInfo.TxInput"></a><a id="972" href="UTxO.html#972" class="Record">TxInput</a> <a id="980" class="Symbol">:</a> <a id="982" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="987" class="Keyword">where</a>
    <a id="997" class="Keyword">field</a> <a id="CommonInfo.TxInput.outputRef"></a><a id="1003" href="UTxO.html#1003" class="Field">outputRef</a> <a id="1013" class="Symbol">:</a> <a id="1015" href="UTxO.html#936" class="Bound">TxOutputRef</a>
          <a id="CommonInfo.TxInput.validator"></a><a id="1037" href="UTxO.html#1037" class="Field">validator</a> <a id="1047" class="Symbol">:</a> <a id="1049" href="UTxO.html#735" class="Record">TxInfo</a> <a id="1056" class="Symbol">→</a> <a id="1058" href="UTxO.html#138" class="Function">DATA</a> <a id="1063" class="Symbol">→</a> <a id="1065" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
          <a id="CommonInfo.TxInput.redeemer"></a><a id="1080" href="UTxO.html#1080" class="Field">redeemer</a>  <a id="1090" class="Symbol">:</a> <a id="1092" href="UTxO.html#138" class="Function">DATA</a>
  <a id="1099" class="Keyword">open</a> <a id="1104" href="UTxO.html#972" class="Module">TxInput</a> <a id="1112" class="Keyword">public</a>

  <a id="1122" class="Keyword">record</a> <a id="CommonInfo.Tx"></a><a id="1129" href="UTxO.html#1129" class="Record">Tx</a> <a id="1132" class="Symbol">:</a> <a id="1134" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1139" class="Keyword">where</a>
    <a id="1149" class="Keyword">field</a> <a id="CommonInfo.Tx.inputs"></a><a id="1155" href="UTxO.html#1155" class="Field">inputs</a>  <a id="1163" class="Symbol">:</a> <a id="1165" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1170" href="UTxO.html#972" class="Record">TxInput</a>
          <a id="CommonInfo.Tx.outputs"></a><a id="1188" href="UTxO.html#1188" class="Field">outputs</a> <a id="1196" class="Symbol">:</a> <a id="1198" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1203" href="UTxO.html#270" class="Record">TxOutput</a>
          <a id="CommonInfo.Tx.forge"></a><a id="1222" href="UTxO.html#1222" class="Field">forge</a>   <a id="1230" class="Symbol">:</a> <a id="1232" href="UTxO.html#41" class="Function">Value</a>
  <a id="1240" class="Keyword">open</a> <a id="1245" href="UTxO.html#1129" class="Module">Tx</a> <a id="1248" class="Keyword">public</a>

  <a id="1258" class="Comment">-- A ledger is a list of transactions.</a>
  <a id="CommonInfo.L"></a><a id="1299" href="UTxO.html#1299" class="Function">L</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1308" href="UTxO.html#1129" class="Record">Tx</a>

  <a id="1314" class="Keyword">instance</a>
    <a id="CommonInfo.Semigroup-L"></a><a id="1327" href="UTxO.html#1327" class="Function">Semigroup-L</a> <a id="1339" class="Symbol">:</a> <a id="1341" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="1351" href="UTxO.html#1299" class="Function">L</a>
    <a id="1357" href="UTxO.html#1327" class="Function">Semigroup-L</a> <a id="1369" class="Symbol">.</a><a id="1370" href="Prelude.Semigroup.html#251" class="Field Operator">_◇_</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Data.List.Base.html#1819" class="Function Operator">_++_</a>

    <a id="CommonInfo.Monoid-L"></a><a id="1386" href="UTxO.html#1386" class="Function">Monoid-L</a> <a id="1395" class="Symbol">:</a> <a id="1397" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="1404" href="UTxO.html#1299" class="Function">L</a>
    <a id="1410" href="UTxO.html#1386" class="Function">Monoid-L</a> <a id="1419" class="Symbol">.</a><a id="1420" href="Prelude.Monoid.html#222" class="Field">ε</a> <a id="1422" class="Symbol">=</a> <a id="1424" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

  <a id="1430" class="Comment">-- Auxiliary definitions.</a>

  <a id="CommonInfo.outputRefs"></a><a id="1459" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="1470" class="Symbol">:</a> <a id="1472" href="UTxO.html#1129" class="Record">Tx</a> <a id="1475" class="Symbol">→</a> <a id="1477" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1482" href="UTxO.html#936" class="Bound">TxOutputRef</a>
  <a id="1496" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="1507" class="Symbol">=</a> <a id="1509" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1513" href="UTxO.html#1003" class="Field">outputRef</a> <a id="1523" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1525" href="UTxO.html#1155" class="Field">inputs</a>

  <a id="CommonInfo.Resolved"></a><a id="1535" href="UTxO.html#1535" class="Function">Resolved</a> <a id="1544" class="Symbol">:</a> <a id="1546" href="Prelude.Init.html#13332" class="Function">Pred₀</a> <a id="1552" href="UTxO.html#1129" class="Record">Tx</a>
  <a id="1557" href="UTxO.html#1535" class="Function">Resolved</a> <a id="1566" href="UTxO.html#1566" class="Bound">tx</a> <a id="1569" class="Symbol">=</a> <a id="1571" class="Symbol">∀</a> <a id="1573" class="Symbol">{</a><a id="1574" href="UTxO.html#1574" class="Bound">r</a><a id="1575" class="Symbol">}</a> <a id="1577" class="Symbol">→</a> <a id="1579" href="UTxO.html#1574" class="Bound">r</a> <a id="1581" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="1583" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="1594" href="UTxO.html#1566" class="Bound">tx</a> <a id="1597" class="Symbol">→</a> <a id="1599" href="UTxO.html#270" class="Record">TxOutput</a>

  <a id="CommonInfo.ResolvedInput"></a><a id="1611" href="UTxO.html#1611" class="Function">ResolvedInput</a>  <a id="1626" class="Symbol">=</a> <a id="1628" href="UTxO.html#972" class="Record">TxInput</a> <a id="1636" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1638" href="UTxO.html#270" class="Record">TxOutput</a>
  <a id="CommonInfo.ResolvedInputs"></a><a id="1649" href="UTxO.html#1649" class="Function">ResolvedInputs</a> <a id="1664" class="Symbol">=</a> <a id="1666" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1671" href="UTxO.html#1611" class="Function">ResolvedInput</a>

  <a id="CommonInfo.resolveInputs"></a><a id="1688" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="1702" class="Symbol">:</a> <a id="1704" class="Symbol">∀</a> <a id="1706" href="UTxO.html#1706" class="Bound">tx</a> <a id="1709" class="Symbol">→</a> <a id="1711" href="UTxO.html#1535" class="Function">Resolved</a> <a id="1720" href="UTxO.html#1706" class="Bound">tx</a> <a id="1723" class="Symbol">→</a> <a id="1725" href="UTxO.html#1649" class="Function">ResolvedInputs</a>
  <a id="1742" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="1756" href="UTxO.html#1756" class="Bound">tx</a> <a id="1759" href="UTxO.html#1759" class="Bound">resolvedTx</a> <a id="1770" class="Symbol">=</a> <a id="1772" href="Data.List.Membership.Setoid.html#1137" class="Function">mapWith∈</a> <a id="1781" class="Symbol">(</a><a id="1782" href="UTxO.html#1756" class="Bound">tx</a> <a id="1785" class="Symbol">.</a><a id="1786" href="UTxO.html#1155" class="Field">inputs</a><a id="1792" class="Symbol">)</a> <a id="1794" class="Symbol">λ</a> <a id="1796" class="Symbol">{</a><a id="1797" href="UTxO.html#1797" class="Bound">i</a><a id="1798" class="Symbol">}</a> <a id="1800" href="UTxO.html#1800" class="Bound">i∈</a> <a id="1803" class="Symbol">→</a>
    <a id="1809" href="UTxO.html#1797" class="Bound">i</a> <a id="1811" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1813" href="UTxO.html#1759" class="Bound">resolvedTx</a> <a id="1824" class="Symbol">(</a><a id="1825" href="Data.List.Membership.Propositional.Properties.html#3377" class="Function">∈-map⁺</a> <a id="1832" href="UTxO.html#1003" class="Field">outputRef</a> <a id="1842" href="UTxO.html#1800" class="Bound">i∈</a><a id="1844" class="Symbol">)</a>

  <a id="CommonInfo.mkInputInfo"></a><a id="1849" href="UTxO.html#1849" class="Function">mkInputInfo</a> <a id="1861" class="Symbol">:</a> <a id="1863" href="UTxO.html#1611" class="Function">ResolvedInput</a> <a id="1877" class="Symbol">→</a> <a id="1879" href="UTxO.html#460" class="Record">InputInfo</a>
  <a id="1891" href="UTxO.html#1849" class="Function">mkInputInfo</a> <a id="1903" class="Symbol">(</a><a id="1904" href="UTxO.html#1904" class="Bound">i</a> <a id="1906" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1908" href="UTxO.html#1908" class="Bound">o</a><a id="1909" class="Symbol">)</a> <a id="1911" class="Symbol">=</a> <a id="1913" class="Keyword">record</a>
    <a id="1924" class="Symbol">{</a> <a id="1926" href="UTxO.html#491" class="Field">outputRef</a>     <a id="1940" class="Symbol">=</a> <a id="1942" href="UTxO.html#1908" class="Bound">o</a>
    <a id="1948" class="Symbol">;</a> <a id="1950" href="UTxO.html#592" class="Field">validatorHash</a> <a id="1964" class="Symbol">=</a> <a id="1966" href="UTxO.html#1904" class="Bound">i</a> <a id="1968" class="Symbol">.</a><a id="1969" href="UTxO.html#1037" class="Field">validator</a> <a id="1979" href="UTxO.html#104" class="Postulate Operator">♯</a>
    <a id="1985" class="Symbol">;</a> <a id="1987" href="UTxO.html#623" class="Field">redeemerHash</a>  <a id="2001" class="Symbol">=</a> <a id="2003" href="UTxO.html#1904" class="Bound">i</a> <a id="2005" class="Symbol">.</a><a id="2006" href="UTxO.html#1080" class="Field">redeemer</a> <a id="2015" href="UTxO.html#104" class="Postulate Operator">♯</a> <a id="2017" class="Symbol">}</a>

  <a id="CommonInfo.mkTxInfo"></a><a id="2022" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="2031" class="Symbol">:</a> <a id="2033" class="Symbol">∀</a> <a id="2035" class="Symbol">(</a><a id="2036" href="UTxO.html#2036" class="Bound">tx</a> <a id="2039" class="Symbol">:</a> <a id="2041" href="UTxO.html#1129" class="Record">Tx</a><a id="2043" class="Symbol">)</a> <a id="2045" class="Symbol">→</a> <a id="2047" href="UTxO.html#1535" class="Function">Resolved</a> <a id="2056" href="UTxO.html#2036" class="Bound">tx</a> <a id="2059" class="Symbol">→</a> <a id="2061" href="UTxO.html#735" class="Record">TxInfo</a>
  <a id="2070" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="2079" href="UTxO.html#2079" class="Bound">tx</a> <a id="2082" href="UTxO.html#2082" class="Bound">resolvedTx</a> <a id="2093" class="Symbol">=</a> <a id="2095" class="Keyword">record</a>
    <a id="2106" class="Symbol">{</a> <a id="2108" href="UTxO.html#763" class="Field">inputs</a>  <a id="2116" class="Symbol">=</a> <a id="2118" href="UTxO.html#1849" class="Function">mkInputInfo</a> <a id="2130" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="2134" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="2148" href="UTxO.html#2079" class="Bound">tx</a> <a id="2151" href="UTxO.html#2082" class="Bound">resolvedTx</a>
    <a id="2166" class="Symbol">;</a> <a id="2168" href="UTxO.html#796" class="Field">outputs</a> <a id="2176" class="Symbol">=</a> <a id="2178" href="UTxO.html#2079" class="Bound">tx</a> <a id="2181" class="Symbol">.</a><a id="2182" href="UTxO.html#1188" class="Field">outputs</a>
    <a id="2194" class="Symbol">;</a> <a id="2196" href="UTxO.html#828" class="Field">forge</a>   <a id="2204" class="Symbol">=</a> <a id="2206" href="UTxO.html#2079" class="Bound">tx</a> <a id="2209" class="Symbol">.</a><a id="2210" href="UTxO.html#1222" class="Field">forge</a> <a id="2216" class="Symbol">}</a>

<a id="All-syntax"></a><a id="2219" href="UTxO.html#2219" class="Function">All-syntax</a> <a id="2230" class="Symbol">=</a> <a id="2232" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a>
<a id="2236" class="Keyword">syntax</a> <a id="2243" href="UTxO.html#2219" class="Function">All-syntax</a> <a id="2254" class="Symbol">(λ</a> <a id="2257" class="Bound">i</a> <a id="2259" class="Symbol">→</a> <a id="2261" class="Bound">P</a><a id="2262" class="Symbol">)</a> <a id="2264" class="Bound">xs</a> <a id="2267" class="Symbol">=</a> <a id="2269" class="Function">∀[</a> <a id="2272" class="Bound">i</a> <a id="2274" class="Function">∈</a> <a id="2276" class="Bound">xs</a> <a id="2279" class="Function">]</a> <a id="2281" class="Bound">P</a>

<a id="Any-syntax"></a><a id="2284" href="UTxO.html#2284" class="Function">Any-syntax</a> <a id="2295" class="Symbol">=</a> <a id="2297" href="Data.List.Relation.Unary.Any.html#1165" class="Datatype">Any</a>
<a id="2301" class="Keyword">syntax</a> <a id="2308" href="UTxO.html#2284" class="Function">Any-syntax</a> <a id="2319" class="Symbol">(λ</a> <a id="2322" class="Bound">i</a> <a id="2324" class="Symbol">→</a> <a id="2326" class="Bound">P</a><a id="2327" class="Symbol">)</a> <a id="2329" class="Bound">xs</a> <a id="2332" class="Symbol">=</a> <a id="2334" class="Function">∃[</a> <a id="2337" class="Bound">i</a> <a id="2339" class="Function">∈</a> <a id="2341" class="Bound">xs</a> <a id="2344" class="Function">]</a> <a id="2346" class="Bound">P</a>

<a id="2349" class="Comment">--</a>

<a id="2353" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="2360" href="UTxO.html#2360" class="Record">TxOutputRef</a> <a id="2372" class="Symbol">:</a> <a id="2374" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="2379" class="Keyword">where</a>
  <a id="2387" class="Keyword">constructor</a> <a id="_indexed-at_"></a><a id="2399" href="UTxO.html#2399" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="2414" class="Keyword">field</a> <a id="TxOutputRef.txId"></a><a id="2420" href="UTxO.html#2420" class="Field">txId</a>  <a id="2426" class="Symbol">:</a> <a id="2428" href="UTxO.html#53" class="Function">HashId</a>
        <a id="TxOutputRef.index"></a><a id="2443" href="UTxO.html#2443" class="Field">index</a> <a id="2449" class="Symbol">:</a> <a id="2451" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="2453" class="Keyword">open</a> <a id="2458" href="UTxO.html#2360" class="Module">TxOutputRef</a> <a id="2470" class="Keyword">public</a>
<a id="2477" class="Keyword">unquoteDecl</a> <a id="DecEq-TxOR"></a><a id="2489" href="UTxO.html#2489" class="Function">DecEq-TxOR</a> <a id="2500" class="Symbol">=</a> <a id="2502" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="2509" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="2515" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2517" class="Keyword">quote</a> <a id="2523" href="UTxO.html#2360" class="Record">TxOutputRef</a> <a id="2535" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2537" href="UTxO.html#2489" class="Function">DecEq-TxOR</a> <a id="2548" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="2551" class="Keyword">open</a> <a id="2556" href="UTxO.html#924" class="Module">CommonInfo</a> <a id="2567" href="UTxO.html#2360" class="Record">TxOutputRef</a> <a id="2579" class="Keyword">public</a>

<a id="2587" class="Comment">-- The state of a ledger maps output references locked by a validator to a value.</a>
<a id="UTxO"></a><a id="2669" href="UTxO.html#2669" class="Function">UTxO</a> <a id="2674" class="Symbol">=</a> <a id="2676" href="Prelude.Maps.AsSets.html#550" class="Record">Map⟨</a> <a id="2681" href="UTxO.html#2360" class="Record">TxOutputRef</a> <a id="2693" href="Prelude.Maps.AsSets.html#550" class="Record">↦</a> <a id="2695" href="UTxO.html#270" class="Record">TxOutput</a> <a id="2704" href="Prelude.Maps.AsSets.html#550" class="Record">⟩</a>

<a id="mkUtxo"></a><a id="2707" href="UTxO.html#2707" class="Function">mkUtxo</a> <a id="2714" class="Symbol">:</a> <a id="2716" class="Symbol">∀</a> <a id="2718" class="Symbol">{</a><a id="2719" href="UTxO.html#2719" class="Bound">out</a><a id="2722" class="Symbol">}</a> <a id="2724" href="UTxO.html#2724" class="Bound">tx</a> <a id="2727" class="Symbol">→</a> <a id="2729" href="UTxO.html#2719" class="Bound">out</a> <a id="2733" href="Data.List.Membership.Setoid.html#896" class="Function Operator">L.Mem.∈</a> <a id="2741" href="UTxO.html#1188" class="Field">outputs</a> <a id="2749" href="UTxO.html#2724" class="Bound">tx</a> <a id="2752" class="Symbol">→</a> <a id="2754" href="UTxO.html#2360" class="Record">TxOutputRef</a> <a id="2766" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2768" href="UTxO.html#270" class="Record">TxOutput</a>
<a id="2777" href="UTxO.html#2707" class="Function">mkUtxo</a> <a id="2784" class="Symbol">{</a><a id="2785" href="UTxO.html#2785" class="Bound">out</a><a id="2788" class="Symbol">}</a> <a id="2790" href="UTxO.html#2790" class="Bound">tx</a> <a id="2793" href="UTxO.html#2793" class="Bound">out∈</a> <a id="2798" class="Symbol">=</a> <a id="2800" class="Symbol">(</a><a id="2801" href="UTxO.html#2790" class="Bound">tx</a> <a id="2804" href="UTxO.html#104" class="Postulate Operator">♯</a><a id="2805" class="Symbol">)</a> <a id="2807" href="UTxO.html#2399" class="InductiveConstructor Operator">indexed-at</a> <a id="2818" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="2822" class="Symbol">(</a><a id="2823" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="2835" href="UTxO.html#2793" class="Bound">out∈</a><a id="2839" class="Symbol">)</a> <a id="2841" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2843" href="UTxO.html#2785" class="Bound">out</a>

<a id="utxoTx"></a><a id="2848" href="UTxO.html#2848" class="Function">utxoTx</a> <a id="2855" class="Symbol">:</a> <a id="2857" href="UTxO.html#1129" class="Record">Tx</a> <a id="2860" class="Symbol">→</a> <a id="2862" href="UTxO.html#2669" class="Function">UTxO</a>
<a id="2867" href="UTxO.html#2848" class="Function">utxoTx</a> <a id="2874" href="UTxO.html#2874" class="Bound">tx</a> <a id="2877" class="Symbol">=</a> <a id="2879" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="2888" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2890" href="Data.List.Membership.Setoid.html#1137" class="Function">L.Mem.mapWith∈</a> <a id="2905" class="Symbol">(</a><a id="2906" href="UTxO.html#2874" class="Bound">tx</a> <a id="2909" class="Symbol">.</a><a id="2910" href="UTxO.html#1188" class="Field">outputs</a><a id="2917" class="Symbol">)</a> <a id="2919" class="Symbol">(</a><a id="2920" href="UTxO.html#2707" class="Function">mkUtxo</a> <a id="2927" href="UTxO.html#2874" class="Bound">tx</a><a id="2929" class="Symbol">)</a>

<a id="totalValue"></a><a id="2932" href="UTxO.html#2932" class="Function">totalValue</a> <a id="2943" class="Symbol">:</a> <a id="2945" href="UTxO.html#2669" class="Function">UTxO</a> <a id="2950" class="Symbol">→</a> <a id="2952" href="UTxO.html#41" class="Function">Value</a>
<a id="2958" href="UTxO.html#2932" class="Function">totalValue</a> <a id="2969" class="Symbol">=</a> <a id="2971" href="Prelude.Lists.Sums.html#295" class="Function">∑ℕ</a> <a id="2974" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2976" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2980" href="UTxO.html#319" class="Field">value</a> <a id="2986" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2988" href="Prelude.html#1216" class="Function">values</a>

<a id="applyTx"></a><a id="2996" href="UTxO.html#2996" class="Function">applyTx</a> <a id="3004" class="Symbol">:</a> <a id="3006" href="UTxO.html#1129" class="Record">Tx</a> <a id="3009" class="Symbol">→</a> <a id="3011" class="Symbol">(</a><a id="3012" href="UTxO.html#2669" class="Function">UTxO</a> <a id="3017" class="Symbol">→</a> <a id="3019" href="UTxO.html#2669" class="Function">UTxO</a><a id="3023" class="Symbol">)</a>
<a id="3025" href="UTxO.html#2996" class="Function">applyTx</a> <a id="3033" href="UTxO.html#3033" class="Bound">tx</a> <a id="3036" href="UTxO.html#3036" class="Bound">utxo</a> <a id="3041" class="Symbol">=</a> <a id="3043" class="Symbol">(</a><a id="3044" href="UTxO.html#3036" class="Bound">utxo</a> <a id="3049" href="Prelude.html#1076" class="Function Operator">─ᵏˢ</a> <a id="3053" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="3064" href="UTxO.html#3033" class="Bound">tx</a><a id="3066" class="Symbol">)</a> <a id="3068" href="Prelude.Maps.AsSets.html#1469" class="Function Operator">∪</a> <a id="3070" href="UTxO.html#2848" class="Function">utxoTx</a> <a id="3077" href="UTxO.html#3033" class="Bound">tx</a>

<a id="utxo"></a><a id="3081" href="UTxO.html#3081" class="Function">utxo</a> <a id="3086" class="Symbol">:</a> <a id="3088" href="UTxO.html#1299" class="Function">L</a> <a id="3090" class="Symbol">→</a> <a id="3092" href="UTxO.html#2669" class="Function">UTxO</a>
<a id="3097" href="UTxO.html#3081" class="Function">utxo</a> <a id="3102" class="Symbol">=</a> <a id="3104" class="Symbol">λ</a> <a id="3106" class="Keyword">where</a>
  <a id="3114" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="3117" class="Symbol">→</a> <a id="3119" href="Prelude.Maps.AsSets.html#930" class="InductiveConstructor">∅</a>
  <a id="3123" class="Symbol">(</a><a id="3124" href="UTxO.html#3124" class="Bound">tx</a> <a id="3127" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3129" href="UTxO.html#3129" class="Bound">l</a><a id="3130" class="Symbol">)</a> <a id="3132" class="Symbol">→</a> <a id="3134" href="UTxO.html#2996" class="Function">applyTx</a> <a id="3142" href="UTxO.html#3124" class="Bound">tx</a> <a id="3145" class="Symbol">(</a><a id="3146" href="UTxO.html#3081" class="Function">utxo</a> <a id="3151" href="UTxO.html#3129" class="Bound">l</a><a id="3152" class="Symbol">)</a>

<a id="3155" class="Keyword">record</a> <a id="IsValidTx"></a><a id="3162" href="UTxO.html#3162" class="Record">IsValidTx</a> <a id="3172" class="Symbol">(</a><a id="3173" href="UTxO.html#3173" class="Bound">tx</a> <a id="3176" class="Symbol">:</a> <a id="3178" href="UTxO.html#1129" class="Record">Tx</a><a id="3180" class="Symbol">)</a> <a id="3182" class="Symbol">(</a><a id="3183" href="UTxO.html#3183" class="Bound">utxos</a> <a id="3189" class="Symbol">:</a> <a id="3191" href="UTxO.html#2669" class="Function">UTxO</a><a id="3195" class="Symbol">)</a> <a id="3197" class="Symbol">:</a> <a id="3199" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="3204" class="Keyword">where</a>
  <a id="3212" class="Keyword">field</a>
    <a id="IsValidTx.noDoubleSpending"></a><a id="3222" href="UTxO.html#3222" class="Field">noDoubleSpending</a> <a id="3239" class="Symbol">:</a>
      <a id="3247" href="Prelude.Irrelevance.List.Unique.html#1002" class="Function">·Unique</a> <a id="3255" class="Symbol">(</a><a id="3256" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="3267" href="UTxO.html#3173" class="Bound">tx</a><a id="3269" class="Symbol">)</a>

    <a id="IsValidTx.validOutputRefs"></a><a id="3276" href="UTxO.html#3276" class="Field">validOutputRefs</a> <a id="3292" class="Symbol">:</a>
      <a id="3300" href="UTxO.html#2219" class="Function">∀[</a> <a id="3303" href="UTxO.html#3303" class="Bound">ref</a> <a id="3307" href="UTxO.html#2219" class="Function">∈</a> <a id="3309" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="3320" href="UTxO.html#3173" class="Bound">tx</a> <a id="3323" href="UTxO.html#2219" class="Function">]</a>
        <a id="3333" class="Symbol">(</a><a id="3334" href="UTxO.html#3303" class="Bound">ref</a> <a id="3338" href="Prelude.Maps.AsSets.html#1627" class="Function Operator">∈ᵈ</a> <a id="3341" href="UTxO.html#3183" class="Bound">utxos</a><a id="3346" class="Symbol">)</a>

  <a id="IsValidTx.resolved"></a><a id="3351" href="UTxO.html#3351" class="Function">resolved</a> <a id="3360" class="Symbol">:</a> <a id="3362" href="UTxO.html#1535" class="Function">Resolved</a> <a id="3371" href="UTxO.html#3173" class="Bound">tx</a>
  <a id="3376" href="UTxO.html#3351" class="Function">resolved</a> <a id="3385" class="Symbol">=</a> <a id="3387" class="Symbol">(</a><a id="3388" href="UTxO.html#3183" class="Bound">utxos</a> <a id="3394" href="Prelude.html#980" class="Function Operator">‼_</a><a id="3396" class="Symbol">)</a> <a id="3398" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3400" href="Data.List.Relation.Unary.All.html#5775" class="Function">L.All.lookup</a> <a id="3413" href="UTxO.html#3276" class="Field">validOutputRefs</a>

  <a id="IsValidTx.txInfo"></a><a id="3432" href="UTxO.html#3432" class="Function">txInfo</a> <a id="3439" class="Symbol">=</a> <a id="3441" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="3450" href="UTxO.html#3173" class="Bound">tx</a> <a id="3453" href="UTxO.html#3351" class="Function">resolved</a>
  <a id="IsValidTx.resolvedInputs"></a><a id="3464" href="UTxO.html#3464" class="Function">resolvedInputs</a> <a id="3479" class="Symbol">=</a> <a id="3481" href="UTxO.html#1688" class="Function">resolveInputs</a> <a id="3495" href="UTxO.html#3173" class="Bound">tx</a> <a id="3498" href="UTxO.html#3351" class="Function">resolved</a>

  <a id="3510" class="Keyword">field</a>
    <a id="IsValidTx.preservesValues"></a><a id="3520" href="UTxO.html#3520" class="Field">preservesValues</a> <a id="3536" class="Symbol">:</a>
      <a id="3544" href="UTxO.html#3173" class="Bound">tx</a> <a id="3547" class="Symbol">.</a><a id="3548" href="UTxO.html#1222" class="Field">forge</a> <a id="3554" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3556" href="UTxO.html#191" class="Function">∑</a> <a id="3558" href="UTxO.html#3464" class="Function">resolvedInputs</a> <a id="3573" class="Symbol">(</a><a id="3574" href="UTxO.html#319" class="Field">value</a> <a id="3580" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3582" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="3587" class="Symbol">)</a> <a id="3589" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3591" href="UTxO.html#191" class="Function">∑</a> <a id="3593" class="Symbol">(</a><a id="3594" href="UTxO.html#3173" class="Bound">tx</a> <a id="3597" class="Symbol">.</a><a id="3598" href="UTxO.html#1188" class="Field">outputs</a><a id="3605" class="Symbol">)</a> <a id="3607" href="UTxO.html#319" class="Field">value</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="3618" href="UTxO.html#3618" class="Field">allInputsValidate</a> <a id="3636" class="Symbol">:</a>
      <a id="3644" href="UTxO.html#2219" class="Function">∀[</a> <a id="3647" href="UTxO.html#3647" class="Bound">i</a> <a id="3649" href="UTxO.html#2219" class="Function">∈</a> <a id="3651" href="UTxO.html#3173" class="Bound">tx</a> <a id="3654" class="Symbol">.</a><a id="3655" href="UTxO.html#1155" class="Field">inputs</a> <a id="3662" href="UTxO.html#2219" class="Function">]</a>
        <a id="3672" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="3674" class="Symbol">(</a><a id="3675" href="UTxO.html#3647" class="Bound">i</a> <a id="3677" class="Symbol">.</a><a id="3678" href="UTxO.html#1037" class="Field">validator</a> <a id="3688" href="UTxO.html#3432" class="Function">txInfo</a> <a id="3695" class="Symbol">(</a><a id="3696" href="UTxO.html#3647" class="Bound">i</a> <a id="3698" class="Symbol">.</a><a id="3699" href="UTxO.html#1080" class="Field">redeemer</a><a id="3707" class="Symbol">))</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="3715" href="UTxO.html#3715" class="Field">validateValidHashes</a> <a id="3735" class="Symbol">:</a>
      <a id="3743" href="UTxO.html#2219" class="Function">∀[</a> <a id="3746" href="UTxO.html#3746" class="Bound">(</a><a id="3747" href="UTxO.html#3747" class="Bound">i</a> <a id="3749" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3751" href="UTxO.html#3751" class="Bound">o</a><a id="3752" href="UTxO.html#3746" class="Bound">)</a> <a id="3754" href="UTxO.html#2219" class="Function">∈</a> <a id="3756" href="UTxO.html#3464" class="Function">resolvedInputs</a> <a id="3771" href="UTxO.html#2219" class="Function">]</a>
        <a id="3781" class="Symbol">(</a><a id="3782" href="UTxO.html#3751" class="Bound">o</a> <a id="3784" class="Symbol">.</a><a id="3785" href="UTxO.html#344" class="Field">address</a> <a id="3793" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3795" href="UTxO.html#3747" class="Bound">i</a> <a id="3797" class="Symbol">.</a><a id="3798" href="UTxO.html#1037" class="Field">validator</a> <a id="3808" href="UTxO.html#104" class="Postulate Operator">♯</a><a id="3809" class="Symbol">)</a>

  <a id="3814" class="Keyword">postulate</a>
    <a id="IsValidTx.nextValue≡"></a><a id="3828" href="UTxO.html#3828" class="Postulate">nextValue≡</a> <a id="3839" class="Symbol">:</a>
      <a id="3847" href="UTxO.html#2932" class="Function">totalValue</a> <a id="3858" class="Symbol">((</a><a id="3860" href="UTxO.html#3183" class="Bound">utxos</a> <a id="3866" href="Prelude.html#1076" class="Function Operator">─ᵏˢ</a> <a id="3870" href="UTxO.html#1459" class="Function">outputRefs</a> <a id="3881" href="UTxO.html#3173" class="Bound">tx</a><a id="3883" class="Symbol">)</a> <a id="3885" href="Prelude.Maps.AsSets.html#1469" class="Function Operator">∪</a> <a id="3887" href="UTxO.html#2848" class="Function">utxoTx</a> <a id="3894" href="UTxO.html#3173" class="Bound">tx</a><a id="3896" class="Symbol">)</a>
      <a id="3904" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3906" class="Symbol">(</a><a id="3907" href="UTxO.html#2932" class="Function">totalValue</a> <a id="3918" href="UTxO.html#3183" class="Bound">utxos</a> <a id="3924" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3926" href="UTxO.html#191" class="Function">∑</a> <a id="3928" class="Symbol">(</a><a id="3929" href="UTxO.html#3173" class="Bound">tx</a> <a id="3932" class="Symbol">.</a><a id="3933" href="UTxO.html#1188" class="Field">outputs</a><a id="3940" class="Symbol">)</a> <a id="3942" href="UTxO.html#319" class="Field">value</a><a id="3947" class="Symbol">)</a> <a id="3949" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="3951" href="UTxO.html#191" class="Function">∑</a> <a id="3953" href="UTxO.html#3464" class="Function">resolvedInputs</a> <a id="3968" class="Symbol">(</a><a id="3969" href="UTxO.html#319" class="Field">value</a> <a id="3975" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3977" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="3982" class="Symbol">)</a>

<a id="3985" class="Keyword">open</a> <a id="3990" href="UTxO.html#3162" class="Module">IsValidTx</a> <a id="4000" class="Keyword">public</a>

<a id="4008" class="Keyword">instance</a>
  <a id="·Valid"></a><a id="4019" href="UTxO.html#4019" class="Function">·Valid</a> <a id="4026" class="Symbol">:</a> <a id="4028" class="Symbol">∀</a> <a id="4030" class="Symbol">{</a><a id="4031" href="UTxO.html#4031" class="Bound">tx</a> <a id="4034" href="UTxO.html#4034" class="Bound">s</a><a id="4035" class="Symbol">}</a> <a id="4037" class="Symbol">→</a> <a id="4039" href="Prelude.Irrelevance.Core.html#215" class="Record Operator">·</a> <a id="4041" href="UTxO.html#3162" class="Record">IsValidTx</a> <a id="4051" href="UTxO.html#4031" class="Bound">tx</a> <a id="4054" href="UTxO.html#4034" class="Bound">s</a>
  <a id="4058" href="UTxO.html#4019" class="Function">·Valid</a> <a id="4065" class="Symbol">{</a><a id="4066" class="Argument">s</a> <a id="4068" class="Symbol">=</a> <a id="4070" class="Symbol">_</a> <a id="4072" href="Prelude.Maps.AsSets.html#581" class="InductiveConstructor Operator">⊣</a> <a id="4074" href="UTxO.html#4074" class="Bound">·uniq</a><a id="4079" class="Symbol">}</a> <a id="4081" class="Symbol">.</a><a id="4082" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a>
    <a id="4089" class="Symbol">(</a><a id="4090" class="Keyword">record</a> <a id="4097" class="Symbol">{</a> <a id="4099" href="UTxO.html#3222" class="Field">noDoubleSpending</a> <a id="4116" class="Symbol">=</a> <a id="4118" href="UTxO.html#4118" class="Bound">ndp</a>
            <a id="4134" class="Symbol">;</a> <a id="4136" href="UTxO.html#3276" class="Field">validOutputRefs</a> <a id="4152" class="Symbol">=</a> <a id="4154" href="UTxO.html#4154" class="Bound">vor</a>
            <a id="4170" class="Symbol">;</a> <a id="4172" href="UTxO.html#3520" class="Field">preservesValues</a> <a id="4188" class="Symbol">=</a> <a id="4190" href="UTxO.html#4190" class="Bound">pv</a>
            <a id="4205" class="Symbol">;</a> <a id="4207" href="UTxO.html#3618" class="Field">allInputsValidate</a> <a id="4225" class="Symbol">=</a> <a id="4227" href="UTxO.html#4227" class="Bound">aiv</a>
            <a id="4243" class="Symbol">;</a> <a id="4245" href="UTxO.html#3715" class="Field">validateValidHashes</a> <a id="4265" class="Symbol">=</a> <a id="4267" href="UTxO.html#4267" class="Bound">vvh</a>
            <a id="4283" class="Symbol">})</a>
    <a id="4290" class="Symbol">(</a><a id="4291" class="Keyword">record</a> <a id="4298" class="Symbol">{</a> <a id="4300" href="UTxO.html#3222" class="Field">noDoubleSpending</a> <a id="4317" class="Symbol">=</a> <a id="4319" href="UTxO.html#4319" class="Bound">ndp′</a>
            <a id="4336" class="Symbol">;</a> <a id="4338" href="UTxO.html#3276" class="Field">validOutputRefs</a> <a id="4354" class="Symbol">=</a> <a id="4356" href="UTxO.html#4356" class="Bound">vor′</a>
            <a id="4373" class="Symbol">;</a> <a id="4375" href="UTxO.html#3520" class="Field">preservesValues</a> <a id="4391" class="Symbol">=</a> <a id="4393" href="UTxO.html#4393" class="Bound">pv′</a>
            <a id="4409" class="Symbol">;</a> <a id="4411" href="UTxO.html#3618" class="Field">allInputsValidate</a> <a id="4429" class="Symbol">=</a> <a id="4431" href="UTxO.html#4431" class="Bound">aiv′</a>
            <a id="4448" class="Symbol">;</a> <a id="4450" href="UTxO.html#3715" class="Field">validateValidHashes</a> <a id="4470" class="Symbol">=</a> <a id="4472" href="UTxO.html#4472" class="Bound">vvh′</a>
            <a id="4489" class="Symbol">})</a>
    <a id="4496" class="Keyword">with</a> <a id="4501" href="UTxO.html#4501" class="Bound">uniq</a> ← <a id="4508" href="Relation.Nullary.html#1847" class="Function">recompute</a> <a id="4518" href="Prelude.Decidable.Core.html#166" class="Field">dec</a> <a id="4522" href="UTxO.html#4074" class="Bound">·uniq</a>
    <a id="4532" class="Keyword">rewrite</a> <a id="4540" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="4543" href="UTxO.html#4118" class="Bound">ndp</a> <a id="4547" href="UTxO.html#4319" class="Bound">ndp′</a>
          <a id="4562" class="Symbol">|</a> <a id="4564" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="4581" class="Symbol">(</a><a id="4582" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="4588" href="UTxO.html#4501" class="Bound">uniq</a><a id="4592" class="Symbol">)</a> <a id="4594" href="UTxO.html#4154" class="Bound">vor</a> <a id="4598" href="UTxO.html#4356" class="Bound">vor′</a>
          <a id="4613" class="Symbol">|</a> <a id="4615" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="4618" href="UTxO.html#4190" class="Bound">pv</a> <a id="4621" href="UTxO.html#4393" class="Bound">pv′</a>
          <a id="4635" class="Symbol">|</a> <a id="4637" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="4654" href="Data.Bool.Properties.html#15414" class="Function">B.T-irrelevant</a> <a id="4669" href="UTxO.html#4227" class="Bound">aiv</a> <a id="4673" href="UTxO.html#4431" class="Bound">aiv′</a>
          <a id="4688" class="Symbol">|</a> <a id="4690" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="4693" href="UTxO.html#4267" class="Bound">vvh</a> <a id="4697" href="UTxO.html#4472" class="Bound">vvh′</a>
          <a id="4712" class="Symbol">=</a> <a id="4714" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="isValidTx?"></a><a id="4720" href="UTxO.html#4720" class="Function">isValidTx?</a> <a id="4731" class="Symbol">:</a> <a id="4733" class="Symbol">∀</a> <a id="4735" href="UTxO.html#4735" class="Bound">tx</a> <a id="4738" href="UTxO.html#4738" class="Bound">s</a> <a id="4740" class="Symbol">→</a> <a id="4742" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="4746" class="Symbol">(</a><a id="4747" href="UTxO.html#3162" class="Record">IsValidTx</a> <a id="4757" href="UTxO.html#4735" class="Bound">tx</a> <a id="4760" href="UTxO.html#4738" class="Bound">s</a><a id="4761" class="Symbol">)</a>
<a id="4763" href="UTxO.html#4720" class="Function">isValidTx?</a> <a id="4774" href="UTxO.html#4774" class="Bound">tx</a> <a id="4777" href="UTxO.html#4777" class="Bound">s</a><a id="4778" class="Symbol">@(_</a> <a id="4782" href="Prelude.Maps.AsSets.html#581" class="InductiveConstructor Operator">⊣</a> <a id="4784" href="UTxO.html#4784" class="Bound">·uniq</a><a id="4789" class="Symbol">)</a>
  <a id="4793" class="Keyword">with</a> <a id="4798" href="UTxO.html#4798" class="Bound">uniq</a> ← <a id="4805" href="Relation.Nullary.html#1847" class="Function">recompute</a> <a id="4815" href="Prelude.Decidable.Core.html#166" class="Field">dec</a> <a id="4819" href="UTxO.html#4784" class="Bound">·uniq</a>
  <a id="4827" class="Keyword">with</a> <a id="4832" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="4836" class="Symbol">...</a> <a id="4840" class="Symbol">|</a> <a id="4842" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4845" href="UTxO.html#4845" class="Bound">¬p</a> <a id="4848" class="Symbol">=</a> <a id="4850" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4853" class="Symbol">(</a><a id="4854" href="UTxO.html#4845" class="Bound">¬p</a> <a id="4857" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4859" href="UTxO.html#3222" class="Field">noDoubleSpending</a><a id="4875" class="Symbol">)</a>
<a id="4877" class="Symbol">...</a> <a id="4881" class="Symbol">|</a> <a id="4883" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4887" href="UTxO.html#4887" class="Bound">ndp</a> <a id="4891" class="Keyword">with</a> <a id="4896" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="4900" class="Symbol">...</a> <a id="4904" class="Symbol">|</a> <a id="4906" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4909" href="UTxO.html#4909" class="Bound">¬p</a> <a id="4912" class="Symbol">=</a> <a id="4914" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4917" class="Symbol">(</a><a id="4918" href="UTxO.html#4909" class="Bound">¬p</a> <a id="4921" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4923" href="UTxO.html#3276" class="Field">validOutputRefs</a><a id="4938" class="Symbol">)</a>
<a id="4940" class="Symbol">...</a> <a id="4944" class="Symbol">|</a> <a id="4946" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4950" href="UTxO.html#4950" class="Bound">vor</a> <a id="4954" class="Keyword">with</a> <a id="4959" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="4963" class="Symbol">...</a> <a id="4967" class="Symbol">|</a> <a id="4969" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4972" href="UTxO.html#4972" class="Bound">¬p</a> <a id="4975" class="Symbol">=</a> <a id="4977" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4980" href="UTxO.html#4995" class="Function">absurd</a>
  <a id="4989" class="Keyword">where</a> <a id="4995" href="UTxO.html#4995" class="Function">absurd</a> <a id="5002" class="Symbol">:</a> <a id="5004" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="5006" href="UTxO.html#3162" class="Record">IsValidTx</a> <a id="5016" class="Bound">tx</a> <a id="5019" class="Bound">s</a>
        <a id="5029" href="UTxO.html#4995" class="Function">absurd</a> <a id="5036" class="Symbol">(</a><a id="5037" class="Keyword">record</a> <a id="5044" class="Symbol">{</a><a id="5045" href="UTxO.html#3276" class="Field">validOutputRefs</a> <a id="5061" class="Symbol">=</a> <a id="5063" href="UTxO.html#5063" class="Bound">vor′</a><a id="5067" class="Symbol">;</a> <a id="5069" href="UTxO.html#3520" class="Field">preservesValues</a> <a id="5085" class="Symbol">=</a> <a id="5087" href="UTxO.html#5087" class="Bound">p</a><a id="5088" class="Symbol">})</a>
          <a id="5101" class="Keyword">rewrite</a> <a id="5109" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="5133" href="UTxO.html#4798" class="Bound">uniq</a><a id="5137" class="Symbol">)</a> <a id="5139" class="Bound">vor</a> <a id="5143" href="UTxO.html#5063" class="Bound">vor′</a> <a id="5148" class="Symbol">=</a> <a id="5150" href="UTxO.html#4972" class="Bound">¬p</a> <a id="5153" href="UTxO.html#5087" class="Bound">p</a>
<a id="5155" class="Symbol">...</a> <a id="5159" class="Symbol">|</a> <a id="5161" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5165" href="UTxO.html#5165" class="Bound">pv</a> <a id="5168" class="Keyword">with</a> <a id="5173" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="5177" class="Symbol">...</a> <a id="5181" class="Symbol">|</a> <a id="5183" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5186" href="UTxO.html#5186" class="Bound">¬p</a> <a id="5189" class="Symbol">=</a> <a id="5191" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5194" href="UTxO.html#5209" class="Function">absurd</a>
  <a id="5203" class="Keyword">where</a> <a id="5209" href="UTxO.html#5209" class="Function">absurd</a> <a id="5216" class="Symbol">:</a> <a id="5218" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="5220" href="UTxO.html#3162" class="Record">IsValidTx</a> <a id="5230" class="Bound">tx</a> <a id="5233" class="Bound">s</a>
        <a id="5243" href="UTxO.html#5209" class="Function">absurd</a> <a id="5250" class="Symbol">(</a><a id="5251" class="Keyword">record</a> <a id="5258" class="Symbol">{</a><a id="5259" href="UTxO.html#3276" class="Field">validOutputRefs</a> <a id="5275" class="Symbol">=</a> <a id="5277" href="UTxO.html#5277" class="Bound">vor′</a><a id="5281" class="Symbol">;</a> <a id="5283" href="UTxO.html#3618" class="Field">allInputsValidate</a> <a id="5301" class="Symbol">=</a> <a id="5303" href="UTxO.html#5303" class="Bound">p</a><a id="5304" class="Symbol">})</a>
          <a id="5317" class="Keyword">rewrite</a> <a id="5325" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="5342" class="Symbol">(</a><a id="5343" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="5349" href="UTxO.html#4798" class="Bound">uniq</a><a id="5353" class="Symbol">)</a> <a id="5355" class="Bound">vor</a> <a id="5359" href="UTxO.html#5277" class="Bound">vor′</a> <a id="5364" class="Symbol">=</a> <a id="5366" href="UTxO.html#5186" class="Bound">¬p</a> <a id="5369" href="UTxO.html#5303" class="Bound">p</a>
<a id="5371" class="Symbol">...</a> <a id="5375" class="Symbol">|</a> <a id="5377" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5381" href="UTxO.html#5381" class="Bound">aiv</a> <a id="5385" class="Keyword">with</a> <a id="5390" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="5394" class="Symbol">...</a> <a id="5398" class="Symbol">|</a> <a id="5400" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5403" href="UTxO.html#5403" class="Bound">¬p</a> <a id="5406" class="Symbol">=</a> <a id="5408" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5411" href="UTxO.html#5426" class="Function">absurd</a>
  <a id="5420" class="Keyword">where</a> <a id="5426" href="UTxO.html#5426" class="Function">absurd</a> <a id="5433" class="Symbol">:</a> <a id="5435" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="5437" href="UTxO.html#3162" class="Record">IsValidTx</a> <a id="5447" class="Bound">tx</a> <a id="5450" class="Bound">s</a>
        <a id="5460" href="UTxO.html#5426" class="Function">absurd</a> <a id="5467" class="Symbol">(</a><a id="5468" class="Keyword">record</a> <a id="5475" class="Symbol">{</a><a id="5476" href="UTxO.html#3276" class="Field">validOutputRefs</a> <a id="5492" class="Symbol">=</a> <a id="5494" href="UTxO.html#5494" class="Bound">vor′</a><a id="5498" class="Symbol">;</a> <a id="5500" href="UTxO.html#3715" class="Field">validateValidHashes</a> <a id="5520" class="Symbol">=</a> <a id="5522" href="UTxO.html#5522" class="Bound">p</a><a id="5523" class="Symbol">})</a>
          <a id="5536" class="Keyword">rewrite</a> <a id="5544" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="5561" class="Symbol">(</a><a id="5562" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="5568" href="UTxO.html#4798" class="Bound">uniq</a><a id="5572" class="Symbol">)</a> <a id="5574" class="Bound">vor</a> <a id="5578" href="UTxO.html#5494" class="Bound">vor′</a> <a id="5583" class="Symbol">=</a> <a id="5585" href="UTxO.html#5403" class="Bound">¬p</a> <a id="5588" href="UTxO.html#5522" class="Bound">p</a>
<a id="5590" class="Symbol">...</a> <a id="5594" class="Symbol">|</a> <a id="5596" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5600" href="UTxO.html#5600" class="Bound">vvh</a> <a id="5604" class="Symbol">=</a> <a id="5606" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5610" class="Keyword">record</a>
  <a id="5619" class="Symbol">{</a> <a id="5621" href="UTxO.html#3222" class="Field">noDoubleSpending</a> <a id="5638" class="Symbol">=</a> <a id="5640" class="Bound">ndp</a>
  <a id="5646" class="Symbol">;</a> <a id="5648" href="UTxO.html#3276" class="Field">validOutputRefs</a> <a id="5664" class="Symbol">=</a> <a id="5666" class="Bound">vor</a>
  <a id="5672" class="Symbol">;</a> <a id="5674" href="UTxO.html#3520" class="Field">preservesValues</a> <a id="5690" class="Symbol">=</a> <a id="5692" class="Bound">pv</a>
  <a id="5697" class="Symbol">;</a> <a id="5699" href="UTxO.html#3618" class="Field">allInputsValidate</a> <a id="5717" class="Symbol">=</a> <a id="5719" class="Bound">aiv</a>
  <a id="5725" class="Symbol">;</a> <a id="5727" href="UTxO.html#3715" class="Field">validateValidHashes</a> <a id="5747" class="Symbol">=</a> <a id="5749" href="UTxO.html#5600" class="Bound">vvh</a> <a id="5753" class="Symbol">}</a>

<a id="isValidTx"></a><a id="5756" href="UTxO.html#5756" class="Function">isValidTx</a> <a id="5766" class="Symbol">:</a> <a id="5768" href="UTxO.html#1129" class="Record">Tx</a> <a id="5771" class="Symbol">→</a> <a id="5773" href="UTxO.html#2669" class="Function">UTxO</a> <a id="5778" class="Symbol">→</a> <a id="5780" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="5785" href="UTxO.html#5756" class="Function">isValidTx</a> <a id="5795" href="UTxO.html#5795" class="Bound">tx</a> <a id="5798" href="UTxO.html#5798" class="Bound">s</a> <a id="5800" class="Symbol">=</a> <a id="5802" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="5804" href="UTxO.html#4720" class="Function">isValidTx?</a> <a id="5815" href="UTxO.html#5795" class="Bound">tx</a> <a id="5818" href="UTxO.html#5798" class="Bound">s</a> <a id="5820" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a>

<a id="checkTx"></a><a id="5823" href="UTxO.html#5823" class="Function">checkTx</a> <a id="5831" class="Symbol">:</a> <a id="5833" href="UTxO.html#735" class="Record">TxInfo</a> <a id="5840" class="Symbol">→</a> <a id="5842" href="UTxO.html#2669" class="Function">UTxO</a> <a id="5847" class="Symbol">→</a> <a id="5849" href="UTxO.html#1129" class="Record">Tx</a> <a id="5852" class="Symbol">→</a> <a id="5854" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="5859" href="UTxO.html#5823" class="Function">checkTx</a> <a id="5867" href="UTxO.html#5867" class="Bound">txi</a> <a id="5871" href="UTxO.html#5871" class="Bound">s</a> <a id="5873" href="UTxO.html#5873" class="Bound">tx</a> <a id="5876" class="Keyword">with</a> <a id="5881" href="UTxO.html#4720" class="Function">isValidTx?</a> <a id="5892" href="UTxO.html#5873" class="Bound">tx</a> <a id="5895" href="UTxO.html#5871" class="Bound">s</a>
<a id="5897" class="Symbol">...</a> <a id="5901" class="Symbol">|</a> <a id="5903" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5906" class="Symbol">_</a>  <a id="5909" class="Symbol">=</a> <a id="5911" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
<a id="5917" class="Symbol">...</a> <a id="5921" class="Symbol">|</a> <a id="5923" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5927" href="UTxO.html#5927" class="Bound">valid</a> <a id="5933" class="Symbol">=</a> <a id="5935" class="Bound">txi</a> <a id="5939" href="Prelude.DecEq.Core.html#222" class="Function Operator">==</a> <a id="5942" href="UTxO.html#2022" class="Function">mkTxInfo</a> <a id="5951" class="Bound">tx</a> <a id="5954" class="Symbol">(</a><a id="5955" href="UTxO.html#3351" class="Function">resolved</a> <a id="5964" href="UTxO.html#5927" class="Bound">valid</a><a id="5969" class="Symbol">)</a>

<a id="mint"></a><a id="5972" href="UTxO.html#5972" class="Function">mint</a> <a id="5977" class="Symbol">:</a> <a id="5979" href="UTxO.html#735" class="Record">TxInfo</a> <a id="5986" class="Symbol">→</a> <a id="5988" href="UTxO.html#41" class="Function">Value</a>
<a id="5994" href="UTxO.html#5972" class="Function">mint</a> <a id="5999" class="Symbol">=</a> <a id="6001" href="UTxO.html#828" class="Field">TxInfo.forge</a>

<a id="6015" class="Keyword">variable</a>
  <a id="6026" href="UTxO.html#6026" class="Generalizable">tx</a> <a id="6029" class="Symbol">:</a> <a id="6031" href="UTxO.html#1129" class="Record">Tx</a>
  <a id="6036" href="UTxO.html#6036" class="Generalizable">l</a> <a id="6038" class="Symbol">:</a> <a id="6040" href="UTxO.html#1299" class="Function">L</a>
  <a id="6044" href="UTxO.html#6044" class="Generalizable">txi</a> <a id="6048" class="Symbol">:</a> <a id="6050" href="UTxO.html#735" class="Record">TxInfo</a>
  <a id="6059" href="UTxO.html#6059" class="Generalizable">utxos</a> <a id="6065" href="UTxO.html#6065" class="Generalizable">utxos′</a> <a id="6072" class="Symbol">:</a> <a id="6074" href="UTxO.html#2669" class="Function">UTxO</a>
  <a id="6081" href="UTxO.html#6081" class="Generalizable">v</a> <a id="6083" href="UTxO.html#6083" class="Generalizable">v′</a> <a id="6086" href="UTxO.html#6086" class="Generalizable">v″</a> <a id="6089" class="Symbol">:</a> <a id="6091" href="UTxO.html#41" class="Function">Value</a>

<a id="6098" class="Comment">-- ** LEDGER small-step relation</a>
<a id="6131" class="Keyword">data</a> <a id="_⊢_—⟨_∣LEDGER⟩→_"></a><a id="6136" href="UTxO.html#6136" class="Datatype Operator">_⊢_—⟨_∣LEDGER⟩→_</a> <a id="6153" class="Symbol">:</a> <a id="6155" href="Prelude.html#1305" class="Function">SSRel</a> <a id="6161" href="UTxO.html#735" class="Record">TxInfo</a> <a id="6168" href="UTxO.html#2669" class="Function">UTxO</a> <a id="6173" href="UTxO.html#1129" class="Record">Tx</a> <a id="6176" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣LEDGER⟩→_.ApplyTx"></a><a id="6185" href="UTxO.html#6185" class="InductiveConstructor">ApplyTx</a> <a id="6193" class="Symbol">:</a> <a id="6195" class="Keyword">let</a> <a id="6199" href="UTxO.html#6199" class="Bound">utxos′</a> <a id="6206" class="Symbol">=</a> <a id="6208" href="UTxO.html#2996" class="Function">applyTx</a> <a id="6216" href="UTxO.html#6026" class="Generalizable">tx</a> <a id="6219" href="UTxO.html#6059" class="Generalizable">utxos</a> <a id="6225" class="Keyword">in</a>
    <a id="6232" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="6234" class="Symbol">(</a><a id="6235" href="UTxO.html#5823" class="Function">checkTx</a> <a id="6243" href="UTxO.html#6044" class="Generalizable">txi</a> <a id="6247" href="UTxO.html#6059" class="Generalizable">utxos</a> <a id="6253" href="UTxO.html#6026" class="Generalizable">tx</a><a id="6255" class="Symbol">)</a>
    <a id="6261" href="Prelude.InferenceRules.html#13683" class="Function Operator">──────────────────────────────────</a>
    <a id="6300" href="UTxO.html#6044" class="Generalizable">txi</a> <a id="6304" href="UTxO.html#6136" class="Datatype Operator">⊢</a> <a id="6306" href="UTxO.html#6059" class="Generalizable">utxos</a> <a id="6312" href="UTxO.html#6136" class="Datatype Operator">—⟨</a> <a id="6315" href="UTxO.html#6026" class="Generalizable">tx</a> <a id="6318" href="UTxO.html#6136" class="Datatype Operator">∣LEDGER⟩→</a> <a id="6328" href="UTxO.html#6199" class="Bound">utxos′</a>

<a id="6336" class="Comment">-- ** TX-LEDGER small-step relation</a>
<a id="6372" class="Keyword">data</a> <a id="_⊢_—⟨_∣TX-LEDGER⟩→_"></a><a id="6377" href="UTxO.html#6377" class="Datatype Operator">_⊢_—⟨_∣TX-LEDGER⟩→_</a> <a id="6397" class="Symbol">:</a> <a id="6399" href="Prelude.html#1305" class="Function">SSRel</a> <a id="6405" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a> <a id="6407" href="UTxO.html#1299" class="Function">L</a> <a id="6409" href="UTxO.html#1129" class="Record">Tx</a> <a id="6412" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣TX-LEDGER⟩→_.ApplyTx"></a><a id="6421" href="UTxO.html#6421" class="InductiveConstructor">ApplyTx</a> <a id="6429" class="Symbol">:</a>
    <a id="6435" href="UTxO.html#3162" class="Record">IsValidTx</a> <a id="6445" href="UTxO.html#6026" class="Generalizable">tx</a> <a id="6448" class="Symbol">(</a><a id="6449" href="UTxO.html#3081" class="Function">utxo</a> <a id="6454" href="UTxO.html#6036" class="Generalizable">l</a><a id="6455" class="Symbol">)</a>
    <a id="6461" href="Prelude.InferenceRules.html#13722" class="Function Operator">─────────────────────────────────</a>
    <a id="6499" class="Symbol">_</a> <a id="6501" href="UTxO.html#6377" class="Datatype Operator">⊢</a> <a id="6503" href="UTxO.html#6036" class="Generalizable">l</a> <a id="6505" href="UTxO.html#6377" class="Datatype Operator">—⟨</a> <a id="6508" href="UTxO.html#6026" class="Generalizable">tx</a> <a id="6511" href="UTxO.html#6377" class="Datatype Operator">∣TX-LEDGER⟩→</a> <a id="6524" class="Symbol">(</a><a id="6525" href="UTxO.html#6026" class="Generalizable">tx</a> <a id="6528" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="6530" href="UTxO.html#6036" class="Generalizable">l</a><a id="6531" class="Symbol">)</a>

<a id="6534" class="Keyword">postulate</a>
  <a id="TX-LEDGER-reifies-LEDGER"></a><a id="6546" href="UTxO.html#6546" class="Postulate">TX-LEDGER-reifies-LEDGER</a> <a id="6571" class="Symbol">:</a> <a id="6573" href="UTxO.html#6377" class="Datatype Operator">_⊢_—⟨_∣TX-LEDGER⟩→_</a> <a id="6593" href="Prelude.html#1523" class="Record Operator">≼</a> <a id="6595" href="UTxO.html#6136" class="Datatype Operator">_⊢_—⟨_∣LEDGER⟩→_</a>
<a id="6612" class="Comment">-- TX-LEDGER-reifies-LEDGER = record</a>
<a id="6649" class="Comment">--   { πₑ = λ _ s tx → mkTxInfo tx {!resolved valid!} -- (resolved valid)</a>
<a id="6723" class="Comment">--   ; πₛ = π</a>
<a id="6737" class="Comment">--   ; πᵢ = id</a>
<a id="6752" class="Comment">--   ; implements = proof</a>
<a id="6778" class="Comment">--   }</a>
<a id="6785" class="Comment">--   where</a>
<a id="6796" class="Comment">--     π = utxo</a>

<a id="6813" class="Comment">--     getValid : ∀ {Γ l tx l′} → Γ ⊢ l —⟨ tx ∣TX-LEDGER⟩→ l′ → IsValidTx tx (utxo l)</a>
<a id="6899" class="Comment">--     getValid (ApplyTx val) = val</a>

<a id="6936" class="Comment">--     proof : ∀ Γ l tx l′ →</a>
<a id="6965" class="Comment">--       (l→ : Γ ⊢ l —⟨ tx ∣TX-LEDGER⟩→ l′) →</a>
<a id="7011" class="Comment">--       ──────────────────────────────────────</a>
<a id="7059" class="Comment">--       mkTxInfo tx {!resolved $ getValid l→ !} ⊢ utxo l —⟨ tx ∣LEDGER⟩→ utxo l′</a>
<a id="7141" class="Comment">--     proof _ l tx .(tx ∷ l) (ApplyTx val) = {!!}</a>
</pre></body></html>