<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StructuredContracts</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/structured-contracts/tree/master/'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="26" class="Keyword">hiding</a> <a id="33" class="Symbol">(</a><a id="34" href="Function.Base.html#615" class="Function">id</a><a id="36" class="Symbol">);</a> <a id="39" class="Keyword">open</a> <a id="44" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="89" class="Keyword">open</a> <a id="94" class="Keyword">import</a> <a id="101" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="Prelude.Maps.html" class="Module">Prelude.Maps</a>

<a id="229" class="Comment">-- small-step relations</a>
<a id="SSRel"></a><a id="253" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="259" class="Symbol">:</a> <a id="261" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="266" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="268" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="273" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="275" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="280" class="Symbol">→</a> <a id="282" href="Agda.Primitive.html#326" class="Primitive">Type₁</a>
<a id="288" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="294" class="Symbol">(</a><a id="295" href="StructuredContracts.html#295" class="Bound">Env</a> <a id="299" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="301" href="StructuredContracts.html#301" class="Bound">State</a> <a id="307" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="309" href="StructuredContracts.html#309" class="Bound">Input</a><a id="314" class="Symbol">)</a> <a id="316" class="Symbol">=</a> <a id="318" href="StructuredContracts.html#295" class="Bound">Env</a> <a id="322" class="Symbol">→</a> <a id="324" href="StructuredContracts.html#301" class="Bound">State</a> <a id="330" class="Symbol">→</a> <a id="332" href="StructuredContracts.html#309" class="Bound">Input</a> <a id="338" class="Symbol">→</a> <a id="340" href="StructuredContracts.html#301" class="Bound">State</a> <a id="346" class="Symbol">→</a> <a id="348" href="Agda.Primitive.html#326" class="Primitive">Type</a>

<a id="354" class="Comment">-- ** Ledger</a>

<a id="368" class="Keyword">postulate</a>
  <a id="LEnv"></a><a id="380" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="LState"></a><a id="385" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="Tx"></a><a id="392" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="395" class="Symbol">:</a> <a id="397" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="_⊢_—⟨_∣UTXOW⟩→_"></a><a id="404" href="StructuredContracts.html#404" class="Postulate Operator">_⊢_—⟨_∣UTXOW⟩→_</a> <a id="420" class="Symbol">:</a> <a id="422" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="428" class="Symbol">(</a><a id="429" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="434" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="436" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="443" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="445" href="StructuredContracts.html#392" class="Postulate">Tx</a><a id="447" class="Symbol">)</a>

<a id="450" class="Keyword">variable</a>
  <a id="461" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="465" class="Symbol">:</a> <a id="467" href="StructuredContracts.html#380" class="Postulate">LEnv</a>
  <a id="474" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="481" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a> <a id="489" class="Symbol">:</a> <a id="491" href="StructuredContracts.html#385" class="Postulate">LState</a>
  <a id="500" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="503" class="Symbol">:</a> <a id="505" href="StructuredContracts.html#392" class="Postulate">Tx</a>

<a id="509" class="Keyword">data</a> <a id="_⊢_—⟨_∣LEDGER⟩→_"></a><a id="514" href="StructuredContracts.html#514" class="Datatype Operator">_⊢_—⟨_∣LEDGER⟩→_</a> <a id="531" class="Symbol">:</a> <a id="533" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="539" class="Symbol">(</a><a id="540" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="545" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="547" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="554" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="556" href="StructuredContracts.html#392" class="Postulate">Tx</a><a id="558" class="Symbol">)</a> <a id="560" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣LEDGER⟩→_.ledger-V"></a><a id="569" href="StructuredContracts.html#569" class="InductiveConstructor">ledger-V</a> <a id="578" class="Symbol">:</a>
    <a id="584" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="588" href="StructuredContracts.html#404" class="Postulate Operator">⊢</a> <a id="590" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="597" href="StructuredContracts.html#404" class="Postulate Operator">—⟨</a> <a id="600" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="603" href="StructuredContracts.html#404" class="Postulate Operator">∣UTXOW⟩→</a> <a id="612" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
    <a id="624" href="Prelude.InferenceRules.html#13579" class="Function Operator">────────────────────────────────────</a>
    <a id="665" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="669" href="StructuredContracts.html#514" class="Datatype Operator">⊢</a> <a id="671" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="678" href="StructuredContracts.html#514" class="Datatype Operator">—⟨</a> <a id="681" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="684" href="StructuredContracts.html#514" class="Datatype Operator">∣LEDGER⟩→</a> <a id="694" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>

<a id="703" class="Comment">-- ** Simulation</a>

<a id="721" class="Keyword">postulate</a>
  <a id="TxInfo"></a><a id="733" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="740" class="Symbol">:</a> <a id="742" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="getUTxO"></a><a id="749" href="StructuredContracts.html#749" class="Postulate">getUTxO</a> <a id="757" class="Symbol">:</a> <a id="759" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="766" class="Symbol">→</a> <a id="768" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="771" class="Symbol">→</a> <a id="773" href="StructuredContracts.html#733" class="Postulate">TxInfo</a>
  <a id="isValid"></a><a id="782" href="StructuredContracts.html#782" class="Postulate">isValid</a> <a id="790" class="Symbol">:</a> <a id="792" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="795" class="Symbol">→</a> <a id="797" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>

<a id="803" class="Keyword">variable</a>
  <a id="814" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="821" class="Symbol">:</a> <a id="823" href="StructuredContracts.html#733" class="Postulate">TxInfo</a>

<a id="831" class="Keyword">module</a> <a id="Simulation"></a><a id="838" href="StructuredContracts.html#838" class="Module">Simulation</a>
  <a id="851" class="Symbol">{</a><a id="852" href="StructuredContracts.html#852" class="Bound">State</a> <a id="858" href="StructuredContracts.html#858" class="Bound">Input</a> <a id="864" class="Symbol">:</a> <a id="866" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="870" class="Symbol">}</a>
  <a id="874" class="Symbol">⦃</a> <a id="876" href="StructuredContracts.html#876" class="Bound">_</a> <a id="878" class="Symbol">:</a> <a id="880" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="887" href="StructuredContracts.html#858" class="Bound">Input</a> <a id="893" class="Symbol">⦄</a>
  <a id="897" class="Symbol">(</a><a id="898" href="StructuredContracts.html#898" class="Bound">πˢ</a> <a id="901" class="Symbol">:</a> <a id="903" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="910" class="Symbol">→</a> <a id="912" href="StructuredContracts.html#852" class="Bound">State</a><a id="917" class="Symbol">)</a>
  <a id="921" class="Symbol">(</a><a id="922" href="StructuredContracts.html#922" class="Bound">πⁱ</a> <a id="925" class="Symbol">:</a> <a id="927" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="934" class="Symbol">→</a> <a id="936" href="StructuredContracts.html#858" class="Bound">Input</a><a id="941" class="Symbol">)</a>
  <a id="945" class="Symbol">(</a><a id="946" href="StructuredContracts.html#946" class="Bound Operator">_⊢_—⟨_∣SMUP⟩→_</a> <a id="961" class="Symbol">:</a> <a id="963" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="969" class="Symbol">(</a><a id="970" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="977" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="979" href="StructuredContracts.html#852" class="Bound">State</a> <a id="985" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="987" href="StructuredContracts.html#858" class="Bound">Input</a><a id="992" class="Symbol">))</a>
  <a id="997" class="Keyword">where</a>

  <a id="1006" class="Keyword">data</a> <a id="Simulation.StatefulStep"></a><a id="1011" href="StructuredContracts.html#1011" class="Datatype">StatefulStep</a> <a id="1024" class="Symbol">:</a> <a id="1026" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1031" class="Keyword">where</a>
    <a id="Simulation.StatefulStep.STEP"></a><a id="1041" href="StructuredContracts.html#1041" class="InductiveConstructor">STEP</a> <a id="1046" class="Symbol">:</a>
      <a id="1054" class="Symbol">(</a><a id="1055" class="Keyword">let</a> <a id="1059" href="StructuredContracts.html#1059" class="Bound">txInfo</a> <a id="1066" class="Symbol">=</a> <a id="1068" href="StructuredContracts.html#749" class="Postulate">getUTxO</a> <a id="1076" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1083" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1086" class="Keyword">in</a>
      <a id="1095" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="1097" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="1099" class="Symbol">(</a><a id="1100" href="StructuredContracts.html#782" class="Postulate">isValid</a> <a id="1108" href="StructuredContracts.html#500" class="Generalizable">tx</a><a id="1110" class="Symbol">)</a>
      <a id="1118" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1120" href="StructuredContracts.html#922" class="Bound">πⁱ</a> <a id="1123" href="StructuredContracts.html#1059" class="Bound">txInfo</a> <a id="1130" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="1132" href="Prelude.Monoid.html#196" class="Field">ε</a>
      <a id="1140" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1142" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="1146" href="StructuredContracts.html#514" class="Datatype Operator">⊢</a> <a id="1148" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1155" href="StructuredContracts.html#514" class="Datatype Operator">—⟨</a> <a id="1158" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1161" href="StructuredContracts.html#514" class="Datatype Operator">∣LEDGER⟩→</a> <a id="1171" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
        <a id="1187" href="Prelude.InferenceRules.html#12844" class="Function Operator">───────────────────────────────────────────────────</a>
        <a id="1247" href="StructuredContracts.html#1059" class="Bound">txInfo</a> <a id="1254" href="StructuredContracts.html#946" class="Bound Operator">⊢</a> <a id="1256" href="StructuredContracts.html#898" class="Bound">πˢ</a> <a id="1259" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1266" href="StructuredContracts.html#946" class="Bound Operator">—⟨</a> <a id="1269" href="StructuredContracts.html#922" class="Bound">πⁱ</a> <a id="1272" href="StructuredContracts.html#1059" class="Bound">txInfo</a> <a id="1279" href="StructuredContracts.html#946" class="Bound Operator">∣SMUP⟩→</a> <a id="1287" href="StructuredContracts.html#898" class="Bound">πˢ</a> <a id="1290" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a><a id="1297" class="Symbol">)</a>
      <a id="1305" href="Prelude.InferenceRules.html#14287" class="Function Operator">────────────</a>
      <a id="1324" href="StructuredContracts.html#1011" class="Datatype">StatefulStep</a>

  <a id="1340" class="Keyword">data</a> <a id="Simulation.StatefulNoStep"></a><a id="1345" href="StructuredContracts.html#1345" class="Datatype">StatefulNoStep</a> <a id="1360" class="Symbol">:</a> <a id="1362" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1367" class="Keyword">where</a>
    <a id="Simulation.StatefulNoStep.NO-STEP"></a><a id="1377" href="StructuredContracts.html#1377" class="InductiveConstructor">NO-STEP</a> <a id="1385" class="Symbol">:</a>
      <a id="1393" class="Symbol">(</a><a id="1394" class="Keyword">let</a> <a id="1398" href="StructuredContracts.html#1398" class="Bound">txInfo</a> <a id="1405" class="Symbol">=</a> <a id="1407" href="StructuredContracts.html#749" class="Postulate">getUTxO</a> <a id="1415" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1422" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1425" class="Keyword">in</a>
      <a id="1434" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="1436" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="1438" class="Symbol">(</a><a id="1439" href="StructuredContracts.html#782" class="Postulate">isValid</a> <a id="1447" href="StructuredContracts.html#500" class="Generalizable">tx</a><a id="1449" class="Symbol">)</a>
      <a id="1457" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1459" href="StructuredContracts.html#922" class="Bound">πⁱ</a> <a id="1462" href="StructuredContracts.html#1398" class="Bound">txInfo</a> <a id="1469" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1471" href="Prelude.Monoid.html#196" class="Field">ε</a>
      <a id="1479" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1481" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="1485" href="StructuredContracts.html#514" class="Datatype Operator">⊢</a> <a id="1487" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1494" href="StructuredContracts.html#514" class="Datatype Operator">—⟨</a> <a id="1497" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1500" href="StructuredContracts.html#514" class="Datatype Operator">∣LEDGER⟩→</a> <a id="1510" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
        <a id="1526" href="Prelude.InferenceRules.html#13579" class="Function Operator">────────────────────────────────────</a>
        <a id="1571" href="StructuredContracts.html#898" class="Bound">πˢ</a> <a id="1574" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1581" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1583" href="StructuredContracts.html#898" class="Bound">πˢ</a> <a id="1586" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a><a id="1593" class="Symbol">)</a>
      <a id="1601" href="Prelude.InferenceRules.html#14250" class="Function Operator">──────────────</a>
      <a id="1622" href="StructuredContracts.html#1345" class="Datatype">StatefulNoStep</a>

<a id="IsSimulation"></a><a id="1638" href="StructuredContracts.html#1638" class="Function">IsSimulation</a> <a id="1651" class="Symbol">:</a> <a id="1653" class="Symbol">∀</a> <a id="1655" class="Symbol">{</a><a id="1656" href="StructuredContracts.html#1656" class="Bound">S</a> <a id="1658" href="StructuredContracts.html#1658" class="Bound">I</a> <a id="1660" class="Symbol">:</a> <a id="1662" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="1666" class="Symbol">}</a> <a id="1668" class="Symbol">→</a> <a id="1670" class="Symbol">⦃</a> <a id="1672" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="1679" href="StructuredContracts.html#1658" class="Bound">I</a> <a id="1681" class="Symbol">⦄</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="Prelude.Init.html#12232" class="Function">Pred₀</a> <a id="1691" class="Symbol">(</a><a id="1692" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="1698" class="Symbol">(</a><a id="1699" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="1706" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1708" href="StructuredContracts.html#1656" class="Bound">S</a> <a id="1710" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1712" href="StructuredContracts.html#1658" class="Bound">I</a><a id="1713" class="Symbol">))</a>
<a id="1716" href="StructuredContracts.html#1638" class="Function">IsSimulation</a> <a id="1729" class="Symbol">{</a><a id="1730" href="StructuredContracts.html#1730" class="Bound">S</a><a id="1731" class="Symbol">}{</a><a id="1733" href="StructuredContracts.html#1733" class="Bound">I</a><a id="1734" class="Symbol">}</a> <a id="1736" href="StructuredContracts.html#1736" class="Bound">ssRel</a> <a id="1742" class="Symbol">=</a>
  <a id="1746" href="Data.Product.html#1369" class="Function">∃</a> <a id="1748" class="Symbol">λ</a> <a id="1750" class="Symbol">(</a><a id="1751" href="StructuredContracts.html#1751" class="Bound">πˢ</a> <a id="1754" class="Symbol">:</a> <a id="1756" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="1763" class="Symbol">→</a> <a id="1765" href="StructuredContracts.html#1730" class="Bound">S</a><a id="1766" class="Symbol">)</a> <a id="1768" class="Symbol">→</a> <a id="1770" href="Data.Product.html#1369" class="Function">∃</a> <a id="1772" class="Symbol">λ</a> <a id="1774" class="Symbol">(</a><a id="1775" href="StructuredContracts.html#1775" class="Bound">πⁱ</a> <a id="1778" class="Symbol">:</a> <a id="1780" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="1787" class="Symbol">→</a> <a id="1789" href="StructuredContracts.html#1733" class="Bound">I</a><a id="1790" class="Symbol">)</a> <a id="1792" class="Symbol">→</a>
  <a id="1796" class="Keyword">let</a> <a id="1800" class="Keyword">open</a> <a id="1805" href="StructuredContracts.html#838" class="Module">Simulation</a> <a id="1816" href="StructuredContracts.html#1751" class="Bound">πˢ</a> <a id="1819" href="StructuredContracts.html#1775" class="Bound">πⁱ</a> <a id="1822" href="StructuredContracts.html#1736" class="Bound">ssRel</a> <a id="1828" class="Keyword">in</a>
    <a id="1835" href="Prelude.Init.html#1630" class="Function">Surjective≡</a> <a id="1847" class="Symbol">{</a><a id="1848" class="Argument">A</a> <a id="1850" class="Symbol">=</a> <a id="1852" href="StructuredContracts.html#385" class="Postulate">LState</a><a id="1858" class="Symbol">}</a> <a id="1860" href="StructuredContracts.html#1751" class="Bound">πˢ</a>
  <a id="1865" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1867" href="Prelude.Init.html#1630" class="Function">Surjective≡</a> <a id="1879" class="Symbol">{</a><a id="1880" class="Argument">A</a> <a id="1882" class="Symbol">=</a> <a id="1884" href="StructuredContracts.html#733" class="Postulate">TxInfo</a><a id="1890" class="Symbol">}</a> <a id="1892" href="StructuredContracts.html#1775" class="Bound">πⁱ</a>
  <a id="1897" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1899" href="StructuredContracts.html#1011" class="Datatype">StatefulStep</a>
  <a id="1914" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1916" href="StructuredContracts.html#1345" class="Datatype">StatefulNoStep</a>

<a id="1932" class="Comment">-- ** NFT state machine library</a>

<a id="1965" class="Keyword">postulate</a>
  <a id="SMS"></a><a id="1977" href="StructuredContracts.html#1977" class="Postulate">SMS</a> <a id="SMI"></a><a id="1981" href="StructuredContracts.html#1981" class="Postulate">SMI</a> <a id="Value"></a><a id="1985" href="StructuredContracts.html#1985" class="Postulate">Value</a> <a id="1991" class="Symbol">:</a> <a id="1993" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="2000" class="Keyword">instance</a> <a id="2009" href="StructuredContracts.html#2009" class="Postulate">_</a> <a id="2011" class="Symbol">:</a> <a id="2013" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="2020" href="StructuredContracts.html#1977" class="Postulate">SMS</a>
           <a id="2035" href="StructuredContracts.html#2035" class="Postulate">_</a> <a id="2037" class="Symbol">:</a> <a id="2039" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="2046" href="StructuredContracts.html#1985" class="Postulate">Value</a>
           <a id="2063" href="StructuredContracts.html#2063" class="Postulate">_</a> <a id="2065" class="Symbol">:</a> <a id="2067" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="2074" href="StructuredContracts.html#1981" class="Postulate">SMI</a>
  <a id="initState"></a><a id="2080" href="StructuredContracts.html#2080" class="Postulate">initState</a> <a id="2090" class="Symbol">:</a> <a id="2092" href="StructuredContracts.html#1977" class="Postulate">SMS</a> <a id="2096" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2098" href="StructuredContracts.html#1985" class="Postulate">Value</a>
  <a id="SpendsNFT"></a><a id="2106" href="StructuredContracts.html#2106" class="Postulate">SpendsNFT</a> <a id="PutsNFT"></a><a id="2116" href="StructuredContracts.html#2116" class="Postulate">PutsNFT</a> <a id="PropagatesNFT"></a><a id="2124" href="StructuredContracts.html#2124" class="Postulate">PropagatesNFT</a> <a id="2138" class="Symbol">:</a> <a id="2140" href="Prelude.Init.html#12232" class="Function">Pred₀</a> <a id="2146" href="StructuredContracts.html#733" class="Postulate">TxInfo</a>
  <a id="buildConstraints"></a><a id="2155" href="StructuredContracts.html#2155" class="Postulate">buildConstraints</a> <a id="2172" class="Symbol">:</a> <a id="2174" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="2181" class="Symbol">→</a> <a id="2183" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2188" class="Symbol">(</a><a id="2189" href="StructuredContracts.html#1977" class="Postulate">SMS</a> <a id="2193" class="Symbol">→</a> <a id="2195" href="StructuredContracts.html#1981" class="Postulate">SMI</a> <a id="2199" class="Symbol">→</a> <a id="2201" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2205" class="Symbol">)</a>
  <a id="_⊢_—⟨_∣SMPEC⟩→_"></a><a id="2209" href="StructuredContracts.html#2209" class="Postulate Operator">_⊢_—⟨_∣SMPEC⟩→_</a> <a id="2225" class="Symbol">:</a> <a id="2227" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="2233" class="Symbol">(</a><a id="2234" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="2241" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2243" class="Symbol">(</a><a id="2244" href="StructuredContracts.html#1977" class="Postulate">SMS</a> <a id="2248" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2250" href="StructuredContracts.html#1985" class="Postulate">Value</a><a id="2255" class="Symbol">)</a> <a id="2257" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2259" href="StructuredContracts.html#1981" class="Postulate">SMI</a><a id="2262" class="Symbol">)</a>

<a id="2265" class="Keyword">variable</a>
  <a id="2276" href="StructuredContracts.html#2276" class="Generalizable">sms</a> <a id="2280" href="StructuredContracts.html#2280" class="Generalizable">sms′</a> <a id="2285" class="Symbol">:</a> <a id="2287" href="StructuredContracts.html#1977" class="Postulate">SMS</a>
  <a id="2293" href="StructuredContracts.html#2293" class="Generalizable">smi</a> <a id="2297" class="Symbol">:</a> <a id="2299" href="StructuredContracts.html#1981" class="Postulate">SMI</a>
  <a id="2305" href="StructuredContracts.html#2305" class="Generalizable">val</a> <a id="2309" href="StructuredContracts.html#2309" class="Generalizable">val′</a> <a id="2314" class="Symbol">:</a> <a id="2316" href="StructuredContracts.html#1985" class="Postulate">Value</a>

<a id="2323" class="Keyword">data</a> <a id="_⊢_—⟨_∣NFTCE⟩→_"></a><a id="2328" href="StructuredContracts.html#2328" class="Datatype Operator">_⊢_—⟨_∣NFTCE⟩→_</a> <a id="2344" class="Symbol">:</a> <a id="2346" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="2352" class="Symbol">(</a><a id="2353" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="2360" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2362" class="Symbol">(</a><a id="2363" href="StructuredContracts.html#1977" class="Postulate">SMS</a> <a id="2367" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2369" href="StructuredContracts.html#1985" class="Postulate">Value</a><a id="2374" class="Symbol">)</a> <a id="2376" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2378" href="StructuredContracts.html#1981" class="Postulate">SMI</a><a id="2381" class="Symbol">)</a> <a id="2383" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣NFTCE⟩→_.MintsNFT"></a><a id="2392" href="StructuredContracts.html#2392" class="InductiveConstructor">MintsNFT</a> <a id="2401" class="Symbol">:</a>
    <a id="2407" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="2409" href="StructuredContracts.html#2106" class="Postulate">SpendsNFT</a> <a id="2419" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="2430" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2432" href="StructuredContracts.html#2116" class="Postulate">PutsNFT</a> <a id="2440" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="2451" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2453" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="2457" href="StructuredContracts.html#404" class="Postulate Operator">⊢</a> <a id="2459" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="2466" href="StructuredContracts.html#404" class="Postulate Operator">—⟨</a> <a id="2469" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="2472" href="StructuredContracts.html#404" class="Postulate Operator">∣UTXOW⟩→</a> <a id="2481" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
      <a id="2495" href="Prelude.InferenceRules.html#13579" class="Function Operator">────────────────────────────────────</a>
      <a id="2538" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="2545" href="StructuredContracts.html#2328" class="Datatype Operator">⊢</a> <a id="2547" href="Prelude.Monoid.html#196" class="Field">ε</a> <a id="2549" href="StructuredContracts.html#2328" class="Datatype Operator">—⟨</a> <a id="2552" href="StructuredContracts.html#2293" class="Generalizable">smi</a> <a id="2556" href="StructuredContracts.html#2328" class="Datatype Operator">∣NFTCE⟩→</a> <a id="2565" href="StructuredContracts.html#2080" class="Postulate">initState</a>

  <a id="_⊢_—⟨_∣NFTCE⟩→_.PropogatesNFT"></a><a id="2578" href="StructuredContracts.html#2578" class="InductiveConstructor">PropogatesNFT</a> <a id="2592" class="Symbol">:</a>
    <a id="2598" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="2600" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="2604" class="Symbol">(λ</a> <a id="2607" href="StructuredContracts.html#2607" class="Bound">P</a> <a id="2609" class="Symbol">→</a> <a id="2611" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2613" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2615" href="StructuredContracts.html#2607" class="Bound">P</a> <a id="2617" href="StructuredContracts.html#2276" class="Generalizable">sms</a> <a id="2621" href="StructuredContracts.html#2293" class="Generalizable">smi</a><a id="2624" class="Symbol">)</a> <a id="2626" class="Symbol">(</a><a id="2627" href="StructuredContracts.html#2155" class="Postulate">buildConstraints</a> <a id="2644" href="StructuredContracts.html#814" class="Generalizable">txInfo</a><a id="2650" class="Symbol">)</a>
    <a id="2656" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2658" href="StructuredContracts.html#2124" class="Postulate">PropagatesNFT</a> <a id="2672" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="2683" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2685" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="2692" href="StructuredContracts.html#2209" class="Postulate Operator">⊢</a> <a id="2694" class="Symbol">(</a><a id="2695" href="StructuredContracts.html#2276" class="Generalizable">sms</a> <a id="2699" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2701" href="StructuredContracts.html#2305" class="Generalizable">val</a><a id="2704" class="Symbol">)</a> <a id="2706" href="StructuredContracts.html#2209" class="Postulate Operator">—⟨</a> <a id="2709" href="StructuredContracts.html#2293" class="Generalizable">smi</a> <a id="2713" href="StructuredContracts.html#2209" class="Postulate Operator">∣SMPEC⟩→</a> <a id="2722" class="Symbol">(</a><a id="2723" href="StructuredContracts.html#2280" class="Generalizable">sms′</a> <a id="2728" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2730" href="StructuredContracts.html#2309" class="Generalizable">val′</a><a id="2734" class="Symbol">)</a>
      <a id="2742" href="Prelude.InferenceRules.html#12900" class="Function Operator">──────────────────────────────────────────────────</a>
      <a id="2799" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="2806" href="StructuredContracts.html#2328" class="Datatype Operator">⊢</a> <a id="2808" class="Symbol">(</a><a id="2809" href="StructuredContracts.html#2276" class="Generalizable">sms</a> <a id="2813" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2815" href="StructuredContracts.html#2305" class="Generalizable">val</a><a id="2818" class="Symbol">)</a> <a id="2820" href="StructuredContracts.html#2328" class="Datatype Operator">—⟨</a> <a id="2823" href="StructuredContracts.html#2293" class="Generalizable">smi</a> <a id="2827" href="StructuredContracts.html#2328" class="Datatype Operator">∣NFTCE⟩→</a> <a id="2836" class="Symbol">(</a><a id="2837" href="StructuredContracts.html#2280" class="Generalizable">sms′</a> <a id="2842" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2844" href="StructuredContracts.html#2309" class="Generalizable">val′</a><a id="2848" class="Symbol">)</a>

<a id="2851" class="Keyword">postulate</a> <a id="LEDGER-simulates-NFTCE"></a><a id="2861" href="StructuredContracts.html#2861" class="Postulate">LEDGER-simulates-NFTCE</a> <a id="2884" class="Symbol">:</a> <a id="2886" href="StructuredContracts.html#1638" class="Function">IsSimulation</a> <a id="2899" href="StructuredContracts.html#2328" class="Datatype Operator">_⊢_—⟨_∣NFTCE⟩→_</a>

<a id="2916" class="Comment">-- ** Account simulation</a>

<a id="2942" class="Keyword">data</a> <a id="IType"></a><a id="2947" href="StructuredContracts.html#2947" class="Datatype">IType</a> <a id="2953" class="Symbol">:</a> <a id="2955" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="2960" class="Keyword">where</a>
  <a id="IType.OArgs"></a><a id="2968" href="StructuredContracts.html#2968" class="InductiveConstructor">OArgs</a> <a id="IType.CArgs"></a><a id="2974" href="StructuredContracts.html#2974" class="InductiveConstructor">CArgs</a> <a id="2980" class="Symbol">:</a> <a id="2982" href="StructuredContracts.html#2947" class="Datatype">IType</a>
<a id="2988" class="Keyword">unquoteDecl</a> <a id="Derive-IType"></a><a id="3000" href="StructuredContracts.html#3000" class="Function">Derive-IType</a> <a id="3013" class="Symbol">=</a> <a id="3015" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="3022" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3028" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3030" class="Keyword">quote</a> <a id="3036" href="StructuredContracts.html#2947" class="Datatype">IType</a> <a id="3042" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3044" href="StructuredContracts.html#3000" class="Function">Derive-IType</a> <a id="3057" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="3060" class="Keyword">postulate</a>
  <a id="Id"></a><a id="3072" href="StructuredContracts.html#3072" class="Postulate">Id</a> <a id="Key"></a><a id="3075" href="StructuredContracts.html#3075" class="Postulate">Key</a> <a id="3079" class="Symbol">:</a> <a id="3081" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="3088" class="Keyword">instance</a> <a id="3097" href="StructuredContracts.html#3097" class="Postulate">_</a> <a id="3099" class="Symbol">:</a> <a id="3101" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3107" href="StructuredContracts.html#3072" class="Postulate">Id</a>
           <a id="3121" href="StructuredContracts.html#3121" class="Postulate">_</a> <a id="3123" class="Symbol">:</a> <a id="3125" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3131" href="StructuredContracts.html#3075" class="Postulate">Key</a>
           <a id="3146" href="StructuredContracts.html#3146" class="Postulate">_</a> <a id="3148" class="Symbol">:</a> <a id="3150" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3156" href="StructuredContracts.html#1985" class="Postulate">Value</a>

<a id="3163" class="Keyword">record</a> <a id="AccI"></a><a id="3170" href="StructuredContracts.html#3170" class="Record">AccI</a> <a id="3175" class="Symbol">:</a> <a id="3177" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3182" class="Keyword">where</a>
  <a id="3190" class="Keyword">field</a> <a id="AccI.id"></a><a id="3196" href="StructuredContracts.html#3196" class="Field">id</a> <a id="3199" class="Symbol">:</a> <a id="3201" href="StructuredContracts.html#3072" class="Postulate">Id</a>
        <a id="AccI.pk"></a><a id="3212" href="StructuredContracts.html#3212" class="Field">pk</a> <a id="3215" class="Symbol">:</a> <a id="3217" href="StructuredContracts.html#3075" class="Postulate">Key</a>
<a id="3221" class="Keyword">open</a> <a id="3226" href="StructuredContracts.html#3170" class="Module">AccI</a>

<a id="3232" class="Keyword">record</a> <a id="Account"></a><a id="3239" href="StructuredContracts.html#3239" class="Record">Account</a> <a id="3247" class="Symbol">:</a> <a id="3249" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3254" class="Keyword">where</a>
  <a id="3262" class="Keyword">field</a> <a id="Account.id"></a><a id="3268" href="StructuredContracts.html#3268" class="Field">id</a> <a id="3271" class="Symbol">:</a> <a id="3273" href="StructuredContracts.html#3072" class="Postulate">Id</a>
        <a id="Account.value"></a><a id="3284" href="StructuredContracts.html#3284" class="Field">value</a> <a id="3290" class="Symbol">:</a> <a id="3292" href="StructuredContracts.html#1985" class="Postulate">Value</a>
        <a id="Account.pk"></a><a id="3306" href="StructuredContracts.html#3306" class="Field">pk</a> <a id="3309" class="Symbol">:</a> <a id="3311" href="StructuredContracts.html#3075" class="Postulate">Key</a>
<a id="3315" class="Keyword">open</a> <a id="3320" href="StructuredContracts.html#3239" class="Module">Account</a>
<a id="3328" class="Keyword">unquoteDecl</a> <a id="Derive-Account"></a><a id="3340" href="StructuredContracts.html#3340" class="Function">Derive-Account</a> <a id="3355" class="Symbol">=</a> <a id="3357" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="3364" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3370" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3372" class="Keyword">quote</a> <a id="3378" href="StructuredContracts.html#3239" class="Record">Account</a> <a id="3386" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3388" href="StructuredContracts.html#3340" class="Function">Derive-Account</a> <a id="3403" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="3406" class="Keyword">postulate</a>
  <a id="3418" class="Keyword">instance</a> <a id="3427" href="StructuredContracts.html#3427" class="Postulate">_</a> <a id="3429" class="Symbol">:</a> <a id="3431" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="3438" href="StructuredContracts.html#3170" class="Record">AccI</a>
  <a id="txInfoSignatories"></a><a id="3445" href="StructuredContracts.html#3445" class="Postulate">txInfoSignatories</a> <a id="3463" class="Symbol">:</a> <a id="3465" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="3472" class="Symbol">→</a> <a id="3474" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3479" href="StructuredContracts.html#3075" class="Postulate">Key</a>
  <a id="itype"></a><a id="3485" href="StructuredContracts.html#3485" class="Postulate">itype</a> <a id="3491" class="Symbol">:</a> <a id="3493" href="StructuredContracts.html#3170" class="Record">AccI</a> <a id="3498" class="Symbol">→</a> <a id="3500" href="StructuredContracts.html#2947" class="Datatype">IType</a>

<a id="3507" class="Keyword">variable</a>
  <a id="3518" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="3524" class="Symbol">:</a> <a id="3526" href="StructuredContracts.html#3170" class="Record">AccI</a>
  <a id="3533" href="StructuredContracts.html#3533" class="Generalizable">accts</a> <a id="3539" class="Symbol">:</a> <a id="3541" href="Prelude.Maps.AsSets.html#523" class="Record">Map⟨</a> <a id="3546" href="StructuredContracts.html#3072" class="Postulate">Id</a> <a id="3549" href="Prelude.Maps.AsSets.html#523" class="Record">↦</a> <a id="3551" href="StructuredContracts.html#3239" class="Record">Account</a> <a id="3559" href="Prelude.Maps.AsSets.html#523" class="Record">⟩</a>
  <a id="3563" href="StructuredContracts.html#3563" class="Generalizable">newAcct</a> <a id="3571" href="StructuredContracts.html#3571" class="Generalizable">acntToClose</a> <a id="3583" class="Symbol">:</a> <a id="3585" href="StructuredContracts.html#3239" class="Record">Account</a>

<a id="3594" class="Keyword">data</a> <a id="_⊢_—⟨_∣ACCNT⟩→_"></a><a id="3599" href="StructuredContracts.html#3599" class="Datatype Operator">_⊢_—⟨_∣ACCNT⟩→_</a> <a id="3615" class="Symbol">:</a> <a id="3617" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="3623" class="Symbol">(</a><a id="3624" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="3631" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3633" href="Prelude.Maps.AsSets.html#523" class="Record">Map⟨</a> <a id="3638" href="StructuredContracts.html#3072" class="Postulate">Id</a> <a id="3641" href="Prelude.Maps.AsSets.html#523" class="Record">↦</a> <a id="3643" href="StructuredContracts.html#3239" class="Record">Account</a> <a id="3651" href="Prelude.Maps.AsSets.html#523" class="Record">⟩</a> <a id="3653" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3655" href="StructuredContracts.html#3170" class="Record">AccI</a><a id="3659" class="Symbol">)</a> <a id="3661" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣ACCNT⟩→_.Open"></a><a id="3670" href="StructuredContracts.html#3670" class="InductiveConstructor">Open</a> <a id="3675" class="Symbol">:</a>

    <a id="3682" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="3684" href="StructuredContracts.html#3485" class="Postulate">itype</a> <a id="3690" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="3696" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3698" href="StructuredContracts.html#2968" class="InductiveConstructor">OArgs</a>
    <a id="3708" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3710" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="3716" class="Symbol">.</a><a id="3717" href="StructuredContracts.html#3212" class="Field">pk</a> <a id="3720" href="Prelude.Membership.html#400" class="Field Operator">∈</a> <a id="3722" href="StructuredContracts.html#3445" class="Postulate">txInfoSignatories</a> <a id="3740" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="3751" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3753" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="3759" class="Symbol">.</a><a id="3760" href="StructuredContracts.html#3196" class="Field">id</a> <a id="3763" href="Prelude.Maps.AsSets.html#1663" class="Function Operator">∉ᵈ</a> <a id="3766" href="StructuredContracts.html#3533" class="Generalizable">accts</a>
    <a id="3776" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3778" href="StructuredContracts.html#3563" class="Generalizable">newAcct</a> <a id="3786" class="Symbol">.</a><a id="3787" href="StructuredContracts.html#3306" class="Field">pk</a> <a id="3790" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3792" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="3798" class="Symbol">.</a><a id="3799" href="StructuredContracts.html#3212" class="Field">pk</a>
    <a id="3806" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3808" href="StructuredContracts.html#3563" class="Generalizable">newAcct</a> <a id="3816" class="Symbol">.</a><a id="3817" href="StructuredContracts.html#3284" class="Field">value</a> <a id="3823" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3825" href="Prelude.Monoid.html#196" class="Field">ε</a>
      <a id="3833" href="Prelude.InferenceRules.html#11280" class="Function Operator">──────────────────────────────────────────────────────────────────────────</a>
      <a id="3914" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="3921" href="StructuredContracts.html#3599" class="Datatype Operator">⊢</a> <a id="3923" href="StructuredContracts.html#3533" class="Generalizable">accts</a> <a id="3929" href="StructuredContracts.html#3599" class="Datatype Operator">—⟨</a> <a id="3932" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="3938" href="StructuredContracts.html#3599" class="Datatype Operator">∣ACCNT⟩→</a> <a id="3947" class="Symbol">(</a><a id="3948" href="StructuredContracts.html#3533" class="Generalizable">accts</a> <a id="3954" href="Prelude.Maps.AsSets.html#1442" class="Function Operator">∪</a> <a id="3956" href="Prelude.Maps.AsSets.html#917" class="Function">singleton</a> <a id="3966" class="Symbol">(</a><a id="3967" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="3973" class="Symbol">.</a><a id="3974" href="StructuredContracts.html#3196" class="Field">id</a> <a id="3977" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3979" href="StructuredContracts.html#3563" class="Generalizable">newAcct</a><a id="3986" class="Symbol">))</a>

  <a id="_⊢_—⟨_∣ACCNT⟩→_.Close"></a><a id="3992" href="StructuredContracts.html#3992" class="InductiveConstructor">Close</a> <a id="3998" class="Symbol">:</a>

    <a id="4005" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="4007" href="StructuredContracts.html#3485" class="Postulate">itype</a> <a id="4013" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="4019" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4021" href="StructuredContracts.html#2974" class="InductiveConstructor">CArgs</a>
    <a id="4031" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="4033" href="StructuredContracts.html#3533" class="Generalizable">accts</a> <a id="4039" href="Prelude.Maps.AsSets.html#1983" class="Function Operator">[</a> <a id="4041" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="4047" class="Symbol">.</a><a id="4048" href="StructuredContracts.html#3196" class="Field">id</a> <a id="4051" href="Prelude.Maps.AsSets.html#1983" class="Function Operator">↦</a> <a id="4053" href="StructuredContracts.html#3571" class="Generalizable">acntToClose</a> <a id="4065" href="Prelude.Maps.AsSets.html#1983" class="Function Operator">]</a>
    <a id="4071" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="4073" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="4079" class="Symbol">.</a><a id="4080" href="StructuredContracts.html#3212" class="Field">pk</a> <a id="4083" href="Prelude.Membership.html#400" class="Field Operator">∈</a> <a id="4085" href="StructuredContracts.html#3445" class="Postulate">txInfoSignatories</a> <a id="4103" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="4114" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="4116" href="StructuredContracts.html#3571" class="Generalizable">acntToClose</a> <a id="4128" class="Symbol">.</a><a id="4129" href="StructuredContracts.html#3284" class="Field">value</a> <a id="4135" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4137" href="Prelude.Monoid.html#196" class="Field">ε</a>
      <a id="4145" href="Prelude.InferenceRules.html#12787" class="Function Operator">────────────────────────────────────────────────────</a>
      <a id="4204" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="4211" href="StructuredContracts.html#3599" class="Datatype Operator">⊢</a> <a id="4213" href="StructuredContracts.html#3533" class="Generalizable">accts</a> <a id="4219" href="StructuredContracts.html#3599" class="Datatype Operator">—⟨</a> <a id="4222" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="4228" href="StructuredContracts.html#3599" class="Datatype Operator">∣ACCNT⟩→</a> <a id="4237" class="Symbol">(</a><a id="4238" href="StructuredContracts.html#3518" class="Generalizable">accIn</a> <a id="4244" class="Symbol">.</a><a id="4245" href="StructuredContracts.html#3196" class="Field">id</a> <a id="4248" href="Prelude.Maps.AsSets.html#3422" class="Function Operator">⋪</a> <a id="4250" href="StructuredContracts.html#3533" class="Generalizable">accts</a><a id="4255" class="Symbol">)</a>

<a id="4258" class="Keyword">postulate</a> <a id="LEDGER-simulates-ACCNT"></a><a id="4268" href="StructuredContracts.html#4268" class="Postulate">LEDGER-simulates-ACCNT</a> <a id="4291" class="Symbol">:</a> <a id="4293" href="StructuredContracts.html#1638" class="Function">IsSimulation</a> <a id="4306" href="StructuredContracts.html#3599" class="Datatype Operator">_⊢_—⟨_∣ACCNT⟩→_</a>
</pre></body></html>