<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StructuredContracts</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/structured-contracts/tree/master/StructuredContracts.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="26" class="Keyword">hiding</a> <a id="33" class="Symbol">(</a><a id="34" href="Function.Base.html#615" class="Function">id</a><a id="36" class="Symbol">);</a> <a id="39" class="Keyword">open</a> <a id="44" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="89" class="Keyword">open</a> <a id="94" class="Keyword">import</a> <a id="101" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="Prelude.Maps.html" class="Module">Prelude.Maps</a>

<a id="229" class="Comment">-- small-step relations</a>
<a id="SSRel"></a><a id="253" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="259" class="Symbol">:</a> <a id="261" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="266" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="268" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="273" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="275" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="280" class="Symbol">→</a> <a id="282" href="Agda.Primitive.html#326" class="Primitive">Type₁</a>
<a id="288" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="294" class="Symbol">(</a><a id="295" href="StructuredContracts.html#295" class="Bound">Env</a> <a id="299" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="301" href="StructuredContracts.html#301" class="Bound">State</a> <a id="307" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="309" href="StructuredContracts.html#309" class="Bound">Input</a><a id="314" class="Symbol">)</a> <a id="316" class="Symbol">=</a> <a id="318" href="StructuredContracts.html#295" class="Bound">Env</a> <a id="322" class="Symbol">→</a> <a id="324" href="StructuredContracts.html#301" class="Bound">State</a> <a id="330" class="Symbol">→</a> <a id="332" href="StructuredContracts.html#309" class="Bound">Input</a> <a id="338" class="Symbol">→</a> <a id="340" href="StructuredContracts.html#301" class="Bound">State</a> <a id="346" class="Symbol">→</a> <a id="348" href="Agda.Primitive.html#326" class="Primitive">Type</a>

<a id="354" class="Comment">-- ** Ledger</a>

<a id="368" class="Keyword">postulate</a>
  <a id="LEnv"></a><a id="380" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="LState"></a><a id="385" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="Tx"></a><a id="392" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="395" class="Symbol">:</a> <a id="397" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="_⊢_—⟨_∣UTXOW⟩→_"></a><a id="404" href="StructuredContracts.html#404" class="Postulate Operator">_⊢_—⟨_∣UTXOW⟩→_</a> <a id="420" class="Symbol">:</a> <a id="422" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="428" class="Symbol">(</a><a id="429" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="434" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="436" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="443" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="445" href="StructuredContracts.html#392" class="Postulate">Tx</a><a id="447" class="Symbol">)</a>
<a id="449" class="Keyword">variable</a>
  <a id="460" href="StructuredContracts.html#460" class="Generalizable">env</a> <a id="464" class="Symbol">:</a> <a id="466" href="StructuredContracts.html#380" class="Postulate">LEnv</a>
  <a id="473" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="480" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a> <a id="488" class="Symbol">:</a> <a id="490" href="StructuredContracts.html#385" class="Postulate">LState</a>
  <a id="499" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="502" class="Symbol">:</a> <a id="504" href="StructuredContracts.html#392" class="Postulate">Tx</a>

<a id="508" class="Keyword">data</a> <a id="_⊢_—⟨_∣LEDGER⟩→_"></a><a id="513" href="StructuredContracts.html#513" class="Datatype Operator">_⊢_—⟨_∣LEDGER⟩→_</a> <a id="530" class="Symbol">:</a> <a id="532" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="538" class="Symbol">(</a><a id="539" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="544" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="546" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="553" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="555" href="StructuredContracts.html#392" class="Postulate">Tx</a><a id="557" class="Symbol">)</a> <a id="559" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣LEDGER⟩→_.ledger-V"></a><a id="568" href="StructuredContracts.html#568" class="InductiveConstructor">ledger-V</a> <a id="577" class="Symbol">:</a>
    <a id="583" href="StructuredContracts.html#460" class="Generalizable">env</a> <a id="587" href="StructuredContracts.html#404" class="Postulate Operator">⊢</a> <a id="589" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="596" href="StructuredContracts.html#404" class="Postulate Operator">—⟨</a> <a id="599" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="602" href="StructuredContracts.html#404" class="Postulate Operator">∣UTXOW⟩→</a> <a id="611" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a>
    <a id="623" href="Prelude.InferenceRules.html#13579" class="Function Operator">────────────────────────────────────</a>
    <a id="664" href="StructuredContracts.html#460" class="Generalizable">env</a> <a id="668" href="StructuredContracts.html#513" class="Datatype Operator">⊢</a> <a id="670" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="677" href="StructuredContracts.html#513" class="Datatype Operator">—⟨</a> <a id="680" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="683" href="StructuredContracts.html#513" class="Datatype Operator">∣LEDGER⟩→</a> <a id="693" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a>

<a id="702" class="Comment">-- ** Simulation</a>

<a id="720" class="Keyword">postulate</a>
  <a id="TxInfo"></a><a id="732" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="739" class="Symbol">:</a> <a id="741" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="getUTxO"></a><a id="748" href="StructuredContracts.html#748" class="Postulate">getUTxO</a> <a id="756" class="Symbol">:</a> <a id="758" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="765" class="Symbol">→</a> <a id="767" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="770" class="Symbol">→</a> <a id="772" href="StructuredContracts.html#732" class="Postulate">TxInfo</a>
  <a id="isValid"></a><a id="781" href="StructuredContracts.html#781" class="Postulate">isValid</a> <a id="789" class="Symbol">:</a> <a id="791" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="794" class="Symbol">→</a> <a id="796" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="801" class="Keyword">variable</a>
  <a id="812" href="StructuredContracts.html#812" class="Generalizable">txInfo</a> <a id="819" class="Symbol">:</a> <a id="821" href="StructuredContracts.html#732" class="Postulate">TxInfo</a>

<a id="829" class="Keyword">module</a> <a id="Simulation"></a><a id="836" href="StructuredContracts.html#836" class="Module">Simulation</a>
  <a id="849" class="Symbol">{</a><a id="850" href="StructuredContracts.html#850" class="Bound">State</a> <a id="856" href="StructuredContracts.html#856" class="Bound">Input</a> <a id="862" class="Symbol">:</a> <a id="864" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="868" class="Symbol">}</a>
  <a id="872" class="Symbol">⦃</a> <a id="874" href="StructuredContracts.html#874" class="Bound">_</a> <a id="876" class="Symbol">:</a> <a id="878" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="885" href="StructuredContracts.html#856" class="Bound">Input</a> <a id="891" class="Symbol">⦄</a>
  <a id="895" class="Symbol">(</a><a id="896" href="StructuredContracts.html#896" class="Bound">πˢ</a> <a id="899" class="Symbol">:</a> <a id="901" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="908" class="Symbol">→</a> <a id="910" href="StructuredContracts.html#850" class="Bound">State</a><a id="915" class="Symbol">)</a>
  <a id="919" class="Symbol">(</a><a id="920" href="StructuredContracts.html#920" class="Bound">πⁱ</a> <a id="923" class="Symbol">:</a> <a id="925" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="932" class="Symbol">→</a> <a id="934" href="StructuredContracts.html#856" class="Bound">Input</a><a id="939" class="Symbol">)</a>
  <a id="943" class="Symbol">(</a><a id="944" href="StructuredContracts.html#944" class="Bound Operator">_⊢_—⟨_∣SMUP⟩→_</a> <a id="959" class="Symbol">:</a> <a id="961" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="967" class="Symbol">(</a><a id="968" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="975" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="977" href="StructuredContracts.html#850" class="Bound">State</a> <a id="983" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="985" href="StructuredContracts.html#856" class="Bound">Input</a><a id="990" class="Symbol">))</a>
  <a id="995" class="Keyword">where</a>

  <a id="1004" class="Keyword">data</a> <a id="Simulation.StatefulStep"></a><a id="1009" href="StructuredContracts.html#1009" class="Datatype">StatefulStep</a> <a id="1022" class="Symbol">:</a> <a id="1024" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1029" class="Keyword">where</a>
    <a id="Simulation.StatefulStep.STEP"></a><a id="1039" href="StructuredContracts.html#1039" class="InductiveConstructor">STEP</a> <a id="1044" class="Symbol">:</a>
      <a id="1052" class="Symbol">(</a><a id="1053" class="Keyword">let</a> <a id="1057" href="StructuredContracts.html#1057" class="Bound">txInfo</a> <a id="1064" class="Symbol">=</a> <a id="1066" href="StructuredContracts.html#748" class="Postulate">getUTxO</a> <a id="1074" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="1081" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="1084" class="Keyword">in</a>
      <a id="1093" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="1095" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="1097" class="Symbol">(</a><a id="1098" href="StructuredContracts.html#781" class="Postulate">isValid</a> <a id="1106" href="StructuredContracts.html#499" class="Generalizable">tx</a><a id="1108" class="Symbol">)</a>
      <a id="1116" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1118" href="StructuredContracts.html#920" class="Bound">πⁱ</a> <a id="1121" href="StructuredContracts.html#1057" class="Bound">txInfo</a> <a id="1128" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="1130" href="Prelude.Monoid.html#196" class="Field">ε</a>
      <a id="1138" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1140" href="StructuredContracts.html#460" class="Generalizable">env</a> <a id="1144" href="StructuredContracts.html#513" class="Datatype Operator">⊢</a> <a id="1146" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="1153" href="StructuredContracts.html#513" class="Datatype Operator">—⟨</a> <a id="1156" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="1159" href="StructuredContracts.html#513" class="Datatype Operator">∣LEDGER⟩→</a> <a id="1169" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a>
        <a id="1185" href="Prelude.InferenceRules.html#12900" class="Function Operator">──────────────────────────────────────────────────</a>
        <a id="1244" href="StructuredContracts.html#1057" class="Bound">txInfo</a> <a id="1251" href="StructuredContracts.html#944" class="Bound Operator">⊢</a> <a id="1253" href="StructuredContracts.html#896" class="Bound">πˢ</a> <a id="1256" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="1263" href="StructuredContracts.html#944" class="Bound Operator">—⟨</a> <a id="1266" href="StructuredContracts.html#920" class="Bound">πⁱ</a> <a id="1269" href="StructuredContracts.html#1057" class="Bound">txInfo</a> <a id="1276" href="StructuredContracts.html#944" class="Bound Operator">∣SMUP⟩→</a> <a id="1284" href="StructuredContracts.html#896" class="Bound">πˢ</a> <a id="1287" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a><a id="1294" class="Symbol">)</a>
      <a id="1302" href="Prelude.InferenceRules.html#14287" class="Function Operator">────────────</a>
      <a id="1321" href="StructuredContracts.html#1009" class="Datatype">StatefulStep</a>

  <a id="1337" class="Keyword">data</a> <a id="Simulation.StatefulNoStep"></a><a id="1342" href="StructuredContracts.html#1342" class="Datatype">StatefulNoStep</a> <a id="1357" class="Symbol">:</a> <a id="1359" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1364" class="Keyword">where</a>
    <a id="Simulation.StatefulNoStep.NO-STEP"></a><a id="1374" href="StructuredContracts.html#1374" class="InductiveConstructor">NO-STEP</a> <a id="1382" class="Symbol">:</a>
      <a id="1390" class="Symbol">(</a><a id="1391" class="Keyword">let</a> <a id="1395" href="StructuredContracts.html#1395" class="Bound">txInfo</a> <a id="1402" class="Symbol">=</a> <a id="1404" href="StructuredContracts.html#748" class="Postulate">getUTxO</a> <a id="1412" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="1419" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="1422" class="Keyword">in</a>
      <a id="1431" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="1433" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="1435" class="Symbol">(</a><a id="1436" href="StructuredContracts.html#781" class="Postulate">isValid</a> <a id="1444" href="StructuredContracts.html#499" class="Generalizable">tx</a><a id="1446" class="Symbol">)</a>
      <a id="1454" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1456" href="StructuredContracts.html#920" class="Bound">πⁱ</a> <a id="1459" href="StructuredContracts.html#1395" class="Bound">txInfo</a> <a id="1466" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1468" href="Prelude.Monoid.html#196" class="Field">ε</a>
      <a id="1476" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1478" href="StructuredContracts.html#460" class="Generalizable">env</a> <a id="1482" href="StructuredContracts.html#513" class="Datatype Operator">⊢</a> <a id="1484" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="1491" href="StructuredContracts.html#513" class="Datatype Operator">—⟨</a> <a id="1494" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="1497" href="StructuredContracts.html#513" class="Datatype Operator">∣LEDGER⟩→</a> <a id="1507" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a>
        <a id="1523" href="Prelude.InferenceRules.html#13579" class="Function Operator">────────────────────────────────────</a>
        <a id="1568" href="StructuredContracts.html#896" class="Bound">πˢ</a> <a id="1571" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="1578" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1580" href="StructuredContracts.html#896" class="Bound">πˢ</a> <a id="1583" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a><a id="1590" class="Symbol">)</a>
      <a id="1598" href="Prelude.InferenceRules.html#14250" class="Function Operator">──────────────</a>
      <a id="1619" href="StructuredContracts.html#1342" class="Datatype">StatefulNoStep</a>

<a id="IsSimulation"></a><a id="1635" href="StructuredContracts.html#1635" class="Function">IsSimulation</a> <a id="1648" class="Symbol">:</a> <a id="1650" class="Symbol">∀</a> <a id="1652" class="Symbol">{</a><a id="1653" href="StructuredContracts.html#1653" class="Bound">S</a> <a id="1655" href="StructuredContracts.html#1655" class="Bound">I</a> <a id="1657" class="Symbol">:</a> <a id="1659" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="1663" class="Symbol">}</a> <a id="1665" class="Symbol">→</a> <a id="1667" class="Symbol">⦃</a> <a id="1669" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="1676" href="StructuredContracts.html#1655" class="Bound">I</a> <a id="1678" class="Symbol">⦄</a> <a id="1680" class="Symbol">→</a> <a id="1682" href="Prelude.Init.html#12232" class="Function">Pred₀</a> <a id="1688" class="Symbol">(</a><a id="1689" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="1695" class="Symbol">(</a><a id="1696" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="1703" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1705" href="StructuredContracts.html#1653" class="Bound">S</a> <a id="1707" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1709" href="StructuredContracts.html#1655" class="Bound">I</a><a id="1710" class="Symbol">))</a>
<a id="1713" href="StructuredContracts.html#1635" class="Function">IsSimulation</a> <a id="1726" class="Symbol">{</a><a id="1727" href="StructuredContracts.html#1727" class="Bound">S</a><a id="1728" class="Symbol">}{</a><a id="1730" href="StructuredContracts.html#1730" class="Bound">I</a><a id="1731" class="Symbol">}</a> <a id="1733" href="StructuredContracts.html#1733" class="Bound">ssRel</a> <a id="1739" class="Symbol">=</a>
  <a id="1743" href="Data.Product.html#1369" class="Function">∃</a> <a id="1745" class="Symbol">λ</a> <a id="1747" class="Symbol">(</a><a id="1748" href="StructuredContracts.html#1748" class="Bound">πˢ</a> <a id="1751" class="Symbol">:</a> <a id="1753" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="1760" class="Symbol">→</a> <a id="1762" href="StructuredContracts.html#1727" class="Bound">S</a><a id="1763" class="Symbol">)</a> <a id="1765" class="Symbol">→</a> <a id="1767" href="Data.Product.html#1369" class="Function">∃</a> <a id="1769" class="Symbol">λ</a> <a id="1771" class="Symbol">(</a><a id="1772" href="StructuredContracts.html#1772" class="Bound">πⁱ</a> <a id="1775" class="Symbol">:</a> <a id="1777" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="1784" class="Symbol">→</a> <a id="1786" href="StructuredContracts.html#1730" class="Bound">I</a><a id="1787" class="Symbol">)</a> <a id="1789" class="Symbol">→</a>
  <a id="1793" class="Keyword">let</a> <a id="1797" class="Keyword">open</a> <a id="1802" href="StructuredContracts.html#836" class="Module">Simulation</a> <a id="1813" href="StructuredContracts.html#1748" class="Bound">πˢ</a> <a id="1816" href="StructuredContracts.html#1772" class="Bound">πⁱ</a> <a id="1819" href="StructuredContracts.html#1733" class="Bound">ssRel</a> <a id="1825" class="Keyword">in</a>
    <a id="1832" href="Prelude.Init.html#1630" class="Function">Surjective≡</a> <a id="1844" class="Symbol">{</a><a id="1845" class="Argument">A</a> <a id="1847" class="Symbol">=</a> <a id="1849" href="StructuredContracts.html#385" class="Postulate">LState</a><a id="1855" class="Symbol">}</a> <a id="1857" href="StructuredContracts.html#1748" class="Bound">πˢ</a>
  <a id="1862" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1864" href="Prelude.Init.html#1630" class="Function">Surjective≡</a> <a id="1876" class="Symbol">{</a><a id="1877" class="Argument">A</a> <a id="1879" class="Symbol">=</a> <a id="1881" href="StructuredContracts.html#732" class="Postulate">TxInfo</a><a id="1887" class="Symbol">}</a> <a id="1889" href="StructuredContracts.html#1772" class="Bound">πⁱ</a>
  <a id="1894" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1896" href="StructuredContracts.html#1009" class="Datatype">StatefulStep</a>
  <a id="1911" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1913" href="StructuredContracts.html#1342" class="Datatype">StatefulNoStep</a>

<a id="1929" class="Comment">-- ** NFT state machine library</a>

<a id="1962" class="Keyword">postulate</a>
  <a id="SMS"></a><a id="1974" href="StructuredContracts.html#1974" class="Postulate">SMS</a> <a id="SMI"></a><a id="1978" href="StructuredContracts.html#1978" class="Postulate">SMI</a> <a id="Value"></a><a id="1982" href="StructuredContracts.html#1982" class="Postulate">Value</a> <a id="1988" class="Symbol">:</a> <a id="1990" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="1997" class="Keyword">instance</a> <a id="2006" href="StructuredContracts.html#2006" class="Postulate">_</a> <a id="2008" class="Symbol">:</a> <a id="2010" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="2017" href="StructuredContracts.html#1974" class="Postulate">SMS</a>
           <a id="2032" href="StructuredContracts.html#2032" class="Postulate">_</a> <a id="2034" class="Symbol">:</a> <a id="2036" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="2043" href="StructuredContracts.html#1982" class="Postulate">Value</a>
           <a id="2060" href="StructuredContracts.html#2060" class="Postulate">_</a> <a id="2062" class="Symbol">:</a> <a id="2064" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="2071" href="StructuredContracts.html#1978" class="Postulate">SMI</a>
  <a id="initState"></a><a id="2077" href="StructuredContracts.html#2077" class="Postulate">initState</a> <a id="2087" class="Symbol">:</a> <a id="2089" href="StructuredContracts.html#1974" class="Postulate">SMS</a> <a id="2093" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2095" href="StructuredContracts.html#1982" class="Postulate">Value</a>
  <a id="SpendsNFT"></a><a id="2103" href="StructuredContracts.html#2103" class="Postulate">SpendsNFT</a> <a id="PutsNFT"></a><a id="2113" href="StructuredContracts.html#2113" class="Postulate">PutsNFT</a> <a id="PropagatesNFT"></a><a id="2121" href="StructuredContracts.html#2121" class="Postulate">PropagatesNFT</a> <a id="2135" class="Symbol">:</a> <a id="2137" href="Prelude.Init.html#12232" class="Function">Pred₀</a> <a id="2143" href="StructuredContracts.html#732" class="Postulate">TxInfo</a>
  <a id="buildConstraints"></a><a id="2152" href="StructuredContracts.html#2152" class="Postulate">buildConstraints</a> <a id="2169" class="Symbol">:</a> <a id="2171" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="2178" class="Symbol">→</a> <a id="2180" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2185" class="Symbol">(</a><a id="2186" href="StructuredContracts.html#1974" class="Postulate">SMS</a> <a id="2190" class="Symbol">→</a> <a id="2192" href="StructuredContracts.html#1978" class="Postulate">SMI</a> <a id="2196" class="Symbol">→</a> <a id="2198" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2202" class="Symbol">)</a>
  <a id="_⊢_—⟨_∣SMPEC⟩→_"></a><a id="2206" href="StructuredContracts.html#2206" class="Postulate Operator">_⊢_—⟨_∣SMPEC⟩→_</a> <a id="2222" class="Symbol">:</a> <a id="2224" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="2230" class="Symbol">(</a><a id="2231" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="2238" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2240" class="Symbol">(</a><a id="2241" href="StructuredContracts.html#1974" class="Postulate">SMS</a> <a id="2245" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2247" href="StructuredContracts.html#1982" class="Postulate">Value</a><a id="2252" class="Symbol">)</a> <a id="2254" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2256" href="StructuredContracts.html#1978" class="Postulate">SMI</a><a id="2259" class="Symbol">)</a>
<a id="2261" class="Keyword">variable</a>
  <a id="2272" href="StructuredContracts.html#2272" class="Generalizable">sms</a> <a id="2276" href="StructuredContracts.html#2276" class="Generalizable">sms′</a> <a id="2281" class="Symbol">:</a> <a id="2283" href="StructuredContracts.html#1974" class="Postulate">SMS</a>
  <a id="2289" href="StructuredContracts.html#2289" class="Generalizable">smi</a> <a id="2293" class="Symbol">:</a> <a id="2295" href="StructuredContracts.html#1978" class="Postulate">SMI</a>
  <a id="2301" href="StructuredContracts.html#2301" class="Generalizable">val</a> <a id="2305" href="StructuredContracts.html#2305" class="Generalizable">val′</a> <a id="2310" class="Symbol">:</a> <a id="2312" href="StructuredContracts.html#1982" class="Postulate">Value</a>

<a id="2319" class="Keyword">data</a> <a id="_⊢_—⟨_∣NFTCE⟩→_"></a><a id="2324" href="StructuredContracts.html#2324" class="Datatype Operator">_⊢_—⟨_∣NFTCE⟩→_</a> <a id="2340" class="Symbol">:</a> <a id="2342" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="2348" class="Symbol">(</a><a id="2349" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="2356" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2358" class="Symbol">(</a><a id="2359" href="StructuredContracts.html#1974" class="Postulate">SMS</a> <a id="2363" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2365" href="StructuredContracts.html#1982" class="Postulate">Value</a><a id="2370" class="Symbol">)</a> <a id="2372" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2374" href="StructuredContracts.html#1978" class="Postulate">SMI</a><a id="2377" class="Symbol">)</a> <a id="2379" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣NFTCE⟩→_.MintsNFT"></a><a id="2388" href="StructuredContracts.html#2388" class="InductiveConstructor">MintsNFT</a> <a id="2397" class="Symbol">:</a>
    <a id="2403" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="2405" href="StructuredContracts.html#2103" class="Postulate">SpendsNFT</a> <a id="2415" href="StructuredContracts.html#812" class="Generalizable">txInfo</a>
    <a id="2426" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2428" href="StructuredContracts.html#2113" class="Postulate">PutsNFT</a> <a id="2436" href="StructuredContracts.html#812" class="Generalizable">txInfo</a>
    <a id="2447" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2449" href="StructuredContracts.html#460" class="Generalizable">env</a> <a id="2453" href="StructuredContracts.html#404" class="Postulate Operator">⊢</a> <a id="2455" href="StructuredContracts.html#473" class="Generalizable">utxoSt</a> <a id="2462" href="StructuredContracts.html#404" class="Postulate Operator">—⟨</a> <a id="2465" href="StructuredContracts.html#499" class="Generalizable">tx</a> <a id="2468" href="StructuredContracts.html#404" class="Postulate Operator">∣UTXOW⟩→</a> <a id="2477" href="StructuredContracts.html#480" class="Generalizable">utxoSt′</a>
      <a id="2491" href="Prelude.InferenceRules.html#13579" class="Function Operator">────────────────────────────────────</a>
      <a id="2534" href="StructuredContracts.html#812" class="Generalizable">txInfo</a> <a id="2541" href="StructuredContracts.html#2324" class="Datatype Operator">⊢</a> <a id="2543" href="Prelude.Monoid.html#196" class="Field">ε</a> <a id="2545" href="StructuredContracts.html#2324" class="Datatype Operator">—⟨</a> <a id="2548" href="StructuredContracts.html#2289" class="Generalizable">smi</a> <a id="2552" href="StructuredContracts.html#2324" class="Datatype Operator">∣NFTCE⟩→</a> <a id="2561" href="StructuredContracts.html#2077" class="Postulate">initState</a>

  <a id="_⊢_—⟨_∣NFTCE⟩→_.PropogatesNFT"></a><a id="2574" href="StructuredContracts.html#2574" class="InductiveConstructor">PropogatesNFT</a> <a id="2588" class="Symbol">:</a>
    <a id="2594" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="2596" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="2600" class="Symbol">(λ</a> <a id="2603" href="StructuredContracts.html#2603" class="Bound">P</a> <a id="2605" class="Symbol">→</a> <a id="2607" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2609" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2611" href="StructuredContracts.html#2603" class="Bound">P</a> <a id="2613" href="StructuredContracts.html#2272" class="Generalizable">sms</a> <a id="2617" href="StructuredContracts.html#2289" class="Generalizable">smi</a><a id="2620" class="Symbol">)</a> <a id="2622" class="Symbol">(</a><a id="2623" href="StructuredContracts.html#2152" class="Postulate">buildConstraints</a> <a id="2640" href="StructuredContracts.html#812" class="Generalizable">txInfo</a><a id="2646" class="Symbol">)</a>
    <a id="2652" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2654" href="StructuredContracts.html#2121" class="Postulate">PropagatesNFT</a> <a id="2668" href="StructuredContracts.html#812" class="Generalizable">txInfo</a>
    <a id="2679" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2681" href="StructuredContracts.html#812" class="Generalizable">txInfo</a> <a id="2688" href="StructuredContracts.html#2206" class="Postulate Operator">⊢</a> <a id="2690" class="Symbol">(</a><a id="2691" href="StructuredContracts.html#2272" class="Generalizable">sms</a> <a id="2695" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2697" href="StructuredContracts.html#2301" class="Generalizable">val</a><a id="2700" class="Symbol">)</a> <a id="2702" href="StructuredContracts.html#2206" class="Postulate Operator">—⟨</a> <a id="2705" href="StructuredContracts.html#2289" class="Generalizable">smi</a> <a id="2709" href="StructuredContracts.html#2206" class="Postulate Operator">∣SMPEC⟩→</a> <a id="2718" class="Symbol">(</a><a id="2719" href="StructuredContracts.html#2276" class="Generalizable">sms′</a> <a id="2724" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2726" href="StructuredContracts.html#2305" class="Generalizable">val′</a><a id="2730" class="Symbol">)</a>
      <a id="2738" href="Prelude.InferenceRules.html#12900" class="Function Operator">──────────────────────────────────────────────────</a>
      <a id="2795" href="StructuredContracts.html#812" class="Generalizable">txInfo</a> <a id="2802" href="StructuredContracts.html#2324" class="Datatype Operator">⊢</a> <a id="2804" class="Symbol">(</a><a id="2805" href="StructuredContracts.html#2272" class="Generalizable">sms</a> <a id="2809" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2811" href="StructuredContracts.html#2301" class="Generalizable">val</a><a id="2814" class="Symbol">)</a> <a id="2816" href="StructuredContracts.html#2324" class="Datatype Operator">—⟨</a> <a id="2819" href="StructuredContracts.html#2289" class="Generalizable">smi</a> <a id="2823" href="StructuredContracts.html#2324" class="Datatype Operator">∣NFTCE⟩→</a> <a id="2832" class="Symbol">(</a><a id="2833" href="StructuredContracts.html#2276" class="Generalizable">sms′</a> <a id="2838" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2840" href="StructuredContracts.html#2305" class="Generalizable">val′</a><a id="2844" class="Symbol">)</a>

<a id="2847" class="Keyword">postulate</a> <a id="LEDGER-simulates-NFTCE"></a><a id="2857" href="StructuredContracts.html#2857" class="Postulate">LEDGER-simulates-NFTCE</a> <a id="2880" class="Symbol">:</a> <a id="2882" href="StructuredContracts.html#1635" class="Function">IsSimulation</a> <a id="2895" href="StructuredContracts.html#2324" class="Datatype Operator">_⊢_—⟨_∣NFTCE⟩→_</a>

<a id="2912" class="Comment">-- ** Account simulation</a>

<a id="2938" class="Keyword">data</a> <a id="IType"></a><a id="2943" href="StructuredContracts.html#2943" class="Datatype">IType</a> <a id="2949" class="Symbol">:</a> <a id="2951" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="2956" class="Keyword">where</a>
  <a id="IType.OArgs"></a><a id="2964" href="StructuredContracts.html#2964" class="InductiveConstructor">OArgs</a> <a id="IType.CArgs"></a><a id="2970" href="StructuredContracts.html#2970" class="InductiveConstructor">CArgs</a> <a id="2976" class="Symbol">:</a> <a id="2978" href="StructuredContracts.html#2943" class="Datatype">IType</a>
<a id="2984" class="Keyword">unquoteDecl</a> <a id="Derive-IType"></a><a id="2996" href="StructuredContracts.html#2996" class="Function">Derive-IType</a> <a id="3009" class="Symbol">=</a> <a id="3011" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="3018" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3024" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3026" class="Keyword">quote</a> <a id="3032" href="StructuredContracts.html#2943" class="Datatype">IType</a> <a id="3038" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3040" href="StructuredContracts.html#2996" class="Function">Derive-IType</a> <a id="3053" href="Data.List.Base.html#5025" class="Function Operator">]</a>
<a id="3055" class="Keyword">postulate</a>
  <a id="Id"></a><a id="3067" href="StructuredContracts.html#3067" class="Postulate">Id</a> <a id="Key"></a><a id="3070" href="StructuredContracts.html#3070" class="Postulate">Key</a> <a id="3074" class="Symbol">:</a> <a id="3076" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="3083" class="Keyword">instance</a> <a id="3092" href="StructuredContracts.html#3092" class="Postulate">_</a> <a id="3094" class="Symbol">:</a> <a id="3096" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3102" href="StructuredContracts.html#3067" class="Postulate">Id</a>
           <a id="3116" href="StructuredContracts.html#3116" class="Postulate">_</a> <a id="3118" class="Symbol">:</a> <a id="3120" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3126" href="StructuredContracts.html#3070" class="Postulate">Key</a>
           <a id="3141" href="StructuredContracts.html#3141" class="Postulate">_</a> <a id="3143" class="Symbol">:</a> <a id="3145" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3151" href="StructuredContracts.html#1982" class="Postulate">Value</a>
<a id="3157" class="Keyword">record</a> <a id="AccI"></a><a id="3164" href="StructuredContracts.html#3164" class="Record">AccI</a> <a id="3169" class="Symbol">:</a> <a id="3171" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3176" class="Keyword">where</a>
  <a id="3184" class="Keyword">field</a> <a id="AccI.id"></a><a id="3190" href="StructuredContracts.html#3190" class="Field">id</a> <a id="3193" class="Symbol">:</a> <a id="3195" href="StructuredContracts.html#3067" class="Postulate">Id</a>
        <a id="AccI.pk"></a><a id="3206" href="StructuredContracts.html#3206" class="Field">pk</a> <a id="3209" class="Symbol">:</a> <a id="3211" href="StructuredContracts.html#3070" class="Postulate">Key</a>
<a id="3215" class="Keyword">open</a> <a id="3220" href="StructuredContracts.html#3164" class="Module">AccI</a>
<a id="3225" class="Keyword">record</a> <a id="Account"></a><a id="3232" href="StructuredContracts.html#3232" class="Record">Account</a> <a id="3240" class="Symbol">:</a> <a id="3242" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3247" class="Keyword">where</a>
  <a id="3255" class="Keyword">field</a> <a id="Account.id"></a><a id="3261" href="StructuredContracts.html#3261" class="Field">id</a> <a id="3264" class="Symbol">:</a> <a id="3266" href="StructuredContracts.html#3067" class="Postulate">Id</a>
        <a id="Account.value"></a><a id="3277" href="StructuredContracts.html#3277" class="Field">value</a> <a id="3283" class="Symbol">:</a> <a id="3285" href="StructuredContracts.html#1982" class="Postulate">Value</a>
        <a id="Account.pk"></a><a id="3299" href="StructuredContracts.html#3299" class="Field">pk</a> <a id="3302" class="Symbol">:</a> <a id="3304" href="StructuredContracts.html#3070" class="Postulate">Key</a>
<a id="3308" class="Keyword">open</a> <a id="3313" href="StructuredContracts.html#3232" class="Module">Account</a>
<a id="3321" class="Keyword">unquoteDecl</a> <a id="Derive-Account"></a><a id="3333" href="StructuredContracts.html#3333" class="Function">Derive-Account</a> <a id="3348" class="Symbol">=</a> <a id="3350" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="3357" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="3363" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3365" class="Keyword">quote</a> <a id="3371" href="StructuredContracts.html#3232" class="Record">Account</a> <a id="3379" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3381" href="StructuredContracts.html#3333" class="Function">Derive-Account</a> <a id="3396" href="Data.List.Base.html#5025" class="Function Operator">]</a>
<a id="3398" class="Keyword">postulate</a>
  <a id="3410" class="Keyword">instance</a> <a id="3419" href="StructuredContracts.html#3419" class="Postulate">_</a> <a id="3421" class="Symbol">:</a> <a id="3423" href="Prelude.Monoid.html#116" class="Record">Monoid</a> <a id="3430" href="StructuredContracts.html#3164" class="Record">AccI</a>
  <a id="txInfoSignatories"></a><a id="3437" href="StructuredContracts.html#3437" class="Postulate">txInfoSignatories</a> <a id="3455" class="Symbol">:</a> <a id="3457" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="3464" class="Symbol">→</a> <a id="3466" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3471" href="StructuredContracts.html#3070" class="Postulate">Key</a>
  <a id="itype"></a><a id="3477" href="StructuredContracts.html#3477" class="Postulate">itype</a> <a id="3483" class="Symbol">:</a> <a id="3485" href="StructuredContracts.html#3164" class="Record">AccI</a> <a id="3490" class="Symbol">→</a> <a id="3492" href="StructuredContracts.html#2943" class="Datatype">IType</a>
<a id="3498" class="Keyword">variable</a>
  <a id="3509" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="3515" class="Symbol">:</a> <a id="3517" href="StructuredContracts.html#3164" class="Record">AccI</a>
  <a id="3524" href="StructuredContracts.html#3524" class="Generalizable">accts</a> <a id="3530" class="Symbol">:</a> <a id="3532" href="Prelude.Maps.AsSets.html#523" class="Record">Map⟨</a> <a id="3537" href="StructuredContracts.html#3067" class="Postulate">Id</a> <a id="3540" href="Prelude.Maps.AsSets.html#523" class="Record">↦</a> <a id="3542" href="StructuredContracts.html#3232" class="Record">Account</a> <a id="3550" href="Prelude.Maps.AsSets.html#523" class="Record">⟩</a>
  <a id="3554" href="StructuredContracts.html#3554" class="Generalizable">newAcct</a> <a id="3562" href="StructuredContracts.html#3562" class="Generalizable">acntToClose</a> <a id="3574" class="Symbol">:</a> <a id="3576" href="StructuredContracts.html#3232" class="Record">Account</a>

<a id="3585" class="Keyword">data</a> <a id="_⊢_—⟨_∣ACCNT⟩→_"></a><a id="3590" href="StructuredContracts.html#3590" class="Datatype Operator">_⊢_—⟨_∣ACCNT⟩→_</a> <a id="3606" class="Symbol">:</a> <a id="3608" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="3614" class="Symbol">(</a><a id="3615" href="StructuredContracts.html#732" class="Postulate">TxInfo</a> <a id="3622" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3624" href="Prelude.Maps.AsSets.html#523" class="Record">Map⟨</a> <a id="3629" href="StructuredContracts.html#3067" class="Postulate">Id</a> <a id="3632" href="Prelude.Maps.AsSets.html#523" class="Record">↦</a> <a id="3634" href="StructuredContracts.html#3232" class="Record">Account</a> <a id="3642" href="Prelude.Maps.AsSets.html#523" class="Record">⟩</a> <a id="3644" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3646" href="StructuredContracts.html#3164" class="Record">AccI</a><a id="3650" class="Symbol">)</a> <a id="3652" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣ACCNT⟩→_.Open"></a><a id="3661" href="StructuredContracts.html#3661" class="InductiveConstructor">Open</a> <a id="3666" class="Symbol">:</a>

    <a id="3673" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="3675" href="StructuredContracts.html#3477" class="Postulate">itype</a> <a id="3681" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="3687" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3689" href="StructuredContracts.html#2964" class="InductiveConstructor">OArgs</a>
    <a id="3699" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3701" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="3707" class="Symbol">.</a><a id="3708" href="StructuredContracts.html#3206" class="Field">pk</a> <a id="3711" href="Prelude.Membership.html#400" class="Field Operator">∈</a> <a id="3713" href="StructuredContracts.html#3437" class="Postulate">txInfoSignatories</a> <a id="3731" href="StructuredContracts.html#812" class="Generalizable">txInfo</a>
    <a id="3742" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3744" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="3750" class="Symbol">.</a><a id="3751" href="StructuredContracts.html#3190" class="Field">id</a> <a id="3754" href="Prelude.Maps.AsSets.html#1663" class="Function Operator">∉ᵈ</a> <a id="3757" href="StructuredContracts.html#3524" class="Generalizable">accts</a>
    <a id="3767" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3769" href="StructuredContracts.html#3554" class="Generalizable">newAcct</a> <a id="3777" class="Symbol">.</a><a id="3778" href="StructuredContracts.html#3299" class="Field">pk</a> <a id="3781" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3783" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="3789" class="Symbol">.</a><a id="3790" href="StructuredContracts.html#3206" class="Field">pk</a>
    <a id="3797" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3799" href="StructuredContracts.html#3554" class="Generalizable">newAcct</a> <a id="3807" class="Symbol">.</a><a id="3808" href="StructuredContracts.html#3277" class="Field">value</a> <a id="3814" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3816" href="Prelude.Monoid.html#196" class="Field">ε</a>
      <a id="3824" href="Prelude.InferenceRules.html#11812" class="Function Operator">───────────────────────────────────────────────────────────────────</a>
      <a id="3898" href="StructuredContracts.html#812" class="Generalizable">txInfo</a> <a id="3905" href="StructuredContracts.html#3590" class="Datatype Operator">⊢</a> <a id="3907" href="StructuredContracts.html#3524" class="Generalizable">accts</a> <a id="3913" href="StructuredContracts.html#3590" class="Datatype Operator">—⟨</a> <a id="3916" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="3922" href="StructuredContracts.html#3590" class="Datatype Operator">∣ACCNT⟩→</a> <a id="3931" class="Symbol">(</a><a id="3932" href="StructuredContracts.html#3524" class="Generalizable">accts</a> <a id="3938" href="Prelude.Maps.AsSets.html#1442" class="Function Operator">∪</a> <a id="3940" href="Prelude.Maps.AsSets.html#917" class="Function">singleton</a> <a id="3950" class="Symbol">(</a><a id="3951" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="3957" class="Symbol">.</a><a id="3958" href="StructuredContracts.html#3190" class="Field">id</a> <a id="3961" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3963" href="StructuredContracts.html#3554" class="Generalizable">newAcct</a><a id="3970" class="Symbol">))</a>

  <a id="_⊢_—⟨_∣ACCNT⟩→_.Close"></a><a id="3976" href="StructuredContracts.html#3976" class="InductiveConstructor">Close</a> <a id="3982" class="Symbol">:</a>

    <a id="3989" class="Comment">-- ∙ itype accIn ≡ CArgs</a>
    <a id="4018" class="Comment">-- ∙ accts [ accIn .id ↦ acntToClose ]</a>
    <a id="4061" class="Comment">-- ∙ accIn .pk ∈ txInfoSignatories txInfo</a>
    <a id="4107" class="Comment">-- ∙ acntToClose .value ≡ ε</a>
      <a id="4141" href="Prelude.InferenceRules.html#43055" class="Function Operator">───────────────────────────────────────────────────</a>
      <a id="4199" href="StructuredContracts.html#812" class="Generalizable">txInfo</a> <a id="4206" href="StructuredContracts.html#3590" class="Datatype Operator">⊢</a> <a id="4208" href="StructuredContracts.html#3524" class="Generalizable">accts</a> <a id="4214" href="StructuredContracts.html#3590" class="Datatype Operator">—⟨</a> <a id="4217" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="4223" href="StructuredContracts.html#3590" class="Datatype Operator">∣ACCNT⟩→</a> <a id="4232" class="Symbol">(</a><a id="4233" href="StructuredContracts.html#3509" class="Generalizable">accIn</a> <a id="4239" class="Symbol">.</a><a id="4240" href="StructuredContracts.html#3190" class="Field">id</a> <a id="4243" href="Prelude.Maps.AsSets.html#3422" class="Function Operator">⋪</a> <a id="4245" href="StructuredContracts.html#3524" class="Generalizable">accts</a><a id="4250" class="Symbol">)</a>

<a id="4253" class="Keyword">postulate</a> <a id="LEDGER-simulates-ACCNT"></a><a id="4263" href="StructuredContracts.html#4263" class="Postulate">LEDGER-simulates-ACCNT</a> <a id="4286" class="Symbol">:</a> <a id="4288" href="StructuredContracts.html#1635" class="Function">IsSimulation</a> <a id="4301" href="StructuredContracts.html#3590" class="Datatype Operator">_⊢_—⟨_∣ACCNT⟩→_</a>
</pre></body></html>