<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StructuredContracts</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/structured-contracts/tree/master/StructuredContracts.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="26" class="Keyword">hiding</a> <a id="33" class="Symbol">(</a><a id="34" href="Function.Base.html#624" class="Function">id</a><a id="36" class="Symbol">);</a> <a id="39" class="Keyword">open</a> <a id="44" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="89" class="Keyword">open</a> <a id="94" class="Keyword">import</a> <a id="101" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="Prelude.Maps.html" class="Module">Prelude.Maps</a>

<a id="229" class="Comment">-- small-step relations</a>
<a id="SSRel"></a><a id="253" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="259" class="Symbol">:</a> <a id="261" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="266" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="268" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="273" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="275" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="280" class="Symbol">→</a> <a id="282" href="Agda.Primitive.html#320" class="Primitive">Type₁</a>
<a id="288" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="294" class="Symbol">(</a><a id="295" href="StructuredContracts.html#295" class="Bound">Env</a> <a id="299" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="301" href="StructuredContracts.html#301" class="Bound">State</a> <a id="307" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="309" href="StructuredContracts.html#309" class="Bound">Input</a><a id="314" class="Symbol">)</a> <a id="316" class="Symbol">=</a> <a id="318" href="StructuredContracts.html#295" class="Bound">Env</a> <a id="322" class="Symbol">→</a> <a id="324" href="StructuredContracts.html#301" class="Bound">State</a> <a id="330" class="Symbol">→</a> <a id="332" href="StructuredContracts.html#309" class="Bound">Input</a> <a id="338" class="Symbol">→</a> <a id="340" href="StructuredContracts.html#301" class="Bound">State</a> <a id="346" class="Symbol">→</a> <a id="348" href="Agda.Primitive.html#320" class="Primitive">Type</a>

<a id="354" class="Comment">-- ** Ledger</a>

<a id="368" class="Keyword">postulate</a>
  <a id="LEnv"></a><a id="380" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="LState"></a><a id="385" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="Tx"></a><a id="392" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="395" class="Symbol">:</a> <a id="397" href="Agda.Primitive.html#320" class="Primitive">Type</a>
  <a id="_⊢_—⟨_∣UTXOW⟩→_"></a><a id="404" href="StructuredContracts.html#404" class="Postulate Operator">_⊢_—⟨_∣UTXOW⟩→_</a> <a id="420" class="Symbol">:</a> <a id="422" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="428" class="Symbol">(</a><a id="429" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="434" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="436" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="443" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="445" href="StructuredContracts.html#392" class="Postulate">Tx</a><a id="447" class="Symbol">)</a>

<a id="450" class="Keyword">variable</a>
  <a id="461" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="465" class="Symbol">:</a> <a id="467" href="StructuredContracts.html#380" class="Postulate">LEnv</a>
  <a id="474" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="481" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a> <a id="489" class="Symbol">:</a> <a id="491" href="StructuredContracts.html#385" class="Postulate">LState</a>
  <a id="500" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="503" class="Symbol">:</a> <a id="505" href="StructuredContracts.html#392" class="Postulate">Tx</a>

<a id="509" class="Keyword">data</a> <a id="_⊢_—⟨_∣LEDGER⟩→_"></a><a id="514" href="StructuredContracts.html#514" class="Datatype Operator">_⊢_—⟨_∣LEDGER⟩→_</a> <a id="531" class="Symbol">:</a> <a id="533" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="539" class="Symbol">(</a><a id="540" href="StructuredContracts.html#380" class="Postulate">LEnv</a> <a id="545" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="547" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="554" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="556" href="StructuredContracts.html#392" class="Postulate">Tx</a><a id="558" class="Symbol">)</a> <a id="560" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣LEDGER⟩→_.ledger-V"></a><a id="569" href="StructuredContracts.html#569" class="InductiveConstructor">ledger-V</a> <a id="578" class="Symbol">:</a>
    <a id="584" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="588" href="StructuredContracts.html#404" class="Postulate Operator">⊢</a> <a id="590" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="597" href="StructuredContracts.html#404" class="Postulate Operator">—⟨</a> <a id="600" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="603" href="StructuredContracts.html#404" class="Postulate Operator">∣UTXOW⟩→</a> <a id="612" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
    <a id="624" href="Prelude.InferenceRules.html#13602" class="Function Operator">────────────────────────────────────</a>
    <a id="665" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="669" href="StructuredContracts.html#514" class="Datatype Operator">⊢</a> <a id="671" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="678" href="StructuredContracts.html#514" class="Datatype Operator">—⟨</a> <a id="681" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="684" href="StructuredContracts.html#514" class="Datatype Operator">∣LEDGER⟩→</a> <a id="694" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>

<a id="703" class="Comment">-- ** Simulation</a>

<a id="721" class="Keyword">postulate</a>
  <a id="TxInfo"></a><a id="733" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="740" class="Symbol">:</a> <a id="742" href="Agda.Primitive.html#320" class="Primitive">Type</a>
  <a id="getUTxO"></a><a id="749" href="StructuredContracts.html#749" class="Postulate">getUTxO</a> <a id="757" class="Symbol">:</a> <a id="759" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="766" class="Symbol">→</a> <a id="768" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="771" class="Symbol">→</a> <a id="773" href="StructuredContracts.html#733" class="Postulate">TxInfo</a>
  <a id="isValid"></a><a id="782" href="StructuredContracts.html#782" class="Postulate">isValid</a> <a id="790" class="Symbol">:</a> <a id="792" href="StructuredContracts.html#392" class="Postulate">Tx</a> <a id="795" class="Symbol">→</a> <a id="797" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>

<a id="803" class="Keyword">variable</a>
  <a id="814" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="821" class="Symbol">:</a> <a id="823" href="StructuredContracts.html#733" class="Postulate">TxInfo</a>

<a id="831" class="Keyword">module</a> <a id="Simulation"></a><a id="838" href="StructuredContracts.html#838" class="Module">Simulation</a>
  <a id="851" class="Symbol">{</a><a id="852" href="StructuredContracts.html#852" class="Bound">State</a> <a id="858" href="StructuredContracts.html#858" class="Bound">Input</a> <a id="864" class="Symbol">:</a> <a id="866" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="870" class="Symbol">}</a>
  <a id="874" class="Symbol">⦃</a> <a id="876" href="StructuredContracts.html#876" class="Bound">_</a> <a id="878" class="Symbol">:</a> <a id="880" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="890" href="StructuredContracts.html#858" class="Bound">Input</a> <a id="896" class="Symbol">⦄</a>
  <a id="900" class="Symbol">⦃</a> <a id="902" href="StructuredContracts.html#902" class="Bound">_</a> <a id="904" class="Symbol">:</a> <a id="906" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="913" href="StructuredContracts.html#858" class="Bound">Input</a> <a id="919" class="Symbol">⦄</a>
  <a id="923" class="Symbol">(</a><a id="924" href="StructuredContracts.html#924" class="Bound">πˢ</a> <a id="927" class="Symbol">:</a> <a id="929" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="936" class="Symbol">→</a> <a id="938" href="StructuredContracts.html#852" class="Bound">State</a><a id="943" class="Symbol">)</a>
  <a id="947" class="Symbol">(</a><a id="948" href="StructuredContracts.html#948" class="Bound">πⁱ</a> <a id="951" class="Symbol">:</a> <a id="953" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="960" class="Symbol">→</a> <a id="962" href="StructuredContracts.html#858" class="Bound">Input</a><a id="967" class="Symbol">)</a>
  <a id="971" class="Symbol">(</a><a id="972" href="StructuredContracts.html#972" class="Bound Operator">_⊢_—⟨_∣SMUP⟩→_</a> <a id="987" class="Symbol">:</a> <a id="989" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="995" class="Symbol">(</a><a id="996" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="1003" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1005" href="StructuredContracts.html#852" class="Bound">State</a> <a id="1011" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1013" href="StructuredContracts.html#858" class="Bound">Input</a><a id="1018" class="Symbol">))</a>
  <a id="1023" class="Keyword">where</a>

  <a id="1032" class="Keyword">data</a> <a id="Simulation.StatefulStep"></a><a id="1037" href="StructuredContracts.html#1037" class="Datatype">StatefulStep</a> <a id="1050" class="Symbol">:</a> <a id="1052" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1057" class="Keyword">where</a>
    <a id="Simulation.StatefulStep.STEP"></a><a id="1067" href="StructuredContracts.html#1067" class="InductiveConstructor">STEP</a> <a id="1072" class="Symbol">:</a>
      <a id="1080" class="Symbol">(</a><a id="1081" class="Keyword">let</a> <a id="1085" href="StructuredContracts.html#1085" class="Bound">txInfo</a> <a id="1092" class="Symbol">=</a> <a id="1094" href="StructuredContracts.html#749" class="Postulate">getUTxO</a> <a id="1102" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1109" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1112" class="Keyword">in</a>
      <a id="1121" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="1123" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="1125" class="Symbol">(</a><a id="1126" href="StructuredContracts.html#782" class="Postulate">isValid</a> <a id="1134" href="StructuredContracts.html#500" class="Generalizable">tx</a><a id="1136" class="Symbol">)</a>
      <a id="1144" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="1146" href="StructuredContracts.html#948" class="Bound">πⁱ</a> <a id="1149" href="StructuredContracts.html#1085" class="Bound">txInfo</a> <a id="1156" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1158" href="Prelude.Monoid.html#222" class="Field">ε</a>
      <a id="1166" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="1168" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="1172" href="StructuredContracts.html#514" class="Datatype Operator">⊢</a> <a id="1174" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1181" href="StructuredContracts.html#514" class="Datatype Operator">—⟨</a> <a id="1184" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1187" href="StructuredContracts.html#514" class="Datatype Operator">∣LEDGER⟩→</a> <a id="1197" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
        <a id="1213" href="Prelude.InferenceRules.html#12867" class="Function Operator">───────────────────────────────────────────────────</a>
        <a id="1273" href="StructuredContracts.html#1085" class="Bound">txInfo</a> <a id="1280" href="StructuredContracts.html#972" class="Bound Operator">⊢</a> <a id="1282" href="StructuredContracts.html#924" class="Bound">πˢ</a> <a id="1285" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1292" href="StructuredContracts.html#972" class="Bound Operator">—⟨</a> <a id="1295" href="StructuredContracts.html#948" class="Bound">πⁱ</a> <a id="1298" href="StructuredContracts.html#1085" class="Bound">txInfo</a> <a id="1305" href="StructuredContracts.html#972" class="Bound Operator">∣SMUP⟩→</a> <a id="1313" href="StructuredContracts.html#924" class="Bound">πˢ</a> <a id="1316" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a><a id="1323" class="Symbol">)</a>
      <a id="1331" href="Prelude.InferenceRules.html#14310" class="Function Operator">────────────</a>
      <a id="1350" href="StructuredContracts.html#1037" class="Datatype">StatefulStep</a>

  <a id="1366" class="Keyword">data</a> <a id="Simulation.StatefulNoStep"></a><a id="1371" href="StructuredContracts.html#1371" class="Datatype">StatefulNoStep</a> <a id="1386" class="Symbol">:</a> <a id="1388" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1393" class="Keyword">where</a>
    <a id="Simulation.StatefulNoStep.NO-STEP"></a><a id="1403" href="StructuredContracts.html#1403" class="InductiveConstructor">NO-STEP</a> <a id="1411" class="Symbol">:</a>
      <a id="1419" class="Symbol">(</a><a id="1420" class="Keyword">let</a> <a id="1424" href="StructuredContracts.html#1424" class="Bound">txInfo</a> <a id="1431" class="Symbol">=</a> <a id="1433" href="StructuredContracts.html#749" class="Postulate">getUTxO</a> <a id="1441" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1448" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1451" class="Keyword">in</a>
      <a id="1460" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="1462" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="1464" class="Symbol">(</a><a id="1465" href="StructuredContracts.html#782" class="Postulate">isValid</a> <a id="1473" href="StructuredContracts.html#500" class="Generalizable">tx</a><a id="1475" class="Symbol">)</a>
      <a id="1483" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="1485" href="StructuredContracts.html#948" class="Bound">πⁱ</a> <a id="1488" href="StructuredContracts.html#1424" class="Bound">txInfo</a> <a id="1495" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1497" href="Prelude.Monoid.html#222" class="Field">ε</a>
      <a id="1505" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="1507" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="1511" href="StructuredContracts.html#514" class="Datatype Operator">⊢</a> <a id="1513" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1520" href="StructuredContracts.html#514" class="Datatype Operator">—⟨</a> <a id="1523" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="1526" href="StructuredContracts.html#514" class="Datatype Operator">∣LEDGER⟩→</a> <a id="1536" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
        <a id="1552" href="Prelude.InferenceRules.html#13602" class="Function Operator">────────────────────────────────────</a>
        <a id="1597" href="StructuredContracts.html#924" class="Bound">πˢ</a> <a id="1600" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="1607" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1609" href="StructuredContracts.html#924" class="Bound">πˢ</a> <a id="1612" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a><a id="1619" class="Symbol">)</a>
      <a id="1627" href="Prelude.InferenceRules.html#14273" class="Function Operator">──────────────</a>
      <a id="1648" href="StructuredContracts.html#1371" class="Datatype">StatefulNoStep</a>

<a id="IsSimulation"></a><a id="1664" href="StructuredContracts.html#1664" class="Function">IsSimulation</a> <a id="1677" class="Symbol">:</a> <a id="1679" class="Symbol">∀</a> <a id="1681" class="Symbol">{</a><a id="1682" href="StructuredContracts.html#1682" class="Bound">S</a> <a id="1684" href="StructuredContracts.html#1684" class="Bound">I</a> <a id="1686" class="Symbol">:</a> <a id="1688" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="1692" class="Symbol">}</a> <a id="1694" class="Symbol">⦃</a> <a id="1696" href="StructuredContracts.html#1696" class="Bound">_</a> <a id="1698" class="Symbol">:</a> <a id="1700" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="1710" href="StructuredContracts.html#1684" class="Bound">I</a> <a id="1712" class="Symbol">⦄</a> <a id="1714" class="Symbol">→</a> <a id="1716" class="Symbol">⦃</a> <a id="1718" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="1725" href="StructuredContracts.html#1684" class="Bound">I</a> <a id="1727" class="Symbol">⦄</a> <a id="1729" class="Symbol">→</a> <a id="1731" href="Prelude.Init.html#13332" class="Function">Pred₀</a> <a id="1737" class="Symbol">(</a><a id="1738" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="1744" class="Symbol">(</a><a id="1745" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="1752" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1754" href="StructuredContracts.html#1682" class="Bound">S</a> <a id="1756" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1758" href="StructuredContracts.html#1684" class="Bound">I</a><a id="1759" class="Symbol">))</a>
<a id="1762" href="StructuredContracts.html#1664" class="Function">IsSimulation</a> <a id="1775" class="Symbol">{</a><a id="1776" href="StructuredContracts.html#1776" class="Bound">S</a><a id="1777" class="Symbol">}{</a><a id="1779" href="StructuredContracts.html#1779" class="Bound">I</a><a id="1780" class="Symbol">}</a> <a id="1782" href="StructuredContracts.html#1782" class="Bound">ssRel</a> <a id="1788" class="Symbol">=</a>
  <a id="1792" href="Data.Product.html#1378" class="Function">∃</a> <a id="1794" class="Symbol">λ</a> <a id="1796" class="Symbol">(</a><a id="1797" href="StructuredContracts.html#1797" class="Bound">πˢ</a> <a id="1800" class="Symbol">:</a> <a id="1802" href="StructuredContracts.html#385" class="Postulate">LState</a> <a id="1809" class="Symbol">→</a> <a id="1811" href="StructuredContracts.html#1776" class="Bound">S</a><a id="1812" class="Symbol">)</a> <a id="1814" class="Symbol">→</a> <a id="1816" href="Data.Product.html#1378" class="Function">∃</a> <a id="1818" class="Symbol">λ</a> <a id="1820" class="Symbol">(</a><a id="1821" href="StructuredContracts.html#1821" class="Bound">πⁱ</a> <a id="1824" class="Symbol">:</a> <a id="1826" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="1833" class="Symbol">→</a> <a id="1835" href="StructuredContracts.html#1779" class="Bound">I</a><a id="1836" class="Symbol">)</a> <a id="1838" class="Symbol">→</a>
  <a id="1842" class="Keyword">let</a> <a id="1846" class="Keyword">open</a> <a id="1851" href="StructuredContracts.html#838" class="Module">Simulation</a> <a id="1862" href="StructuredContracts.html#1797" class="Bound">πˢ</a> <a id="1865" href="StructuredContracts.html#1821" class="Bound">πⁱ</a> <a id="1868" href="StructuredContracts.html#1782" class="Bound">ssRel</a> <a id="1874" class="Keyword">in</a>
    <a id="1881" href="Prelude.Init.html#1736" class="Function">Surjective≡</a> <a id="1893" class="Symbol">{</a><a id="1894" class="Argument">A</a> <a id="1896" class="Symbol">=</a> <a id="1898" href="StructuredContracts.html#385" class="Postulate">LState</a><a id="1904" class="Symbol">}</a> <a id="1906" href="StructuredContracts.html#1797" class="Bound">πˢ</a>
  <a id="1911" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1913" href="Prelude.Init.html#1736" class="Function">Surjective≡</a> <a id="1925" class="Symbol">{</a><a id="1926" class="Argument">A</a> <a id="1928" class="Symbol">=</a> <a id="1930" href="StructuredContracts.html#733" class="Postulate">TxInfo</a><a id="1936" class="Symbol">}</a> <a id="1938" href="StructuredContracts.html#1821" class="Bound">πⁱ</a>
  <a id="1943" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1945" href="StructuredContracts.html#1037" class="Datatype">StatefulStep</a>
  <a id="1960" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1962" href="StructuredContracts.html#1371" class="Datatype">StatefulNoStep</a>

<a id="1978" class="Comment">-- ** NFT state machine library</a>

<a id="2011" class="Keyword">postulate</a>
  <a id="SMS"></a><a id="2023" href="StructuredContracts.html#2023" class="Postulate">SMS</a> <a id="SMI"></a><a id="2027" href="StructuredContracts.html#2027" class="Postulate">SMI</a> <a id="Value"></a><a id="2031" href="StructuredContracts.html#2031" class="Postulate">Value</a> <a id="2037" class="Symbol">:</a> <a id="2039" href="Agda.Primitive.html#320" class="Primitive">Type</a>
  <a id="2046" class="Keyword">instance</a> <a id="2055" href="StructuredContracts.html#2055" class="Postulate">_</a> <a id="2057" class="Symbol">:</a> <a id="2059" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="2069" href="StructuredContracts.html#2023" class="Postulate">SMS</a><a id="2072" class="Symbol">;</a> <a id="2074" href="StructuredContracts.html#2074" class="Postulate">_</a> <a id="2076" class="Symbol">:</a> <a id="2078" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="2085" href="StructuredContracts.html#2023" class="Postulate">SMS</a>
           <a id="2100" href="StructuredContracts.html#2100" class="Postulate">_</a> <a id="2102" class="Symbol">:</a> <a id="2104" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="2114" href="StructuredContracts.html#2031" class="Postulate">Value</a><a id="2119" class="Symbol">;</a> <a id="2121" href="StructuredContracts.html#2121" class="Postulate">_</a> <a id="2123" class="Symbol">:</a> <a id="2125" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="2132" href="StructuredContracts.html#2031" class="Postulate">Value</a>
           <a id="2149" href="StructuredContracts.html#2149" class="Postulate">_</a> <a id="2151" class="Symbol">:</a> <a id="2153" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="2163" href="StructuredContracts.html#2027" class="Postulate">SMI</a><a id="2166" class="Symbol">;</a> <a id="2168" href="StructuredContracts.html#2168" class="Postulate">_</a> <a id="2170" class="Symbol">:</a> <a id="2172" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="2179" href="StructuredContracts.html#2027" class="Postulate">SMI</a>
  <a id="initState"></a><a id="2185" href="StructuredContracts.html#2185" class="Postulate">initState</a> <a id="2195" class="Symbol">:</a> <a id="2197" href="StructuredContracts.html#2023" class="Postulate">SMS</a> <a id="2201" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2203" href="StructuredContracts.html#2031" class="Postulate">Value</a>
  <a id="SpendsNFT"></a><a id="2211" href="StructuredContracts.html#2211" class="Postulate">SpendsNFT</a> <a id="PutsNFT"></a><a id="2221" href="StructuredContracts.html#2221" class="Postulate">PutsNFT</a> <a id="PropagatesNFT"></a><a id="2229" href="StructuredContracts.html#2229" class="Postulate">PropagatesNFT</a> <a id="2243" class="Symbol">:</a> <a id="2245" href="Prelude.Init.html#13332" class="Function">Pred₀</a> <a id="2251" href="StructuredContracts.html#733" class="Postulate">TxInfo</a>
  <a id="buildConstraints"></a><a id="2260" href="StructuredContracts.html#2260" class="Postulate">buildConstraints</a> <a id="2277" class="Symbol">:</a> <a id="2279" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="2286" class="Symbol">→</a> <a id="2288" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2293" class="Symbol">(</a><a id="2294" href="StructuredContracts.html#2023" class="Postulate">SMS</a> <a id="2298" class="Symbol">→</a> <a id="2300" href="StructuredContracts.html#2027" class="Postulate">SMI</a> <a id="2304" class="Symbol">→</a> <a id="2306" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a><a id="2310" class="Symbol">)</a>
  <a id="_⊢_—⟨_∣SMPEC⟩→_"></a><a id="2314" href="StructuredContracts.html#2314" class="Postulate Operator">_⊢_—⟨_∣SMPEC⟩→_</a> <a id="2330" class="Symbol">:</a> <a id="2332" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="2338" class="Symbol">(</a><a id="2339" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="2346" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2348" class="Symbol">(</a><a id="2349" href="StructuredContracts.html#2023" class="Postulate">SMS</a> <a id="2353" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2355" href="StructuredContracts.html#2031" class="Postulate">Value</a><a id="2360" class="Symbol">)</a> <a id="2362" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2364" href="StructuredContracts.html#2027" class="Postulate">SMI</a><a id="2367" class="Symbol">)</a>

<a id="2370" class="Keyword">variable</a>
  <a id="2381" href="StructuredContracts.html#2381" class="Generalizable">sms</a> <a id="2385" href="StructuredContracts.html#2385" class="Generalizable">sms′</a> <a id="2390" class="Symbol">:</a> <a id="2392" href="StructuredContracts.html#2023" class="Postulate">SMS</a>
  <a id="2398" href="StructuredContracts.html#2398" class="Generalizable">smi</a> <a id="2402" class="Symbol">:</a> <a id="2404" href="StructuredContracts.html#2027" class="Postulate">SMI</a>
  <a id="2410" href="StructuredContracts.html#2410" class="Generalizable">val</a> <a id="2414" href="StructuredContracts.html#2414" class="Generalizable">val′</a> <a id="2419" class="Symbol">:</a> <a id="2421" href="StructuredContracts.html#2031" class="Postulate">Value</a>

<a id="2428" class="Keyword">data</a> <a id="_⊢_—⟨_∣NFTCE⟩→_"></a><a id="2433" href="StructuredContracts.html#2433" class="Datatype Operator">_⊢_—⟨_∣NFTCE⟩→_</a> <a id="2449" class="Symbol">:</a> <a id="2451" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="2457" class="Symbol">(</a><a id="2458" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="2465" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2467" class="Symbol">(</a><a id="2468" href="StructuredContracts.html#2023" class="Postulate">SMS</a> <a id="2472" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2474" href="StructuredContracts.html#2031" class="Postulate">Value</a><a id="2479" class="Symbol">)</a> <a id="2481" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2483" href="StructuredContracts.html#2027" class="Postulate">SMI</a><a id="2486" class="Symbol">)</a> <a id="2488" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣NFTCE⟩→_.MintsNFT"></a><a id="2497" href="StructuredContracts.html#2497" class="InductiveConstructor">MintsNFT</a> <a id="2506" class="Symbol">:</a>
    <a id="2512" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="2514" href="StructuredContracts.html#2211" class="Postulate">SpendsNFT</a> <a id="2524" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="2535" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="2537" href="StructuredContracts.html#2221" class="Postulate">PutsNFT</a> <a id="2545" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="2556" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="2558" href="StructuredContracts.html#461" class="Generalizable">env</a> <a id="2562" href="StructuredContracts.html#404" class="Postulate Operator">⊢</a> <a id="2564" href="StructuredContracts.html#474" class="Generalizable">utxoSt</a> <a id="2571" href="StructuredContracts.html#404" class="Postulate Operator">—⟨</a> <a id="2574" href="StructuredContracts.html#500" class="Generalizable">tx</a> <a id="2577" href="StructuredContracts.html#404" class="Postulate Operator">∣UTXOW⟩→</a> <a id="2586" href="StructuredContracts.html#481" class="Generalizable">utxoSt′</a>
      <a id="2600" href="Prelude.InferenceRules.html#13602" class="Function Operator">────────────────────────────────────</a>
      <a id="2643" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="2650" href="StructuredContracts.html#2433" class="Datatype Operator">⊢</a> <a id="2652" href="Prelude.Monoid.html#222" class="Field">ε</a> <a id="2654" href="StructuredContracts.html#2433" class="Datatype Operator">—⟨</a> <a id="2657" href="StructuredContracts.html#2398" class="Generalizable">smi</a> <a id="2661" href="StructuredContracts.html#2433" class="Datatype Operator">∣NFTCE⟩→</a> <a id="2670" href="StructuredContracts.html#2185" class="Postulate">initState</a>

  <a id="_⊢_—⟨_∣NFTCE⟩→_.PropogatesNFT"></a><a id="2683" href="StructuredContracts.html#2683" class="InductiveConstructor">PropogatesNFT</a> <a id="2697" class="Symbol">:</a>
    <a id="2703" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="2705" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="2709" class="Symbol">(λ</a> <a id="2712" href="StructuredContracts.html#2712" class="Bound">P</a> <a id="2714" class="Symbol">→</a> <a id="2716" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2718" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2720" href="StructuredContracts.html#2712" class="Bound">P</a> <a id="2722" href="StructuredContracts.html#2381" class="Generalizable">sms</a> <a id="2726" href="StructuredContracts.html#2398" class="Generalizable">smi</a><a id="2729" class="Symbol">)</a> <a id="2731" class="Symbol">(</a><a id="2732" href="StructuredContracts.html#2260" class="Postulate">buildConstraints</a> <a id="2749" href="StructuredContracts.html#814" class="Generalizable">txInfo</a><a id="2755" class="Symbol">)</a>
    <a id="2761" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="2763" href="StructuredContracts.html#2229" class="Postulate">PropagatesNFT</a> <a id="2777" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="2788" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="2790" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="2797" href="StructuredContracts.html#2314" class="Postulate Operator">⊢</a> <a id="2799" class="Symbol">(</a><a id="2800" href="StructuredContracts.html#2381" class="Generalizable">sms</a> <a id="2804" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2806" href="StructuredContracts.html#2410" class="Generalizable">val</a><a id="2809" class="Symbol">)</a> <a id="2811" href="StructuredContracts.html#2314" class="Postulate Operator">—⟨</a> <a id="2814" href="StructuredContracts.html#2398" class="Generalizable">smi</a> <a id="2818" href="StructuredContracts.html#2314" class="Postulate Operator">∣SMPEC⟩→</a> <a id="2827" class="Symbol">(</a><a id="2828" href="StructuredContracts.html#2385" class="Generalizable">sms′</a> <a id="2833" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2835" href="StructuredContracts.html#2414" class="Generalizable">val′</a><a id="2839" class="Symbol">)</a>
      <a id="2847" href="Prelude.InferenceRules.html#12923" class="Function Operator">──────────────────────────────────────────────────</a>
      <a id="2904" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="2911" href="StructuredContracts.html#2433" class="Datatype Operator">⊢</a> <a id="2913" class="Symbol">(</a><a id="2914" href="StructuredContracts.html#2381" class="Generalizable">sms</a> <a id="2918" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2920" href="StructuredContracts.html#2410" class="Generalizable">val</a><a id="2923" class="Symbol">)</a> <a id="2925" href="StructuredContracts.html#2433" class="Datatype Operator">—⟨</a> <a id="2928" href="StructuredContracts.html#2398" class="Generalizable">smi</a> <a id="2932" href="StructuredContracts.html#2433" class="Datatype Operator">∣NFTCE⟩→</a> <a id="2941" class="Symbol">(</a><a id="2942" href="StructuredContracts.html#2385" class="Generalizable">sms′</a> <a id="2947" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2949" href="StructuredContracts.html#2414" class="Generalizable">val′</a><a id="2953" class="Symbol">)</a>

<a id="2956" class="Keyword">postulate</a> <a id="LEDGER-simulates-NFTCE"></a><a id="2966" href="StructuredContracts.html#2966" class="Postulate">LEDGER-simulates-NFTCE</a> <a id="2989" class="Symbol">:</a> <a id="2991" href="StructuredContracts.html#1664" class="Function">IsSimulation</a> <a id="3004" href="StructuredContracts.html#2433" class="Datatype Operator">_⊢_—⟨_∣NFTCE⟩→_</a>

<a id="3021" class="Comment">-- ** Account simulation</a>

<a id="3047" class="Keyword">data</a> <a id="IType"></a><a id="3052" href="StructuredContracts.html#3052" class="Datatype">IType</a> <a id="3058" class="Symbol">:</a> <a id="3060" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="3065" class="Keyword">where</a>
  <a id="IType.OArgs"></a><a id="3073" href="StructuredContracts.html#3073" class="InductiveConstructor">OArgs</a> <a id="IType.CArgs"></a><a id="3079" href="StructuredContracts.html#3079" class="InductiveConstructor">CArgs</a> <a id="3085" class="Symbol">:</a> <a id="3087" href="StructuredContracts.html#3052" class="Datatype">IType</a>
<a id="3093" class="Keyword">unquoteDecl</a> <a id="Derive-IType"></a><a id="3105" href="StructuredContracts.html#3105" class="Function">Derive-IType</a> <a id="3118" class="Symbol">=</a> <a id="3120" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="3127" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="3133" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3135" class="Keyword">quote</a> <a id="3141" href="StructuredContracts.html#3052" class="Datatype">IType</a> <a id="3147" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3149" href="StructuredContracts.html#3105" class="Function">Derive-IType</a> <a id="3162" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="3165" class="Keyword">postulate</a>
  <a id="Id"></a><a id="3177" href="StructuredContracts.html#3177" class="Postulate">Id</a> <a id="Key"></a><a id="3180" href="StructuredContracts.html#3180" class="Postulate">Key</a> <a id="3184" class="Symbol">:</a> <a id="3186" href="Agda.Primitive.html#320" class="Primitive">Type</a>
  <a id="3193" class="Keyword">instance</a> <a id="3202" href="StructuredContracts.html#3202" class="Postulate">_</a> <a id="3204" class="Symbol">:</a> <a id="3206" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="3212" href="StructuredContracts.html#3177" class="Postulate">Id</a>
           <a id="3226" href="StructuredContracts.html#3226" class="Postulate">_</a> <a id="3228" class="Symbol">:</a> <a id="3230" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="3236" href="StructuredContracts.html#3180" class="Postulate">Key</a>
           <a id="3251" href="StructuredContracts.html#3251" class="Postulate">_</a> <a id="3253" class="Symbol">:</a> <a id="3255" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="3261" href="StructuredContracts.html#2031" class="Postulate">Value</a>

<a id="3268" class="Keyword">record</a> <a id="AccI"></a><a id="3275" href="StructuredContracts.html#3275" class="Record">AccI</a> <a id="3280" class="Symbol">:</a> <a id="3282" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="3287" class="Keyword">where</a>
  <a id="3295" class="Keyword">field</a> <a id="AccI.id"></a><a id="3301" href="StructuredContracts.html#3301" class="Field">id</a> <a id="3304" class="Symbol">:</a> <a id="3306" href="StructuredContracts.html#3177" class="Postulate">Id</a>
        <a id="AccI.pk"></a><a id="3317" href="StructuredContracts.html#3317" class="Field">pk</a> <a id="3320" class="Symbol">:</a> <a id="3322" href="StructuredContracts.html#3180" class="Postulate">Key</a>
<a id="3326" class="Keyword">open</a> <a id="3331" href="StructuredContracts.html#3275" class="Module">AccI</a>

<a id="3337" class="Keyword">record</a> <a id="Account"></a><a id="3344" href="StructuredContracts.html#3344" class="Record">Account</a> <a id="3352" class="Symbol">:</a> <a id="3354" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="3359" class="Keyword">where</a>
  <a id="3367" class="Keyword">field</a> <a id="Account.id"></a><a id="3373" href="StructuredContracts.html#3373" class="Field">id</a> <a id="3376" class="Symbol">:</a> <a id="3378" href="StructuredContracts.html#3177" class="Postulate">Id</a>
        <a id="Account.value"></a><a id="3389" href="StructuredContracts.html#3389" class="Field">value</a> <a id="3395" class="Symbol">:</a> <a id="3397" href="StructuredContracts.html#2031" class="Postulate">Value</a>
        <a id="Account.pk"></a><a id="3411" href="StructuredContracts.html#3411" class="Field">pk</a> <a id="3414" class="Symbol">:</a> <a id="3416" href="StructuredContracts.html#3180" class="Postulate">Key</a>
<a id="3420" class="Keyword">open</a> <a id="3425" href="StructuredContracts.html#3344" class="Module">Account</a>
<a id="3433" class="Keyword">unquoteDecl</a> <a id="Derive-Account"></a><a id="3445" href="StructuredContracts.html#3445" class="Function">Derive-Account</a> <a id="3460" class="Symbol">=</a> <a id="3462" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="3469" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="3475" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3477" class="Keyword">quote</a> <a id="3483" href="StructuredContracts.html#3344" class="Record">Account</a> <a id="3491" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3493" href="StructuredContracts.html#3445" class="Function">Derive-Account</a> <a id="3508" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="3511" class="Keyword">postulate</a>
  <a id="3523" class="Keyword">instance</a> <a id="3532" href="StructuredContracts.html#3532" class="Postulate">_</a> <a id="3534" class="Symbol">:</a> <a id="3536" href="Prelude.Semigroup.html#185" class="Record">Semigroup</a> <a id="3546" href="StructuredContracts.html#3275" class="Record">AccI</a><a id="3550" class="Symbol">;</a> <a id="3552" href="StructuredContracts.html#3552" class="Postulate">_</a> <a id="3554" class="Symbol">:</a> <a id="3556" href="Prelude.Monoid.html#159" class="Record">Monoid</a> <a id="3563" href="StructuredContracts.html#3275" class="Record">AccI</a>
  <a id="txInfoSignatories"></a><a id="3570" href="StructuredContracts.html#3570" class="Postulate">txInfoSignatories</a> <a id="3588" class="Symbol">:</a> <a id="3590" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="3597" class="Symbol">→</a> <a id="3599" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3604" href="StructuredContracts.html#3180" class="Postulate">Key</a>
  <a id="itype"></a><a id="3610" href="StructuredContracts.html#3610" class="Postulate">itype</a> <a id="3616" class="Symbol">:</a> <a id="3618" href="StructuredContracts.html#3275" class="Record">AccI</a> <a id="3623" class="Symbol">→</a> <a id="3625" href="StructuredContracts.html#3052" class="Datatype">IType</a>

<a id="3632" class="Keyword">variable</a>
  <a id="3643" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="3649" class="Symbol">:</a> <a id="3651" href="StructuredContracts.html#3275" class="Record">AccI</a>
  <a id="3658" href="StructuredContracts.html#3658" class="Generalizable">accts</a> <a id="3664" class="Symbol">:</a> <a id="3666" href="Prelude.Maps.AsSets.html#550" class="Record">Map⟨</a> <a id="3671" href="StructuredContracts.html#3177" class="Postulate">Id</a> <a id="3674" href="Prelude.Maps.AsSets.html#550" class="Record">↦</a> <a id="3676" href="StructuredContracts.html#3344" class="Record">Account</a> <a id="3684" href="Prelude.Maps.AsSets.html#550" class="Record">⟩</a>
  <a id="3688" href="StructuredContracts.html#3688" class="Generalizable">newAcct</a> <a id="3696" href="StructuredContracts.html#3696" class="Generalizable">acntToClose</a> <a id="3708" class="Symbol">:</a> <a id="3710" href="StructuredContracts.html#3344" class="Record">Account</a>

<a id="3719" class="Keyword">data</a> <a id="_⊢_—⟨_∣ACCNT⟩→_"></a><a id="3724" href="StructuredContracts.html#3724" class="Datatype Operator">_⊢_—⟨_∣ACCNT⟩→_</a> <a id="3740" class="Symbol">:</a> <a id="3742" href="StructuredContracts.html#253" class="Function">SSRel</a> <a id="3748" class="Symbol">(</a><a id="3749" href="StructuredContracts.html#733" class="Postulate">TxInfo</a> <a id="3756" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3758" href="Prelude.Maps.AsSets.html#550" class="Record">Map⟨</a> <a id="3763" href="StructuredContracts.html#3177" class="Postulate">Id</a> <a id="3766" href="Prelude.Maps.AsSets.html#550" class="Record">↦</a> <a id="3768" href="StructuredContracts.html#3344" class="Record">Account</a> <a id="3776" href="Prelude.Maps.AsSets.html#550" class="Record">⟩</a> <a id="3778" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3780" href="StructuredContracts.html#3275" class="Record">AccI</a><a id="3784" class="Symbol">)</a> <a id="3786" class="Keyword">where</a>

  <a id="_⊢_—⟨_∣ACCNT⟩→_.Open"></a><a id="3795" href="StructuredContracts.html#3795" class="InductiveConstructor">Open</a> <a id="3800" class="Symbol">:</a>

    <a id="3807" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="3809" href="StructuredContracts.html#3610" class="Postulate">itype</a> <a id="3815" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="3821" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3823" href="StructuredContracts.html#3073" class="InductiveConstructor">OArgs</a>
    <a id="3833" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="3835" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="3841" class="Symbol">.</a><a id="3842" href="StructuredContracts.html#3317" class="Field">pk</a> <a id="3845" href="Prelude.Membership.html#428" class="Field Operator">∈</a> <a id="3847" href="StructuredContracts.html#3570" class="Postulate">txInfoSignatories</a> <a id="3865" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="3876" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="3878" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="3884" class="Symbol">.</a><a id="3885" href="StructuredContracts.html#3301" class="Field">id</a> <a id="3888" href="Prelude.Maps.AsSets.html#1690" class="Function Operator">∉ᵈ</a> <a id="3891" href="StructuredContracts.html#3658" class="Generalizable">accts</a>
    <a id="3901" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="3903" href="StructuredContracts.html#3688" class="Generalizable">newAcct</a> <a id="3911" class="Symbol">.</a><a id="3912" href="StructuredContracts.html#3411" class="Field">pk</a> <a id="3915" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3917" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="3923" class="Symbol">.</a><a id="3924" href="StructuredContracts.html#3317" class="Field">pk</a>
    <a id="3931" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="3933" href="StructuredContracts.html#3688" class="Generalizable">newAcct</a> <a id="3941" class="Symbol">.</a><a id="3942" href="StructuredContracts.html#3389" class="Field">value</a> <a id="3948" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3950" href="Prelude.Monoid.html#222" class="Field">ε</a>
      <a id="3958" href="Prelude.InferenceRules.html#11303" class="Function Operator">──────────────────────────────────────────────────────────────────────────</a>
      <a id="4039" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="4046" href="StructuredContracts.html#3724" class="Datatype Operator">⊢</a> <a id="4048" href="StructuredContracts.html#3658" class="Generalizable">accts</a> <a id="4054" href="StructuredContracts.html#3724" class="Datatype Operator">—⟨</a> <a id="4057" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="4063" href="StructuredContracts.html#3724" class="Datatype Operator">∣ACCNT⟩→</a> <a id="4072" class="Symbol">(</a><a id="4073" href="StructuredContracts.html#3658" class="Generalizable">accts</a> <a id="4079" href="Prelude.Maps.AsSets.html#1469" class="Function Operator">∪</a> <a id="4081" href="Prelude.Maps.AsSets.html#944" class="Function">singleton</a> <a id="4091" class="Symbol">(</a><a id="4092" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="4098" class="Symbol">.</a><a id="4099" href="StructuredContracts.html#3301" class="Field">id</a> <a id="4102" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4104" href="StructuredContracts.html#3688" class="Generalizable">newAcct</a><a id="4111" class="Symbol">))</a>

  <a id="_⊢_—⟨_∣ACCNT⟩→_.Close"></a><a id="4117" href="StructuredContracts.html#4117" class="InductiveConstructor">Close</a> <a id="4123" class="Symbol">:</a>

    <a id="4130" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="4132" href="StructuredContracts.html#3610" class="Postulate">itype</a> <a id="4138" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="4144" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4146" href="StructuredContracts.html#3079" class="InductiveConstructor">CArgs</a>
    <a id="4156" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="4158" href="StructuredContracts.html#3658" class="Generalizable">accts</a> <a id="4164" href="Prelude.Maps.AsSets.html#2010" class="Function Operator">[</a> <a id="4166" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="4172" class="Symbol">.</a><a id="4173" href="StructuredContracts.html#3301" class="Field">id</a> <a id="4176" href="Prelude.Maps.AsSets.html#2010" class="Function Operator">↦</a> <a id="4178" href="StructuredContracts.html#3696" class="Generalizable">acntToClose</a> <a id="4190" href="Prelude.Maps.AsSets.html#2010" class="Function Operator">]</a>
    <a id="4196" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="4198" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="4204" class="Symbol">.</a><a id="4205" href="StructuredContracts.html#3317" class="Field">pk</a> <a id="4208" href="Prelude.Membership.html#428" class="Field Operator">∈</a> <a id="4210" href="StructuredContracts.html#3570" class="Postulate">txInfoSignatories</a> <a id="4228" href="StructuredContracts.html#814" class="Generalizable">txInfo</a>
    <a id="4239" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="4241" href="StructuredContracts.html#3696" class="Generalizable">acntToClose</a> <a id="4253" class="Symbol">.</a><a id="4254" href="StructuredContracts.html#3389" class="Field">value</a> <a id="4260" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4262" href="Prelude.Monoid.html#222" class="Field">ε</a>
      <a id="4270" href="Prelude.InferenceRules.html#12810" class="Function Operator">────────────────────────────────────────────────────</a>
      <a id="4329" href="StructuredContracts.html#814" class="Generalizable">txInfo</a> <a id="4336" href="StructuredContracts.html#3724" class="Datatype Operator">⊢</a> <a id="4338" href="StructuredContracts.html#3658" class="Generalizable">accts</a> <a id="4344" href="StructuredContracts.html#3724" class="Datatype Operator">—⟨</a> <a id="4347" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="4353" href="StructuredContracts.html#3724" class="Datatype Operator">∣ACCNT⟩→</a> <a id="4362" class="Symbol">(</a><a id="4363" href="StructuredContracts.html#3643" class="Generalizable">accIn</a> <a id="4369" class="Symbol">.</a><a id="4370" href="StructuredContracts.html#3301" class="Field">id</a> <a id="4373" href="Prelude.Maps.AsSets.html#3452" class="Function Operator">⋪</a> <a id="4375" href="StructuredContracts.html#3658" class="Generalizable">accts</a><a id="4380" class="Symbol">)</a>

<a id="4383" class="Keyword">postulate</a> <a id="LEDGER-simulates-ACCNT"></a><a id="4393" href="StructuredContracts.html#4393" class="Postulate">LEDGER-simulates-ACCNT</a> <a id="4416" class="Symbol">:</a> <a id="4418" href="StructuredContracts.html#1664" class="Function">IsSimulation</a> <a id="4431" href="StructuredContracts.html#3724" class="Datatype Operator">_⊢_—⟨_∣ACCNT⟩→_</a>
</pre></body></html>